import{r,R as p,a as V,j as e,F as Te}from"./index-01501350.js";import{P as Ae}from"./index-6b15c7be.js";import{u as j}from"./use-dom-ref-59870be1.js";import{S as Pe,a as ke,b as He,c as We,d as je,e as Ue,f as qe,g as Ze,h as De,i as _e,j as Ge,k as Ye,l as ze,m as Je,n as Qe,o as xe,p as Xe}from"./dropdown.styles-b4390c3d.js";import{t as F,D as Le,g as Oe,a as Ee,b as et,c as tt,d as rt,e as ot}from"./utils-e7d29eea.js";import{p as st}from"./pick-child-46acd2c1.js";const ae=r.createContext({labelId:"",open:!1,searchValue:"",selectedItem:null,disabledKeys:[],selectedKey:"",defaultSelectedKey:"",setSelectedItem:()=>{},onItemClick:()=>{}}),lt=()=>e("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:e("path",{d:"M9.39158 1.86239C9.64736 2.12284 9.64736 2.54372 9.39158 2.80416L4.15319 8.13808C3.89741 8.39853 3.48407 8.39853 3.22829 8.13808L0.608522 5.47112C0.352823 5.21068 0.352823 4.7898 0.608522 4.52935C0.864262 4.26891 1.27883 4.26891 1.53461 4.52935L3.67232 6.72334L8.46668 1.86239C8.72246 1.60153 9.1358 1.60153 9.39158 1.86239Z",fill:"currentColor"})}),nt=()=>e("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",children:e("path",{d:"M15.0265 3.47966C15.4357 3.89637 15.4357 4.56978 15.0265 4.98649L6.64506 13.5208C6.23581 13.9375 5.57446 13.9375 5.16521 13.5208L0.973587 9.25363C0.564469 8.83691 0.564469 8.16351 0.973587 7.74679C1.38277 7.33008 2.04608 7.33008 2.45533 7.74679L5.87567 11.2572L13.5466 3.47966C13.9559 3.06228 14.6172 3.06228 15.0265 3.47966Z",fill:"currentColor"})}),at=p.forwardRef((d,b)=>{const{children:u,value:l="",flagName:y,type:i,rightIcon:m,leftIcon:v,rightColor:w,css:E={},checkmark:L="none",...q}=d,{textValue:k,...C}=q,{selectedItem:S,disabledKeys:K=[],searchValue:G,focusKey:g,selectedKey:Y,setSelectedItem:M,setDropdownItemKeys:T,onItemClick:R}=r.useContext(ae),N=j(b),A=r.useMemo(()=>(S==null?void 0:S.value.toString())===l.toString(),[S,l]),P=r.useMemo(()=>(g==null?void 0:g.toString())===l.toString(),[g,l]),H=r.useMemo(()=>K.findIndex(D=>D.toString()===l.toString())!==-1,[K,l]),a=r.useMemo(()=>!G||F(u).toLocaleLowerCase().includes(G.toLocaleLowerCase()),[G,u]);return r.useEffect(()=>{H||T==null||T(D=>{const ee=D.findIndex(o=>o.value.toString()===l.toString());return ee===-1?D.push({value:l,visibility:!0}):D[ee]={value:l,visibility:a},D})},[l,H,a]),r.useEffect(()=>{Y&&Y.toString()===l.toString()&&M({value:l.toString(),displayValue:k||u})},[Y,l]),r.useEffect(()=>{(P||A&&P)&&setTimeout(()=>{N.current&&N.current.scrollIntoView({block:"nearest"})},0)},[P,A]),a?V(Pe,{css:E,isFocused:P,isSelected:A&&!P,isDisabled:H,onClick:()=>{H||R({value:l.toString(),displayValue:k||u,flagName:y??""})},ref:N,role:"option","aria-selected":A,...C,children:[v&&e(ke,{children:v}),e(He,{children:u}),i==="icon"&&m&&e(ke,{children:m}),i==="color"&&w&&e(We,{css:{$$bg:w}}),e(je,{isSelected:A,checkmark:L,children:L==="checkbox"?e("div",{children:e(lt,{})}):L==="tick"?e(nt,{}):null})]}):null}),Ie=at;function ct(){return e(Ue,{children:V("div",{className:"spinner",children:[e("div",{className:"spinner-1"}),e("div",{className:"spinner-2"}),e("div",{className:"spinner-3"}),e("div",{})]})})}function it(d){const[b,u]=r.useState(!1),l=r.useMemo(()=>new IntersectionObserver(([y])=>u(!!(y!=null&&y.isIntersecting))),[d.current]);return r.useEffect(()=>(d.current&&l.observe(d.current),()=>{l.disconnect()}),[d,l]),b}const ut=d=>{const{children:b,isLoading:u,css:l={},noDataMessage:y,onLoadMore:i}=d,m=j(null),v=j(null),w=it(m),{searchValue:E,labelId:L}=r.useContext(ae),{child:q,rest:k}=st(b,Le),C=r.useMemo(()=>{let S=0;return p.Children.map(k,K=>{F(K).toLocaleLowerCase().includes(E.toLocaleLowerCase())&&S++}),S},[k,E]);return r.useEffect(()=>{if(m.current&&v.current){const S=Oe(m.current,v.current);w&&S>=0&&S<4&&(i==null||i())}},[w]),r.useMemo(()=>V(Te,{children:[q&&q,V(qe,{css:l,role:"listbox","aria-labelledby":L,children:[u?e(ct,{}):C===0?e(Ze,{children:y||"No data"}):k,p.Children.toArray(k).length>0&&e(De,{ref:m}),e(De,{ref:v})]})]}),[l,u,C,b])},dt=ut,ft=p.forwardRef((d,b)=>e(U,{...d,ref:b,type:"combobox"})),pt=ft,bt=p.forwardRef((d,b)=>{const{children:u,title:l,isClickable:y,css:i={},onClick:m,...v}=d,w=j(b);return V(_e,{css:i,ref:w,...v,children:[l&&e(Ge,{isClickable:!!y,onClick:()=>{y&&(m==null||m())},children:l}),u]})}),mt=bt,wt=p.forwardRef((d,b)=>e(U,{...d,ref:b,type:"select"})),ht=wt,yt=()=>e(Xe,{width:"16",height:"16",viewBox:"0 0 16 16",className:"cdg-dropdown-button-icon",children:e("path",{d:"M8.33276 12.3334C8.02004 12.3334 7.70717 12.2125 7.46885 11.9707L1.35805 5.78022C0.880649 5.29658 0.880649 4.5131 1.35805 4.02947C1.83546 3.54584 2.60886 3.54584 3.08626 4.02947L8.33276 9.34651L13.5804 4.03044C14.0578 3.54681 14.8312 3.54681 15.3086 4.03044C15.786 4.51407 15.786 5.29755 15.3086 5.78118L9.19782 11.9717C8.95912 12.2135 8.64594 12.3334 8.33276 12.3334Z",fill:"currentColor"})}),St=32,X=()=>{},gt=p.forwardRef((d,b)=>{const{id:u=`cdg-element-${Math.random().toString(36).substring(2)}`,css:l={},children:y,type:i="select",icon:m=e(yt,{}),placeholder:v,isErrored:w=!1,isRequired:E=!1,isReadOnly:L=!1,isLoading:q=!1,helperText:k,selectedKey:C="",errorMessage:S,numberOfRows:K,disabledKeys:G=[],defaultSelectedKey:g="",defaultOpen:Y=!1,isDisabled:M=!1,shouldDeselect:T=!1,allowsCustomValue:R=!1,disableClearable:N=!1,prefix:A=null,noDataMessage:P="",label:H,onSelectionChange:a=X,onFocus:O=X,onBlur:D=X,onLoadMore:ee=X,onOpenChange:o=X,...Ve}=d,[h,W]=p.useState(Y),[s,te]=p.useState(null),[ce,Me]=p.useState(null),[se,$]=p.useState(C||g),[ie,le]=r.useState(""),[Z,Re]=r.useState([]),[x,Ne]=r.useState(null),z=j(b),ue=j(null),f=j(null),de=r.useRef(!1),re=r.useMemo(()=>!!g||!g&&!C,[g]),$e=r.useMemo(()=>{var t,c;switch(i){case"select":return((t=ue.current)==null?void 0:t.clientWidth)??"100%";case"combobox":return((c=f.current)==null?void 0:c.clientWidth)??"100%";default:return"100%"}},[i,h]);r.useEffect(()=>{de.current?!h&&R&&$(""):de.current=!0},[h,R]);const fe=t=>typeof t=="string"?t:p.Children.map(t,c=>{if(!c)return c;if(p.isValidElement(c)){if(c.type===Ie){const J=c;if(!("value"in J.props))return p.cloneElement(J,{value:`${c.key}`||""})}const I=c;if(I.props.children)return p.cloneElement(I,{children:fe(I.props.children)})}return c});r.useEffect(()=>{Ne(fe(y))},[y]);const B=r.useCallback(t=>{re&&(te(t),$((t==null?void 0:t.value)??""))},[re]),ne=r.useCallback(t=>{var c,I,J,me,we,he,ye,Se,ge,ve,Ce;if(h){const _=(se||(s==null?void 0:s.value.toString()))??"";switch(t.key){case"ArrowUp":case"ArrowLeft":if(t.preventDefault(),_){const n=rt(_,x,Z),Q=(n==null?void 0:n.props.value)??((c=n==null?void 0:n.key)==null?void 0:c.toString().replace(".$",""))??"";Q&&$(Q)}else $(((me=(J=(I=ot(x,Z))==null?void 0:I.props)==null?void 0:J.value)==null?void 0:me.toString())??"");break;case"ArrowDown":case"ArrowRight":if(t.preventDefault(),_){const n=et(_,x,Z),Q=(n==null?void 0:n.props.value)??((we=n==null?void 0:n.key)==null?void 0:we.toString().replace(".$",""))??"";Q&&$(Q)}else $(((Se=(ye=(he=tt(x,Z))==null?void 0:he.props)==null?void 0:ye.value)==null?void 0:Se.toString())??"");break;case"Enter":if(t.preventDefault(),_){const n=Ee(_,x);if(n){if(W(!1),o==null||o(!1),!N&&T&&(s==null?void 0:s.value)===n.props.value){B(null),a==null||a("");return}B({value:((ve=(ge=n==null?void 0:n.props)==null?void 0:ge.value)==null?void 0:ve.toString())??"",displayValue:n.props.textValue||n.props.children,flagName:n.props.flagName??""}),f.current&&(f.current.value=F(n.props.children)),a==null||a((Ce=n==null?void 0:n.props)==null?void 0:Ce.value)}}break;case"Escape":case"Tab":W(!1),o==null||o(!1);break}}else switch(t.key){case"ArrowUp":case"ArrowDown":t.preventDefault(),W(!0),o==null||o(!0);break}},[h,N,T,se,x,s,Z,o,B]);r.useEffect(()=>(z.current&&z.current.addEventListener("keydown",ne),()=>{z.current&&z.current.removeEventListener("keydown",ne)}),[ne]);const oe=r.useCallback(()=>{var t;W(c=>!c),o==null||o(!h),(t=f.current)==null||t.focus()},[o,h]),pe=r.useCallback(t=>{W(!0),o==null||o(!0),le(t.target.value??""),i==="combobox"&&R&&(B(null),a==null||a(""))},[re,i,s,ce,R,o,a,B]),be=r.useCallback(()=>{["combobox"].includes(i)&&f.current&&setTimeout(()=>{document.activeElement!==f.current&&f.current&&(R||(s?f.current.value=F(s==null?void 0:s.displayValue):f.current.value=""),le(""))})},[i,ce,s,R,re]);r.useEffect(()=>{!h&&["combobox"].includes(i)&&f.current&&be()},[h,i,be]),r.useEffect(()=>{var I;if(!x||!C&&!g){te(null),$("");return}const t=C||g,c=Ee(t,x);c&&(te({value:t.toString(),displayValue:c,flagName:((I=c==null?void 0:c.props)==null?void 0:I.flagName)??""}),$(t.toString()),f.current&&(f.current.value=F(c)))},[x,C,g]);const Be=r.useMemo(()=>{switch(i){case"select":return e(ze,{isEmpty:!s,className:"cdg-dropdown-input",role:"button",isErrored:!!w,isDisabled:M,"aria-required":E,children:V("button",{id:u,type:"button",ref:ue,disabled:M,onClick:oe,onBlur:D,onFocus:O,className:"cdg-dropdown-button",children:[A,e("span",{children:s?F(s==null?void 0:s.displayValue):v}),m]})});case"combobox":return V(Ye,{isEmpty:!s,className:"cdg-dropdown-input",role:"button",isErrored:!!w,isDisabled:M,"aria-required":E,children:[e("input",{id:u,ref:f,readOnly:L,disabled:M,placeholder:v,onChange:pe,onBlur:D,onFocus:O,onClick:oe,"aria-autocomplete":"list",role:"combobox","aria-invalid":w,"aria-expanded":h}),e("button",{type:"button",tabIndex:-1,disabled:M,onClick:oe,className:"cdg-dropdown-button",children:m})]});default:return null}},[h,i,u,v,s,w,M,L,D,O,oe,pe]),Fe=t=>{if(!L){if(W(!1),o==null||o(!1),!N&&!t.value){B(null),a==null||a("");return}if(!N&&T&&(s==null?void 0:s.value)===t.value){B(null),a==null||a("");return}(s==null?void 0:s.value)!==t.value&&(a==null||a(t.value)),B(t),Me(t),["combobox"].includes(i)&&(f.current&&(f.current.value=F(t.displayValue),f.current.blur()),le(F(t.displayValue)))}},Ke=r.useCallback(()=>{W(!1),o==null||o(!1)},[o]);return V(Je,{className:`${h?"cdg-dropdown-opening":""}`,css:l,ref:z,...Ve,children:[H&&V("label",{htmlFor:u,id:`${u}-label`,children:[H,E&&e("span",{children:"*"})]}),e(ae.Provider,{value:{open:h,focusKey:se??"",selectedKey:C,defaultSelectedKey:g,disabledKeys:G,searchValue:ie,labelId:`${u}-label`,selectedItem:s,setSelectedItem:te,dropdownItemKeys:Z,setDropdownItemKeys:Re,onItemClick:Fe},children:e(Ae,{isOpen:h,anchor:Be,css:{width:"100%"},direction:"bottom",onClose:Ke,children:e(Qe,{style:{width:$e},children:e(dt,{searchValue:ie,isLoading:q,css:{maxHeight:K?`${K*St}px`:"16rem"},onLoadMore:ee,noDataMessage:P,children:x})})})}),w&&S&&e(xe,{error:!!w,children:S}),k&&e(xe,{children:k})]})}),U=gt;U.Item=Ie;U.Select=ht;U.ComboBox=pt;U.Section=mt;U.Header=Le;export{U as D};
