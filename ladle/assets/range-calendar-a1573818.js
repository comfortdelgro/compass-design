import{s as E,r as g,j as R,R as ie,a as L,F as H}from"./index-12a99532.js";import{B as oe}from"./index-d88e7175.js";import"./index-ab5e21ba.js";import{u as le,l as N,_ as J,z as Q,Y as X,y as ee,$ as ue,A as ce,i as m,d as de,aF as ae,ab as fe,ak as be,e as me,aK as ge,t as G,V as ve,W as he,aG as De,O as ne,aL as te,aM as xe,aN as pe,a0 as Re,G as ye,p as Ve,x as Ce,a6 as Se,ae as $e,K as P,aI as Fe,aJ as re}from"./useCalendarState-59e9a1ab.js";import{u as Te,a as j}from"./useEvent-905f03f9.js";import{u as ke}from"./use-dom-ref-2bd5dd1a.js";import{B as Z}from"./button-6255561c.js";const we=E("div",{padding:"$3 $4 $3 $4",display:"flex",flexDirection:"column",maxWidth:"193px",width:"100%",borderRight:"1px solid #F5F5F5"}),Ie=E("button",{margin:0,padding:"$3 $4",width:"100%",maxWidth:"160px",fontSize:"$label1",textAlign:"left",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"$button",color:"$primaryText","&:hover":{borderRadius:"6px",backgroundColor:"$gray20",fontWeight:"bold"},"&:focus-visible":{outline:"none",borderRadius:"6px",boxShadow:"0px 0px 0px 4px #F2F4F7"},"&:disabled":{backgroundColor:"transparent",fontWeight:"$normal",cursor:"not-allowed"},variants:{variants:{active:{backgroundColor:"$cdgBlue10",borderRadius:"6px","&:focus-visible":{backgroundColor:"$cdgBlue10",boxShadow:"0px 0px 0px 4px #F2F4F7"}},inactive:{}}},defaultVariants:{variants:"inactive"}}),Pe=t=>{const[e,d]=g.useState(null),[c,h]=g.useState(null),{state:a,customShortcuts:b=V=>V}=t,{locale:l}=le();g.useEffect(()=>{var V,O;!(c!=null&&c.start)||!c.end||e&&((V=a.value.end)==null?void 0:V.compare(c.end))!==0&&((O=a.value.start)==null?void 0:O.compare(c.start))!==0&&d(null)},[a.value]);const s=new Intl.DateTimeFormat(l).resolvedOptions().timeZone,i=N(s),n=i.subtract({days:1}),D=i.subtract({weeks:1}),f=i.subtract({months:1}),r=J(i,l),y=Q(i,l),v=J(D,l),x=Q(D,l),B=X(i),$=ee(i),F=X(f),u=ee(f),k=ue(i),w=ce(i),C=[{label:"Today",isDisable:(()=>m(i,a.minValue,a.maxValue))(),getValue:()=>({end:i,start:i})},{label:"Yesterday",isDisable:(()=>m(n,a.minValue,a.maxValue))(),getValue:()=>({end:n,start:n})},{label:"This Week",isDisable:(()=>m(r,a.minValue,a.maxValue)||m(y,a.minValue,a.maxValue))(),getValue:()=>({start:r,end:y})},{label:"Last Week",isDisable:(()=>m(v,a.minValue,a.maxValue)||m(x,a.minValue,a.maxValue))(),getValue:()=>({start:v,end:x})},{label:"This Month",isDisable:(()=>m(B,a.minValue,a.maxValue)||m($,a.minValue,a.maxValue))(),getValue:()=>({start:B,end:$})},{label:"Last Month",isDisable:(()=>m(F,a.minValue,a.maxValue)||m(u,a.minValue,a.maxValue))(),getValue:()=>({start:F,end:u})},{label:"This Year",isDisable:(()=>m(k,a.minValue,a.maxValue)||m(w,a.minValue,a.maxValue))(),getValue:()=>({start:k,end:w})}];return{shorcuts:b(C,V=>m(V,a.minValue,a.maxValue)),selectedItem:e,setSelectedItem:d,setCurrentRangeDate:h}},Be=t=>{const{state:e,pickerState:d}=t,{shorcuts:c,selectedItem:h,setSelectedItem:a,setCurrentRangeDate:b}=Pe(t),l=s=>{var n;const i=s.getValue();d?d.setDateRange(i):e.setValue(i),i.end&&((n=e.setFocusedDate)==null||n.call(e,i.end)),a(s.label),b(i),e.setAnchorDate(null)};return R(we,{children:c&&c.map(s=>R(Ie,{"aria-disabled":s.isDisable,type:"button",variants:h===s.label?"active":"inactive",disabled:s.isDisable,onClick:()=>l(s),children:s.label},s.label))})},Oe=Be;function Me(t,e){var D,f,r,y;const d=de(t);if(e.visibleRange==null)return{};const c=ae(e.visibleRange.start,e.timeZone??"UTC"),h=ae(e.visibleRange.start,e.timeZone??"UTC"),a=Te([!!t.errorMessage,t.validationState]);fe.set(e,{ariaLabel:t["aria-label"]??"",ariaLabelledBy:t["aria-labelledby"],errorMessageId:a});const b=g.useRef(!1),l=t.isDisabled||((D=e.isNextVisibleRangeInvalid)==null?void 0:D.call(e));l&&b.current&&(b.current=!1,(f=e.setFocused)==null||f.call(e,!0));const s=g.useRef(!1),i=t.isDisabled||((r=e.isPreviousVisibleRangeInvalid)==null?void 0:r.call(e));i&&s.current&&(s.current=!1,(y=e.setFocused)==null||y.call(e,!0));const n=be({id:t.id,"aria-label":[t["aria-label"],h].filter(Boolean).join(", "),"aria-labelledby":t["aria-labelledby"]});return{calendarProps:{...d,...n,role:"group","aria-describedby":t["aria-describedby"]||void 0},nextButtonProps:{onPress:()=>{var v;return(v=e.focusNextPage)==null?void 0:v.call(e)},"aria-label":"next",isDisabled:l,onFocus:()=>b.current=!0,onBlur:()=>b.current=!1},prevButtonProps:{onPress:()=>{var v;return(v=e.focusPreviousPage)==null?void 0:v.call(e)},"aria-label":"previous",isDisabled:i,onFocus:()=>s.current=!0,onBlur:()=>s.current=!1},title:c}}function We(t,e,d){const c=Me(t,e),h=g.useRef(!1),a=g.useRef(typeof window<"u"?window:null);j(a,"pointerdown",l=>{h.current=l.width===0&&l.height===0});const b=l=>{var n;if(h.current){h.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;const s=l.target,i=document.getElementById(c.calendarProps.id);i&&i.contains(document.activeElement)&&(!i.contains(s)||!s.closest('button, [role="button"]'))&&((n=e.selectFocusedDate)==null||n.call(e))};return j(a,"pointerup",b),j(a,"pointercancel",b),c.calendarProps.onBlur=l=>{var s;(!l.relatedTarget||!d.current.contains(l.relatedTarget))&&e.anchorDate&&((s=e.selectFocusedDate)==null||s.call(e))},j(d,"touchmove",l=>{e.isDragging&&l.preventDefault()},{passive:!1,capture:!0}),c}function Ae(t){var T,W,K,_;const{value:e,defaultValue:d,onChange:c,createCalendar:h,locale:a,visibleDuration:b={months:1},minValue:l,maxValue:s,...i}=t,[n,D]=me(e,d||null,c),[f,r]=g.useState(n!=null&&n.start&&!n.end?n==null?void 0:n.start:null);let y="center";if(n&&n.start&&n.end){const p=ge(G(n.start),b,a,l,s).add(b).subtract({days:1});n.end.compare(p)>0&&(y="start")}const v=g.useRef(null),[x,B]=g.useState(),$=g.useMemo(()=>ve(l,x==null?void 0:x.start),[l,x]),F=g.useMemo(()=>he(s,x==null?void 0:x.end),[s,x]),u=De({...i,value:n&&n.start,createCalendar:h,locale:a,visibleDuration:b,minValue:$,maxValue:F,selectionAlignment:y}),k=o=>{o&&t.isDateUnavailable&&!t.allowsNonContiguousRanges?(v.current={start:te(o,u,-1),end:te(o,u,1)},B(v.current)):(v.current=null,B(void 0))},w=g.useRef(u.visibleRange);(!ne((T=u.visibleRange)==null?void 0:T.start,(W=w.current)==null?void 0:W.start)||!ne((K=u.visibleRange)==null?void 0:K.end,(_=w.current)==null?void 0:_.end))&&(k(f),w.current=u.visibleRange);const C=o=>{o?(r(o),k(o)):(r(null),k(null))},S=f?z(f,u.focusedDate):n&&z(n.start,n.end),A=o=>{var p;if(!t.isReadOnly&&(o=xe(o,$,F),o=pe(o,(p=u.visibleRange)==null?void 0:p.start,t.isDateUnavailable),!!o))if(!f)C(o),c==null||c({start:o,end:null});else if(f.compare(o)>0)C(o),c==null||c({start:o,end:null});else{const I=z(f,o);D({start:se(I.start,n==null?void 0:n.start),end:se(I.end,n==null?void 0:n.end)}),C(null)}},[V,O]=g.useState(!1),{isDateUnavailable:M}=t,U=g.useMemo(()=>!n||f?!1:M&&(M(n.start)||M(n.end))?!0:m(n.start,l,s)||m(n.end,l,s),[M,n,f,l,s]),Y=t.validationState||(U?"invalid":null);return{...u,value:n,setValue:D,anchorDate:f,setAnchorDate:C,highlightedRange:S,validationState:Y,selectFocusedDate(){A(u.focusedDate)},selectDate:A,highlightDate(o){var p;f&&((p=u.setFocusedDate)==null||p.call(u,o))},isSelected(o){var p,I;return S&&o.compare(S.start)>=0&&o.compare(S.end)<=0&&!((p=u.isCellDisabled)!=null&&p.call(u,o))&&!((I=u.isCellUnavailable)!=null&&I.call(u,o))},isInvalid(o){var p,I,q;return((p=u.isInvalid)==null?void 0:p.call(u,o))||m(o,(I=v.current)==null?void 0:I.start,(q=v.current)==null?void 0:q.end)},isDragging:V,setDragging:O}}function z(t,e){return!t||!e?null:(e.compare(t)<0&&([t,e]=[e,t]),{start:G(t),end:G(e)})}function se(t,e){return t=Re(t,(e==null?void 0:e.calendar)||new ye),e&&"hour"in e?e.set(t):t}const Le=E("div",{width:"fit-content",backgroundColor:"$background",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.08)",borderRadius:"$md",padding:"$4","& .calendar-body":{display:"flex",justifyContent:"space-between",gap:"$2"},"& .calendar-footer":{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"$6",paddingTop:"$6",borderTop:"1px solid $gray40",color:"$primaryText"},"& .calendar-footer .calendar-footer-right-side":{display:"flex",alignItems:"center",gap:"$4"},"& .calendar-footer .preview-date":{margin:0,fontSize:"$body3"},"& .calendar-footer button":{padding:"$1 $2_5",height:"$8",fontSize:"$label2"},variants:{variants:{extend:{display:"flex",flexDirection:"row",padding:0,"& > div:nth-child(2)":{padding:"$4"}},basic:{}}},defaultVariants:{variants:"basic"}});E("div",{display:"flex",flexDirection:"row"});const Ne=ie.forwardRef((t,e)=>{var V,O,M,U,Y;const{state:d,hasFooter:c,css:h={},maxValue:a=Ve("2999-02-17"),hasShortcuts:b=!1,ctaButtonRender:l,visibleMonths:s=2,onSearchButtonClick:i,customShortcuts:n,...D}=t,{locale:f}=le(),r=Ae({...D,value:t.state?(V=t.state)==null?void 0:V.value:t.value,visibleDuration:{months:s},locale:f,createCalendar:Ce}),y=ke(e),{calendarProps:v,prevButtonProps:x,nextButtonProps:B}=We(D,r,y),$=Se({}),{setIsReset:F}=$e(),u=()=>{r.setValue({start:null,end:null}),r.setAnchorDate(null),F==null||F(!0)},k=()=>{var W;const T={start:N(P()),end:N(P())};d?d==null||d.setDateRange(T):r.setValue(T),r.setAnchorDate(null),(W=r.setFocusedDate)==null||W.call(r,N(P()))},w=g.useMemo(()=>{const T=N(P());return m(T,D.minValue,a)},[D.minValue,a]),C=s!==1,S=!!(C&&b),A=g.useCallback(()=>l||(S?R(Z,{variant:"primary",onPress:T=>i==null?void 0:i(T),children:"Search"}):R(Z,{variant:"primary",onPress:k,isDisabled:w,children:"Today"})),[l,S]);return L(Le,{ref:y,css:h,variants:S?"extend":"basic",children:[S?R(Oe,{state:r,pickerState:d,customShortcuts:n}):R(H,{}),L(oe,{children:[R(Fe,{state:r,variant:C?"range":"default",calendarProps:v,prevButtonProps:x,nextButtonProps:B}),L("div",{className:"calendar-body",children:[R(re,{state:r,maxValue:a}),C?R(re,{state:r,offset:{months:1},maxValue:a}):R(H,{})]}),c&&L("div",{className:"calendar-footer",children:[R(Z,{variant:"ghost",onPress:u,children:"Clear"}),L("div",{className:"calendar-footer-right-side",children:[R("p",{className:"preview-date",children:(O=r==null?void 0:r.value)!=null&&O.start&&((M=r==null?void 0:r.value)!=null&&M.end)?$.formatRange(r.value.start.toDate(P()),r.value.end.toDate(P())):`${(U=r==null?void 0:r.value)!=null&&U.start?$.format(r.value.start.toDate(P())):""} - ${(Y=r==null?void 0:r.value)!=null&&Y.end?$.format(r.value.end.toDate(P())):""}`}),A()]})]})]})]})}),Ke=Ne;export{Ke as R};
