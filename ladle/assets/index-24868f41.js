import{S as Ce,a as ve,B as Q,b as Y,c as Se,P as ke,D as xe}from"./index.styles-48a8eaef.js";import{I as $e,p as Le,a as Re,t as De,L as Fe,D as V,b as Me}from"./utils-fbf423a9.js";import{u as Be,a as Ie,b as Ee,D as Oe,c as Ke,z as We}from"./floating-ui.react.esm-34accd3c.js";import{s as B,R as r,a as w,j as e,F as ze}from"./index-6668e921.js";import{S as q}from"./dropdown.styles-5142d2bf.js";import{u as K}from"./use-dom-ref-8557f905.js";const Ae=B("div",{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:"$6",height:"$6",div:{border:"1px solid #323130",borderRadius:"3px",width:"$4",height:"$4",display:"flex",alignItems:"center",justifyContent:"center",background:"#FFFFFF"},variants:{isSelected:{true:{div:{border:0,background:"$cdgBlue100",svg:{display:"block"}}},false:{div:{svg:{display:"none"}}}}}});function ee({item:n,currentKeys:c,focusKey:a,disabledKeys:s,onSelect:l}){const u=r.useRef(null),f=r.useMemo(()=>n.key?c.some(m=>m==n.key):!1,[c]),d=r.useMemo(()=>a==n.key,[a]),b=r.useMemo(()=>n.key?s.includes(n.key):!1,[s]);return w(Ce,{ref:u,isFocused:d,isSelected:f,onClick:()=>{n.key&&!b&&l(n.key)},isDisabled:b,children:[e(ve,{children:n.props.children}),e(Ae,{isSelected:f,children:e("div",{children:e(je,{})})})]})}const je=()=>e("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:e("path",{d:"M9.39158 1.86239C9.64736 2.12284 9.64736 2.54372 9.39158 2.80416L4.15319 8.13808C3.89741 8.39853 3.48407 8.39853 3.22829 8.13808L0.608522 5.47112C0.352823 5.21068 0.352823 4.7898 0.608522 4.52935C0.864262 4.26891 1.27883 4.26891 1.53461 4.52935L3.67232 6.72334L8.46668 1.86239C8.72246 1.60153 9.1358 1.60153 9.39158 1.86239Z",fill:"white"})});function He(n){const c=r.useRef(null),{focusKey:a,isLoading:s,collection:l,currentKeys:u,disabledKeys:f,rootChildren:d,listBoxRef:b=c,sectionCollection:k,onSelect:m,onLoadMore:g}=n;return e(Q,{isLoading:s,listBoxRef:b,collection:l,sectionCollection:k,rootChildren:d,onLoadMore:g,renderOptions:C=>C.map(v=>w("div",{children:[v.title&&e(Y,{children:v.title}),v.children.map($=>$?e(ee,{item:$,focusKey:a,currentKeys:u,disabledKeys:f,onSelect:m},$.key):null)]},v.id))})}const Pe=B("div",{width:"100%",label:{fontSize:"$label1",fontWeight:"$semibold",marginBottom:"$2",display:"inline-block",width:"100%",span:{marginLeft:"$1",color:"$danger"}}}),_e=B("div",{width:"100%",minHeight:"$11",borderRadius:"$md",cursor:"text",display:"flex",alignItems:"center",padding:"$1_5 $4",gap:"$1",backgroundColor:"#FFFFFF",transition:"$default",borderWidth:"1px",borderStyle:"solid",borderColor:"#E6E6E6",".dropdown-icon":{cursor:"pointer",flexShrink:0,display:"flex",justifyContent:"center",alignItems:"center",padding:0,border:"none",background:"transparent",svg:{width:"$4",height:"$4"}},"&:focus-within":{borderColor:"$cdgBlue"},input:{height:"$6_5",width:4,padding:0,margin:0,border:"none","&:focus":{outline:"none"},"&:focus-visible":{outline:"none"}},variants:{isEmpty:{true:{button:{p:{color:"#B4B4B4"}}}},isDisabled:{true:{backgroundColor:"$gray20","*":{color:"$disabledText",cursor:"not-allowed !important"}}},isErrored:{true:{borderColor:"$danger","&:focus-within":{borderColor:"$danger"}}}}}),Te=B("div",{flexGrow:1,alignItems:"center",minHeight:"$7",display:"flex",gap:"$2_5",flexWrap:"wrap",p:{color:"#B4B4B4",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:"$label1",fontWeight:"$semibold",height:"$6",display:"flex",alignItems:"center",flexGrow:1,border:"none",textAlign:"start",padding:0,margin:0}}),Ne=B("div",{border:"1px solid #E6E6E6",borderRadius:"$full",padding:"$1 $3",fontSize:"$label1",cursor:"default",fontWeight:"$semibold",display:"flex",justifyContent:"center",alignItems:"center",gap:"$2",div:{width:"fit-content",height:"fit-content"}}),Ge=r.forwardRef((n,c)=>{const{collection:a,rootChildren:s,sectionCollection:l,listBoxRef:u,isLoading:f,numberOfRows:d,onLoadMore:b}=n,k=K(c);return d&&d>=0?e(Se,{ref:k,children:e(Q,{isLoading:f,collection:a,listBoxRef:u,rootChildren:s,sectionCollection:l,renderOptions:m=>m.slice(0,Math.min(d,a.length)).map(g=>w("div",{children:[g.title&&e(Y,{children:g.title}),g.children.map(C=>C?e(ee,{item:C,focusKey:void 0,currentKeys:[],disabledKeys:[],onSelect:()=>{}},C.key):null)]},g.id)),onLoadMore:b})}):null}),Ue=Ge,Xe=()=>w("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:[e("g",{clipPath:"url(#clip0_5299_13653)",children:e("path",{d:"M9.11731 7.88215C9.45908 8.22392 9.45908 8.77759 9.11731 9.11936C8.94779 9.29024 8.72359 9.375 8.49938 9.375C8.27518 9.375 8.05153 9.28956 7.88092 9.11867L4.99966 6.23892L2.11867 9.11799C1.94779 9.29024 1.72386 9.375 1.49993 9.375C1.276 9.375 1.05235 9.29024 0.881328 9.11799C0.539557 8.77622 0.539557 8.22255 0.881328 7.88078L3.76313 4.99897L0.881328 2.11854C0.539557 1.77677 0.539557 1.2231 0.881328 0.881328C1.2231 0.539557 1.77677 0.539557 2.11854 0.881328L4.99966 3.7645L7.88146 0.882695C8.22323 0.540925 8.7769 0.540925 9.11867 0.882695C9.46044 1.22446 9.46044 1.77813 9.11867 2.1199L6.23687 5.00171L9.11731 7.88215Z",fill:"#3B3A39"})}),e("defs",{children:e("clipPath",{id:"clip0_5299_13653",children:e("rect",{width:"10",height:"10",fill:"white"})})})]});function J(n,c,a){if(c!=null&&c.length>=0){const s=[];for(const l of c)s.push(l);return s}else if(n!=null&&n.length>0&&a){const s=[];for(const l of n)s.push(l);return s}return[]}const Ze=r.forwardRef((n,c)=>{const{id:a=`cdg-element-${Math.random().toString(36).substring(2)}`,css:s={},isOpen:l,children:u,isErrored:f,isDisabled:d,isRequired:b,isReadOnly:k,helperText:m,defaultOpen:g,errorMessage:C,selectedKeys:v,numberOfRows:$,icon:te=e($e,{}),disabledKeys:L=[],isLoading:z=!1,defaultSelectedKeys:_=[],onLoadMore:ne=()=>{},onBlur:oe=()=>{},onFocus:ie=()=>{},...re}=n,[x,S]=r.useState(!1),[se,T]=r.useState(!1),[R,le]=r.useState(""),[y,N]=r.useState(J(_,v)),[h,D]=r.useState(),de=K(c),I=K(null),F=K(null),ce=r.useRef(null),ae=r.useRef(null),G=r.useRef(null),{refs:U,floatingStyles:ue,context:fe}=Be({open:x,onOpenChange:S,middleware:[Oe(8),Ke()],whileElementsMounted:We}),he=Ie(fe),{getReferenceProps:pe,getFloatingProps:ge}=Ee([he]),p=r.useMemo(()=>Le(u,V),[u]),X=r.useMemo(()=>Re(u),[u]),A=r.useMemo(()=>R===""?p:p.filter(t=>{const i=De(t);return i==null?void 0:i.toLowerCase().includes(R.toLowerCase())}),[p,R]),E=r.useMemo(()=>new Fe(p,L),[p,L]),j=r.useMemo(()=>{const t=[];return p.length>0&&y&&y.length>0&&y.forEach(i=>{const o=p.find(O=>O.key==i);o&&t.push({key:i,rendered:o==null?void 0:o.props.children})}),t},[y,p,y.length]);r.useEffect(()=>{N(J(_,v,!0))},[JSON.stringify(v),p]),r.useEffect(()=>{!l&&g&&S(g),l&&S(l)},[l]),r.useEffect(()=>{var t,i,o;D([...y].pop()),(t=n.onOpenChange)==null||t.call(n,x),x?(i=F.current)==null||i.focus():(o=F.current)==null||o.blur()},[x]);const ye=t=>{if(I.current){const i=t.target.value;if(le(i),S(!0),i!==""){const o=document.createElement("div");o.style.position="absolute",o.style.top="0",o.style.left="-9999px",o.style.overflow="hidden",o.style.visibility="hidden",o.style.whiteSpace="nowrap",o.style.height="0",o.style.width="fit-content",o.style.maxWidth=`${I.current.clientWidth-62}px`,o.innerHTML=i.replace(/\s/g,"&nbsp;"),document.body.appendChild(o),t.target.focus(),t.target.style.width=`${o.clientWidth+4}px`,o.remove()}else t.target.style.width="4px"}},we=t=>{switch(t.key){case"ArrowUp":case"ArrowLeft":{t.preventDefault();const i=h!=null&&h!=-1?E.getKeyAbove(h):E.getFirstKey();i&&D(i);break}case"ArrowDown":case"ArrowRight":{t.preventDefault();const i=h!=null&&h!=-1?E.getKeyBelow(h):E.getFirstKey();i&&D(i);break}case"Enter":{t.preventDefault(),h&&H(h);break}case"Escape":{t.preventDefault(),S(!1);break}case"Tab":{S(!1);break}}},H=(t,i=!1)=>{var o,O;if(!k){const M=new Set(y),P=y.find(me=>me==t);P?(M.delete(P),P==h&&D(Array.from(M).pop()??void 0)):i||(M.add(t),D(t)),N([...M]),(o=n.onSelectionChange)==null||o.call(n,[...M]),(O=F.current)==null||O.focus()}},be=t=>{H(t,!0)},Z=()=>{var t;d||(S(!0),(t=F.current)==null||t.focus())};return w(Pe,{css:s,ref:de,...re,children:[n.label&&w("label",{onClick:Z,htmlFor:a,children:[n.label,b&&e("span",{children:"*"})]}),e("div",{ref:U.setReference,...pe,children:w(_e,{ref:I,isErrored:!!f,isDisabled:!!d,onClick:Z,children:[w(Te,{children:[j.length===0&&R===""&&!x&&!se&&e("p",{children:n.placeholder}),j.length>0&&j.map(t=>{const i=d||L.includes(t.key);return w(Ne,{style:{cursor:d?"not-allowed":"pointer"},children:[e("div",{children:t.rendered}),i?e(ze,{}):e("div",{onClick:()=>{!d&&![...L].includes(t.key)&&be(t.key)},children:e(Xe,{})})]},t.key)}),!d&&e("input",{id:a,type:"text",ref:F,value:R,onChange:ye,onBlur:()=>T(!1),onFocus:()=>T(!0)})]}),e("div",{className:"dropdown-icon",children:te})]})}),A&&x&&e("div",{className:"Popover",ref:U.setFloating,style:{...ue,zIndex:60},...ge,children:e(ke,{isEmpty:z?!1:A.length===0,visualizeRef:G,triggerRef:I,onBlur:oe,onFocus:ie,handleKeyDown:we,children:e(He,{focusKey:h,isLoading:z,collection:A,rootChildren:u,listBoxRef:ce,currentKeys:y,disabledKeys:L,sectionCollection:X,onSelect:H,onLoadMore:ne})})}),e(Ue,{ref:ae,isLoading:z,collection:p,listBoxRef:G,rootChildren:u,numberOfRows:$,sectionCollection:X,onLoadMore:()=>{}}),f&&C&&e(q,{error:!!f,children:C}),m&&e(q,{children:m})]})}),W=Ze;W.Item=V;W.Header=xe;W.Section=Me;W.displayName="MultipleDropdown";export{W as M};
