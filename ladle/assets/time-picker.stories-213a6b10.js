import{s as F,R as ne,r as d,j as o,a as se,F as de}from"./index-66ea3676.js";import{C as pe,R as B}from"./components-e805f086.js";import{l as D}from"./lodash-e911ed84.js";import{P as me}from"./index-f253bb0a.js";import{T as fe}from"./index-1416ce4d.js";import{u as he}from"./use-dom-ref-dc5008e6.js";import"./index-8280f91b.js";import{B as ge}from"./button-912db37c.js";import"./floating-ui.react.esm-8df4aac2.js";import"./useCurrentTheme-efe456bb.js";const L={start:0,end:0,format:"",max:0,min:0},Y={hour:null,minute:null,second:null,session:null},re=["hours12","minutes","sessions"],be=4,ie="AM",ke="PM",we=[ie,ke];F("input",{width:"100%",fontSize:"$label1",fontWeight:"$semibold",lineHeight:"$normal",padding:"$1_5 $3",border:0,borderRadius:"$md",backgroundColor:"transparent","&:focus":{outline:"none",backgroundColor:"$cdgblue120"},"&::placeholder":{color:"$tertiaryText",fontSize:"$label1",fontWeight:"$semibold"}});const Ie=F("div",{".time-picker-input .right-icon":{width:"$6",height:"$6"},".time-picker-input-icon":{display:"flex",cursor:"pointer",borderRadius:"$full",backgroundColor:"transparent",border:"none",padding:"$1"},".time-picker-input-icon:active":{backgroundColor:"$gray20"},".time-picker-input-icon svg":{width:"$4",height:"$4"},".time-picker-input-icon path":{fill:"$secondaryText"}}),Ce=F("div",{background:"$background",border:"1px solid $divider",borderRadius:"$md",zIndex:9999}),De=F("div",{display:"flex",height:"$80",width:"100%",overflowY:"hidden",marginTop:"$1"}),Te=F("div",{padding:"$1",overflowY:"hidden",overflowX:"hidden",height:"100%",width:"$12_5",position:"relative","&:hover":{overflowY:"auto"},"&:not(:last-child)":{borderRight:"1px solid $divider"}}),xe=F("button",{backgroundColor:"$white",border:"none",display:"flex",justifyContent:"center",alignItems:"center",padding:"$3",borderRadius:"$md",width:"$10_5",height:"$10_5",cursor:"pointer",fontWeight:500,boxSizing:"border-box","&:hover":{backgroundColor:"$primaryBg"},fontSize:"$body3",lineHeight:"$5_25","&.active":{backgroundColor:"$cdgBlue100",color:"$background"}}),ye=F("div",{padding:"$2",display:"flex",justifyContent:"flex-end",borderTop:"1px solid $divider",button:{fontWeight:500,fontSize:"$body3",lineHeight:"$5_25"}});F("div",{display:"flex"});F("div",{whiteSpace:"break-spaces"});function Se(t){const{selectedTime:i,time:u,onClickItem:a,displayDataType:f,isOpen:A,itemId:P,focusingItemId:T}=t,l=d.useRef(null);d.useEffect(()=>{var x;P===T&&((x=l.current)==null||x.focus())},[T,P]),d.useEffect(()=>{A&&i===u&&setTimeout(()=>{v("auto")},0)},[A]),d.useEffect(()=>{i===u&&l.current&&v("smooth")},[i,u]);const v=x=>{var y;l.current&&((y=l.current.parentElement)==null||y.scroll({top:l.current.offsetTop-be,behavior:x}))};return o(xe,{ref:l,className:`cdg-timepicker-dropdown-item ${i===u?"active":""}`,onClick:a(u,f),tabIndex:-1,children:u})}const $e=ne.memo(Se);function ce(t){const i={hour:D.cloneDeep(L),minute:D.cloneDeep(L),second:D.cloneDeep(L),session:D.cloneDeep(L)};return t.includes("HH")?i.hour={start:t.indexOf("HH"),end:t.indexOf("HH")+2,format:"HH",min:0,max:23}:t.includes("hh")&&(i.hour={start:t.indexOf("hh"),end:t.indexOf("hh")+2,format:"hh",min:1,max:12}),t.includes("mm")&&(i.minute={start:t.indexOf("mm"),end:t.indexOf("mm")+2,format:"mm",min:0,max:59}),t.includes("ss")&&(i.second={start:t.indexOf("ss"),end:t.indexOf("ss")+2,format:"ss",min:0,max:59}),t.includes("AA"),t.includes("AA")&&(i.session={...D.cloneDeep(L),start:t.indexOf("AA"),end:t.indexOf("AA")+2,format:"AA"}),i}function X(t,i){const u=ce(t),a=D.cloneDeep(L);for(const f in u){const{start:A,end:P,format:T,max:l,min:v}=u[f];if(i>=A&&i<=P){a.start=A,a.end=P,a.format=T,a.min=v,a.max=l;break}}return a}function Ae(t,i,u,a){return t.substring(0,u)+i+t.substring(a)}const te=(t,i,u=1)=>{const a=[];for(;t<=i;)a.push(t),t=t+u;return a},q=(t,i,u)=>{const a=t[u],f=a==null?void 0:a.type,A=f?a==null?void 0:a.items.findIndex(P=>{var T;return P.toString().padStart(2,"0")===((T=i[f])==null?void 0:T.toString())}):"0";return`${u}-${A}`},Pe=50;function Re(t){const{isOpen:i=!0,hourStep:u=1,minuteStep:a=1,value:f=Y,hasFooter:A=!0,isUncontrolledComponent:P=!0,views:T=re,isReadOnly:l,onItemClick:v,onOkClick:x,onEscapeKeyDown:y}=t,R=d.useRef(null),V=d.useRef(null),[b,n]=d.useState([]),[O,M]=d.useState(""),[k,_]=d.useState(Y);d.useEffect(()=>{const s=[];T.forEach(h=>{switch(h){case"hours24":s.push({default:"00",items:te(0,23,u),type:"hour"});break;case"hours12":s.push({default:"01",items:te(1,12,u),type:"hour"});break;case"minutes":s.push({default:"00",items:te(0,59,a),type:"minute"});break;case"seconds":s.push({default:"00",items:te(0,59,1),type:"second"});break;case"sessions":s.push({default:ie,items:we,type:"session"});break}}),n(s)},[T,u,a]),d.useEffect(()=>{_(f||Y)},[f]),d.useEffect(()=>{i?(M(s=>{const[h]=s.split("-");return q(b,k,h?Number(h):0)}),R.current&&(R.current.style.minWidth=`${b.length*Pe}px`)):M("")},[i,k,b]);const r=d.useCallback((s,h)=>()=>{if(l)return;const g=D.cloneDeep(k);g[h]=s,Object.keys(k).map(S=>{if(S!==h&&!k[S]){const z=b.find(Q=>Q.type===S);z&&(g[S]=z.default)}}),P&&_(g),v(g)},[l,k,P,b,v]),J=()=>{x&&x()},U=(s,h)=>{const[g]=O.split("-");O?b[Number(g)]&&M(`${g}-${h}`):M(q(b,k,s))},j=(s=!1)=>{var C;const[h]=O.split("-"),g=s?b.length-1:0;if(document.activeElement===V.current){M(q(b,k,g));return}if(O){const S=s?Number(h)-1:Number(h)+1;b[S]?M(q(b,k,S)):A?((C=V.current)==null||C.focus(),M("")):M(q(b,k,g))}};return se(Ce,{onKeyDown:s=>{if(!i)return;const[h,g]=O.split("-"),C=b[Number(h)],S=(C==null?void 0:C.items.length)||0;switch(s.code){case"ArrowUp":if(s.stopPropagation(),s.preventDefault(),C){const z=Number(g)-1>=0?(Number(g)-1)%S:S-1;U(0,z)}break;case"ArrowDown":s.stopPropagation(),s.preventDefault(),C&&U(0,(Number(g)+1)%S);break;case"Tab":s.stopPropagation(),s.preventDefault(),j(s.shiftKey);break;case"Escape":y==null||y();break}},ref:R,children:[o(De,{children:b.map((s,h)=>o(Te,{className:"time-picker-dropdown-control",children:s.items.map((g,C)=>o($e,{itemId:`${h}-${C}`,focusingItemId:O,isOpen:i,selectedDisplayList:k,time:g.toString().padStart(2,"0"),selectedTime:k[s.type],displayDataType:s.type,onClickItem:r},g))},h))}),A&&o(ye,{children:o(ge,{variant:"ghost",onClick:J,tabIndex:-1,ref:V,children:"OK"})})]})}const Oe=ne.memo(Re),Ee=ne.forwardRef((t,i)=>{const{css:u={},className:a,value:f,hourStep:A=1,minuteStep:P=1,hasFooter:T=!0,formatTime:l="hh:mm AA",views:v=re,defaultValue:x,onTimeChange:y,...R}=t,[V,b]=d.useState(!1),[n,O]=d.useState(D.cloneDeep(L)),[M,k]=d.useState(D.cloneDeep(Y)),_=d.useMemo(()=>!!x||!x&&!f,[x,f]),r=d.useRef(null),J=d.useRef(null),U=he(i),j=d.useMemo(()=>ce(l),[l]);d.useEffect(()=>{const e=f??x;if(r.current&&(r.current.value=e??""),e){const{hour:c,minute:p,second:m,session:I}=j;k({hour:e.substring(c.start,c.end),minute:e.substring(p.start,p.end),second:e.substring(m.start,m.end),session:e.substring(I.start,I.end)})}else k(D.cloneDeep(Y))},[f,x]);const oe=d.useCallback(e=>{if(_&&k(e),r.current){const c=l.replace("hh",String(e.hour).padStart(2,"0")).replace("HH",String(e.hour).padStart(2,"0")).replace("mm",String(e.minute).padStart(2,"0")).replace("ss",String(e.second).padStart(2,"0")).replace("AA",String(e.session));_&&(r.current.value=c),y&&y(c)}},[T,l,_,y]),s=(e=!1)=>c=>{var p,m;!V&&e||(c==null||c.preventDefault(),c==null||c.stopPropagation(),(!((p=r.current)!=null&&p.value)||((m=r.current)==null?void 0:m.value)===l)&&(r.current&&(r.current.value=""),k(D.cloneDeep(Y))),e&&b(!1),O(D.cloneDeep(L)))},h=e=>{e.preventDefault(),C()},g=e=>{e.preventDefault(),C()},C=()=>{R.isReadOnly||R.isDisabled||setTimeout(()=>{if(r.current){r.current.value||(r.current.value=l);const e=r.current.selectionStart??0,c=X(l,e);O(c),r.current.setSelectionRange(c.start,c.end)}})},S=e=>{var W,G;if(!r.current||e.code==="Tab"||R.isReadOnly||R.isDisabled||(e.preventDefault(),e.stopPropagation(),!_&&!y))return;let p=!1;const m=r.current.value,I=m.split(""),E=+`${I[n.start]}${I[n.end-1]}`,w=l.substring(n.start,n.end),H=m.substring(n.start,n.end),Z=n.end-3,$=n.end+2;switch(e.code){case"Backspace":ee(m,w,{start:n.start,end:n.end},n);break;case"Space":break;case"ArrowLeft":if(Z<=0)return;{const K=X(l,Z);O(K),(W=r.current)==null||W.setSelectionRange(K.start,K.end)}break;case"ArrowRight":if($>l.length)return;{const K=X(l,$);O(K),(G=r.current)==null||G.setSelectionRange(K.start,K.end)}break;case"ArrowUp":Q("up",n.format,E,m,H,"AM");break;case"ArrowDown":Q("down",n.format,E,m,H,"PM");break;default:n.format==="AA"?(e.key.toLowerCase()==="a"||e.key.toLowerCase()==="p")&&ee(m,`${e.key.toUpperCase()}M`,{start:n.start,end:n.end},n):(p=/\d/.test(e.key),p&&z(m,I,e.key,$));break}},z=(e="",c=[],p,m=0)=>{let I="";const E=D.cloneDeep(n);let w=D.cloneDeep(E);+`${c[n.start]}${c[n.end-1]}${p}`<=n.max?(I=`${c[n.end-1]??"0"}${p}`,w=X(l,m)):(I=`0${p}`,+`${c[n.end-1]}0`>=n.max&&(w=X(l,m))),w.format?O(w):w=E,ee(e,I,{start:E.start,end:E.end},w)},Q=(e,c,p,m,I,E)=>{if(!r.current)return;let w="";const H=e==="up";if(c==="AA")["pm","am"].includes(I.toLowerCase())?w=I.toUpperCase()==="PM"?"AM":"PM":w=E.toUpperCase();else{const Z=H?n.min:n.max;if(isNaN(p))w=Z.toString().padStart(2,"0")??"00";else if(H){const $=p+1>n.max?n.min:p+1;w=($==null?void 0:$.toString().padStart(2,"0"))??"00"}else{const $=p-1<n.min?n.max:p-1;w=($==null?void 0:$.toString().padStart(2,"0"))??"00"}}ee(m,w,{start:n.start,end:n.end},n)},ee=(e,c,p,m)=>{if(!r.current)return;r.current.value=Ae(e,c,p.start,p.end);const{hour:I,minute:E,second:w,session:H}=j;k({hour:r.current.value.substring(I.start,I.end),minute:r.current.value.substring(E.start,E.end),second:r.current.value.substring(w.start,w.end),session:r.current.value.substring(H.start,H.end)}),Object.keys(j).some($=>{var G;const W=j[$];return W.format&&W.format===((G=r.current)==null?void 0:G.value.substring(W.start,W.end))})||y&&y(r.current.value||""),r.current.setSelectionRange(m.start,m.end)},ae=e=>{e.stopPropagation(),e.preventDefault(),!R.isDisabled&&b(c=>!c)},le=()=>{b(!1)},ue=d.useCallback(()=>{var e;(e=J.current)==null||e.focus()},[]);return o(Ie,{ref:U,className:a,css:u,children:o(me,{anchor:o(fe,{inputRef:r,onFocus:h,onBlur:s(),onClick:g,onKeyDown:S,placeholder:l,className:"time-picker-input",rightIcon:o("button",{onClick:ae,className:"time-picker-input-icon",disabled:R.isDisabled,ref:J,children:o("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:o("path",{d:"M7.34375 4.28125C7.34375 3.91758 7.63633 3.625 8 3.625C8.36367 3.625 8.65625 3.91758 8.65625 4.28125V7.65L10.9887 9.20312C11.2895 9.40547 11.3715 9.81289 11.1473 10.1137C10.9695 10.4145 10.5621 10.4965 10.2613 10.2723L7.63633 8.52227C7.45312 8.42383 7.34375 8.21875 7.34375 7.97539V4.28125ZM8 1C11.8664 1 15 4.13359 15 8C15 11.8664 11.8664 15 8 15C4.13359 15 1 11.8664 1 8C1 4.13359 4.13359 1 8 1ZM2.3125 8C2.3125 11.1418 4.8582 13.6875 8 13.6875C11.1418 13.6875 13.6875 11.1418 13.6875 8C13.6875 4.8582 11.1418 2.3125 8 2.3125C4.8582 2.3125 2.3125 4.8582 2.3125 8Z"})})}),...R}),attachToElement:U.current&&U.current.parentElement,direction:"bottom-left",offset:8,isOpen:V,onClose:s(!0),children:o(Oe,{isUncontrolledComponent:_,views:v,isOpen:V,value:M,onItemClick:oe,onOkClick:le,hourStep:A,minuteStep:P,hasFooter:T,isReadOnly:!!R.isReadOnly,onEscapeKeyDown:ue})})})}),N=Ee;N.displayName="TimePicker";const Be=()=>{const[t,i]=d.useState(""),[u,a]=d.useState("");return o(de,{children:se(pe,{children:[o("h3",{children:"Default (format: hh:mm AA)"}),o(B,{children:o(N,{defaultValue:"12:00 PM",onFocus:()=>console.log("onFocus"),onBlur:()=>console.log("onBlur")})}),o("h3",{children:"Disable"}),o(B,{children:o(N,{defaultValue:"12:00 PM",isDisabled:!0})}),o("h3",{children:"Readonly"}),o(B,{children:o(N,{defaultValue:"12:00 PM",isReadOnly:!0})}),o("h3",{children:"With 12-hours uncontrolled"}),o(B,{children:o(N,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],defaultValue:"11:05:50 PM"})}),o("h3",{children:"With 12-hours controlled"}),o(B,{children:o(N,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],value:t,onTimeChange:f=>{console.log("Value 12-hours changed: ",f),i(f)}})}),o("h3",{children:"With 24-hours uncontrolled"}),o(B,{children:o(N,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,defaultValue:"05:05:55"})}),o("h3",{children:"With 24-hours controlled"}),o(B,{children:o(N,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,value:u,onTimeChange:f=>{console.log("Value 24-hours changed: ",u),a(f)}})})]})})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Be as Default};
