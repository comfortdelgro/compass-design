import{s as j,r as v,j as p,R as ie,a as L,F as K}from"./index-ad2ef031.js";import{B as oe}from"./index-d9cdd6bb.js";import"./index-9a40c972.js";import{u as le,l as Y,_ as J,z as Q,Y as X,y as ee,$ as ue,A as ce,i as m,d as de,ap as ae,ab as fe,ak as be,e as ge,au as me,t as z,V as ve,W as he,aq as De,O as ne,av as te,aw as xe,ax as pe,a0 as Re,G as ye,p as Ve,x as Ce,a6 as Se,ae as $e,as as ke,at as re,K as I}from"./useCalendarState-636c6f66.js";import{u as Fe,a as U}from"./useEvent-73cb52e2.js";import{u as we}from"./use-dom-ref-7a1e24d2.js";import{B as E}from"./button-ea3a0e9c.js";const Te=j("div",{padding:"$3 $4 $3 $4",display:"flex",flexDirection:"column",maxWidth:"193px",width:"100%",borderRight:"1px solid #F5F5F5"}),Pe=j("button",{margin:0,padding:"$3 $4",width:"100%",maxWidth:"160px",fontSize:"$label1",textAlign:"left",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"$button",color:"$primaryText","&:hover":{borderRadius:"6px",backgroundColor:"$gray20",fontWeight:"bold"},"&:focus-visible":{outline:"none",borderRadius:"6px",boxShadow:"0px 0px 0px 4px #F2F4F7"},"&:disabled":{backgroundColor:"transparent",fontWeight:"$normal",cursor:"not-allowed"},variants:{variants:{active:{backgroundColor:"$cdgBlue10",borderRadius:"6px","&:focus-visible":{backgroundColor:"$cdgBlue10",boxShadow:"0px 0px 0px 4px #F2F4F7"}},inactive:{}}},defaultVariants:{variants:"inactive"}}),Be=t=>{const[e,d]=v.useState(null),[c,h]=v.useState(null),{state:n,customShortcuts:b=C=>C}=t,{locale:l}=le();v.useEffect(()=>{var C,B;!(c!=null&&c.start)||!c.end||e&&((C=n.value.end)==null?void 0:C.compare(c.end))!==0&&((B=n.value.start)==null?void 0:B.compare(c.start))!==0&&d(null)},[n.value]);const s=new Intl.DateTimeFormat(l).resolvedOptions().timeZone,i=Y(s),a=i.subtract({days:1}),R=i.subtract({weeks:1}),f=i.subtract({months:1}),r=J(i,l),y=Q(i,l),g=J(R,l),D=Q(R,l),T=X(i),$=ee(i),k=X(f),u=ee(f),F=ue(i),S=ce(i),V=[{label:"Today",isDisable:(()=>m(i,n.minValue,n.maxValue))(),getValue:()=>({end:i,start:i})},{label:"Yesterday",isDisable:(()=>m(a,n.minValue,n.maxValue))(),getValue:()=>({end:a,start:a})},{label:"This Week",isDisable:(()=>m(r,n.minValue,n.maxValue)||m(y,n.minValue,n.maxValue))(),getValue:()=>({start:r,end:y})},{label:"Last Week",isDisable:(()=>m(g,n.minValue,n.maxValue)||m(D,n.minValue,n.maxValue))(),getValue:()=>({start:g,end:D})},{label:"This Month",isDisable:(()=>m(T,n.minValue,n.maxValue)||m($,n.minValue,n.maxValue))(),getValue:()=>({start:T,end:$})},{label:"Last Month",isDisable:(()=>m(k,n.minValue,n.maxValue)||m(u,n.minValue,n.maxValue))(),getValue:()=>({start:k,end:u})},{label:"This Year",isDisable:(()=>m(F,n.minValue,n.maxValue)||m(S,n.minValue,n.maxValue))(),getValue:()=>({start:F,end:S})}];return{shorcuts:b(V,C=>m(C,n.minValue,n.maxValue)),selectedItem:e,setSelectedItem:d,setCurrentRangeDate:h}},Oe=t=>{const{state:e,pickerState:d}=t,{shorcuts:c,selectedItem:h,setSelectedItem:n,setCurrentRangeDate:b}=Be(t),l=s=>{var a;const i=s.getValue();d?d.setDateRange(i):e.setValue(i),i.end&&((a=e.setFocusedDate)==null||a.call(e,i.end)),n(s.label),b(i),e.setAnchorDate(null)};return p(Te,{children:c&&c.map(s=>p(Pe,{"aria-disabled":s.isDisable,type:"button",variants:h===s.label?"active":"inactive",disabled:s.isDisable,onClick:()=>l(s),children:s.label},s.label))})},Ie=Oe;function Me(t,e){var R,f,r,y;const d=de(t);if(e.visibleRange==null)return{};const c=ae(e.visibleRange.start,e.timeZone??"UTC"),h=ae(e.visibleRange.start,e.timeZone??"UTC"),n=Fe([!!t.errorMessage,t.validationState]);fe.set(e,{ariaLabel:t["aria-label"]??"",ariaLabelledBy:t["aria-labelledby"],errorMessageId:n});const b=v.useRef(!1),l=t.isDisabled||((R=e.isNextVisibleRangeInvalid)==null?void 0:R.call(e));l&&b.current&&(b.current=!1,(f=e.setFocused)==null||f.call(e,!0));const s=v.useRef(!1),i=t.isDisabled||((r=e.isPreviousVisibleRangeInvalid)==null?void 0:r.call(e));i&&s.current&&(s.current=!1,(y=e.setFocused)==null||y.call(e,!0));const a=be({id:t.id,"aria-label":[t["aria-label"],h].filter(Boolean).join(", "),"aria-labelledby":t["aria-labelledby"]});return{calendarProps:{...d,...a,role:"group","aria-describedby":t["aria-describedby"]||void 0},nextButtonProps:{onPress:()=>{var g;return(g=e.focusNextPage)==null?void 0:g.call(e)},"aria-label":"next",isDisabled:l,onFocus:()=>b.current=!0,onBlur:()=>b.current=!1},prevButtonProps:{onPress:()=>{var g;return(g=e.focusPreviousPage)==null?void 0:g.call(e)},"aria-label":"previous",isDisabled:i,onFocus:()=>s.current=!0,onBlur:()=>s.current=!1},title:c}}function We(t,e,d){const c=Me(t,e),h=v.useRef(!1),n=v.useRef(typeof window<"u"?window:null);U(n,"pointerdown",l=>{h.current=l.width===0&&l.height===0});const b=l=>{var a;if(h.current){h.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;const s=l.target,i=document.getElementById(c.calendarProps.id);i&&i.contains(document.activeElement)&&(!i.contains(s)||!s.closest('button, [role="button"]'))&&((a=e.selectFocusedDate)==null||a.call(e))};return U(n,"pointerup",b),U(n,"pointercancel",b),c.calendarProps.onBlur=l=>{var s;(!l.relatedTarget||!d.current.contains(l.relatedTarget))&&e.anchorDate&&((s=e.selectFocusedDate)==null||s.call(e))},U(d,"touchmove",l=>{e.isDragging&&l.preventDefault()},{passive:!1,capture:!0}),c}function Ae(t){var A,G,q,_;const{value:e,defaultValue:d,onChange:c,createCalendar:h,locale:n,visibleDuration:b={months:1},minValue:l,maxValue:s,...i}=t,[a,R]=ge(e,d||null,c),[f,r]=v.useState(a!=null&&a.start&&!a.end?a==null?void 0:a.start:null);let y="center";if(a&&a.start&&a.end){const x=me(z(a.start),b,n,l,s).add(b).subtract({days:1});a.end.compare(x)>0&&(y="start")}const g=v.useRef(null),[D,T]=v.useState(),$=v.useMemo(()=>ve(l,D==null?void 0:D.start),[l,D]),k=v.useMemo(()=>he(s,D==null?void 0:D.end),[s,D]),u=De({...i,value:a&&a.start,createCalendar:h,locale:n,visibleDuration:b,minValue:$,maxValue:k,selectionAlignment:y}),F=o=>{o&&t.isDateUnavailable&&!t.allowsNonContiguousRanges?(g.current={start:te(o,u,-1),end:te(o,u,1)},T(g.current)):(g.current=null,T(void 0))},S=v.useRef(u.visibleRange);(!ne((A=u.visibleRange)==null?void 0:A.start,(G=S.current)==null?void 0:G.start)||!ne((q=u.visibleRange)==null?void 0:q.end,(_=S.current)==null?void 0:_.end))&&(F(f),S.current=u.visibleRange);const V=o=>{o?(r(o),F(o)):(r(null),F(null))},P=f?Z(f,u.focusedDate):a&&Z(a.start,a.end),M=o=>{var x;if(!t.isReadOnly&&(o=xe(o,$,k),o=pe(o,(x=u.visibleRange)==null?void 0:x.start,t.isDateUnavailable),!!o))if(!f)V(o),c==null||c({start:o,end:null});else if(f.compare(o)>0)V(o),c==null||c({start:o,end:null});else{const w=Z(f,o);R({start:se(w.start,a==null?void 0:a.start),end:se(w.end,a==null?void 0:a.end)}),V(null)}},[C,B]=v.useState(!1),{isDateUnavailable:O}=t,N=v.useMemo(()=>!a||f?!1:O&&(O(a.start)||O(a.end))?!0:m(a.start,l,s)||m(a.end,l,s),[O,a,f,l,s]),W=t.validationState||(N?"invalid":null);return{...u,value:a,setValue:R,anchorDate:f,setAnchorDate:V,highlightedRange:P,validationState:W,selectFocusedDate(){M(u.focusedDate)},selectDate:M,highlightDate(o){var x;f&&((x=u.setFocusedDate)==null||x.call(u,o))},isSelected(o){var x,w;return P&&o.compare(P.start)>=0&&o.compare(P.end)<=0&&!((x=u.isCellDisabled)!=null&&x.call(u,o))&&!((w=u.isCellUnavailable)!=null&&w.call(u,o))},isInvalid(o){var x,w,H;return((x=u.isInvalid)==null?void 0:x.call(u,o))||m(o,(w=g.current)==null?void 0:w.start,(H=g.current)==null?void 0:H.end)},isDragging:C,setDragging:B}}function Z(t,e){return!t||!e?null:(e.compare(t)<0&&([t,e]=[e,t]),{start:z(t),end:z(e)})}function se(t,e){return t=Re(t,(e==null?void 0:e.calendar)||new ye),e&&"hour"in e?e.set(t):t}const Le=j("div",{width:"fit-content",backgroundColor:"$background",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.08)",borderRadius:"$md",padding:"$4","& .calendar-body":{display:"flex",justifyContent:"space-between",gap:"$2"},"& .calendar-footer":{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"$6",paddingTop:"$6",borderTop:"1px solid $gray40",color:"$primaryText"},"& .calendar-footer .calendar-footer-right-side":{display:"flex",alignItems:"center",gap:"$4"},"& .calendar-footer .preview-date":{margin:0,fontSize:"$body3"},"& .calendar-footer button":{padding:"$1 $2_5",height:"$8",fontSize:"$label2"},variants:{variants:{extend:{display:"flex",flexDirection:"row",padding:0,"& > div:nth-child(2)":{padding:"$4"}},basic:{}}},defaultVariants:{variants:"basic"}});j("div",{display:"flex",flexDirection:"row"});const Ne=ie.forwardRef((t,e)=>{var M,C,B,O,N;const{state:d,hasFooter:c,css:h={},maxValue:n=Ve("2999-02-17"),hasShortcuts:b=!1,ctaButtonRender:l,visibleMonths:s=2,onSearchButtonClick:i,customShortcuts:a,...R}=t,{locale:f}=le(),r=Ae({...R,value:t.state?(M=t.state)==null?void 0:M.value:t.value,visibleDuration:{months:s},locale:f,createCalendar:Ce}),y=we(e),{calendarProps:g,prevButtonProps:D,nextButtonProps:T}=We(R,r,y),$=Se({}),{setIsReset:k}=$e(),u=()=>{r.setValue({start:null,end:null}),r.setAnchorDate(null),k==null||k(!0)},F=()=>{var A;const W={start:Y(I()),end:Y(I())};d?d==null||d.setDateRange(W):r.setValue(W),r.setAnchorDate(null),(A=r.setFocusedDate)==null||A.call(r,Y(I()))},S=s!==1,V=!!(S&&b),P=v.useCallback(()=>l||(V?p(E,{variant:"primary",onPress:W=>i==null?void 0:i(W),children:"Search"}):p(E,{variant:"primary",onPress:F,children:"Today"})),[l,V]);return L(Le,{ref:y,css:h,variants:V?"extend":"basic",children:[V?p(Ie,{state:r,pickerState:d,customShortcuts:a}):p(K,{}),L(oe,{children:[p(ke,{state:r,variant:S?"range":"default",calendarProps:g,prevButtonProps:D,nextButtonProps:T}),L("div",{className:"calendar-body",children:[p(re,{state:r,maxValue:n}),S?p(re,{state:r,offset:{months:1},maxValue:n}):p(K,{})]}),c&&L("div",{className:"calendar-footer",children:[p(E,{variant:"ghost",onPress:u,children:"Clear"}),L("div",{className:"calendar-footer-right-side",children:[p("p",{className:"preview-date",children:(C=r==null?void 0:r.value)!=null&&C.start&&((B=r==null?void 0:r.value)!=null&&B.end)?$.formatRange(r.value.start.toDate(I()),r.value.end.toDate(I())):`${(O=r==null?void 0:r.value)!=null&&O.start?$.format(r.value.start.toDate(I())):""} - ${(N=r==null?void 0:r.value)!=null&&N.end?$.format(r.value.end.toDate(I())):""}`}),P()]})]})]})]})}),qe=Ne;export{qe as R};
