import{S as De,c as Ie,B as ne,e as re,g as Ee,f as Te,P as We,D as Ke}from"./index.styles-f65860b1.js";import{I as Oe,p as Fe,a as Ne,t as je,L as ze,D as ie,b as He}from"./utils-c3c92495.js";import{u as Ae,a as Pe,b as _e,D as Ze,c as Ue,z as Ve}from"./floating-ui.react.esm-2249639b.js";import{s as W,R as n,a as w,j as e,F as N}from"./index-4f639d7a.js";import{e as te}from"./dropdown.styles-9db1ba24.js";import{u as F}from"./use-dom-ref-172c1966.js";const Xe=W("div",{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:"$6",height:"$6",variants:{isSelected:{true:{div:{border:0,background:"$cdgBlue100",svg:{display:"block"}}},false:{svg:{display:"none"}}},checkmark:{checkbox:{div:{border:"1px solid $black",borderRadius:"3px",width:"$4",height:"$4",display:"flex",alignItems:"center",justifyContent:"center",background:"$background"},svg:{color:"$whiteText"}},none:{},tick:{svg:{color:"$cdgBlue"}}}}});function le({item:r,currentKeys:h,focusKey:p,disabledKeys:c,onSelect:d}){const f=n.useRef(null),{checkmark:g="checkbox"}=r.props,s=n.useMemo(()=>r.key?h.some(a=>a==r.key):!1,[h]),m=n.useMemo(()=>p==r.key,[p]),C=n.useMemo(()=>r.key?c.includes(r.key):!1,[c]),k=()=>{r.key&&!C&&d(r.key)};return n.useEffect(()=>{var a;m&&((a=f.current)==null||a.scrollIntoView({block:"nearest"}))},[m]),w(De,{ref:f,isFocused:m,isSelected:s,onClick:k,isDisabled:C,children:[e(Ie,{children:r.props.children}),e(Xe,{isSelected:s,checkmark:g,children:g==="checkbox"?e("div",{children:e(qe,{})}):g==="tick"?e(Ge,{}):null})]})}const qe=()=>e("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:e("path",{d:"M9.39158 1.86239C9.64736 2.12284 9.64736 2.54372 9.39158 2.80416L4.15319 8.13808C3.89741 8.39853 3.48407 8.39853 3.22829 8.13808L0.608522 5.47112C0.352823 5.21068 0.352823 4.7898 0.608522 4.52935C0.864262 4.26891 1.27883 4.26891 1.53461 4.52935L3.67232 6.72334L8.46668 1.86239C8.72246 1.60153 9.1358 1.60153 9.39158 1.86239Z",fill:"currentColor"})}),Ge=()=>e("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M15.0265 3.47966C15.4357 3.89637 15.4357 4.56978 15.0265 4.98649L6.64506 13.5208C6.23581 13.9375 5.57446 13.9375 5.16521 13.5208L0.973587 9.25363C0.564469 8.83691 0.564469 8.16351 0.973587 7.74679C1.38277 7.33008 2.04608 7.33008 2.45533 7.74679L5.87567 11.2572L13.5466 3.47966C13.9559 3.06228 14.6172 3.06228 15.0265 3.47966Z",fill:"currentColor"})});function Je(r){const h=n.useRef(null),{focusKey:p,isLoading:c,collection:d,currentKeys:f,disabledKeys:g,rootChildren:s,listBoxRef:m=h,sectionCollection:C,onSelect:k,onLoadMore:a}=r,v=()=>e("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:e("path",{d:"M9.39158 1.86239C9.64736 2.12284 9.64736 2.54372 9.39158 2.80416L4.15319 8.13808C3.89741 8.39853 3.48407 8.39853 3.22829 8.13808L0.608522 5.47112C0.352823 5.21068 0.352823 4.7898 0.608522 4.52935C0.864262 4.26891 1.27883 4.26891 1.53461 4.52935L3.67232 6.72334L8.46668 1.86239C8.72246 1.60153 9.1358 1.60153 9.39158 1.86239Z",fill:"currentColor"})}),M=()=>e("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M15.0265 3.47966C15.4357 3.89637 15.4357 4.56978 15.0265 4.98649L6.64506 13.5208C6.23581 13.9375 5.57446 13.9375 5.16521 13.5208L0.973587 9.25363C0.564469 8.83691 0.564469 8.16351 0.973587 7.74679C1.38277 7.33008 2.04608 7.33008 2.45533 7.74679L5.87567 11.2572L13.5466 3.47966C13.9559 3.06228 14.6172 3.06228 15.0265 3.47966Z",fill:"currentColor"})}),z=(x,l,u)=>{if(!l||!u)return e(N,{});switch(x){case"checkbox":return e(v,{});case"tick":return e(M,{});default:return e(N,{})}};return e(ne,{isLoading:c,listBoxRef:m,collection:d,sectionCollection:C,rootChildren:s,onLoadMore:a,renderOptions:x=>x.map(l=>w("div",{children:[l.title&&w(re,{isClickable:l.isClickable??!1,onClick:()=>{var u;return(u=l.onClick)==null?void 0:u.call(l,l.title)},children:[l.title,e(Ee,{children:z(l.checkmark??"tick",l.isClickable??!1,l.isChecked??!1)})]}),l.children.map(u=>u?e(le,{item:u,focusKey:p,currentKeys:f,disabledKeys:g,onSelect:k},u.key):null)]},l.id))})}const se=W("div",{maxWidth:"100%",minHeight:"$11",borderRadius:"$md",cursor:"text",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"$1_5 $4",gap:"$1",backgroundColor:"$background",transition:"$default",borderWidth:"1px",borderStyle:"solid",borderColor:"#E6E6E6",".dropdown-icon":{cursor:"pointer",flexShrink:0,display:"flex",justifyContent:"center",alignItems:"center",padding:0,border:"none",background:"transparent",svg:{width:"$4",height:"$4",color:"$primaryText"}},"&:focus-within":{borderColor:"$cdgBlue"},input:{height:"$6_5",width:4,padding:0,margin:0,border:"none",backgroundColor:"$background",color:"$primaryText","&:focus":{outline:"none"},"&:focus-visible":{outline:"none"}},variants:{isEmpty:{true:{button:{p:{color:"#B4B4B4"}}}},isDisabled:{true:{backgroundColor:"$gray20","*":{color:"$disabledText",cursor:"not-allowed !important"}}},isErrored:{true:{borderColor:"$danger","&:focus-within":{borderColor:"$danger"}}}}}),ce=W("div",{flexGrow:1,alignItems:"center",minHeight:"$7",display:"flex",gap:"$2_5",flexWrap:"wrap",".placeholder":{color:"#B4B4B4",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:"$label1",fontWeight:"$semibold",maxWidth:"100%",height:"fit-content",lineHeight:"1em",border:"none",textAlign:"left",padding:0,margin:0},".multiple-dropdown-chip-icon":{svg:{color:"$primaryText"}}}),Qe=W("div",{border:"1px solid #E6E6E6",borderRadius:"$full",padding:"$1 $3",fontSize:"$label1",cursor:"default",fontWeight:"$semibold",display:"flex",justifyContent:"center",alignItems:"center",gap:"$2",color:"$primaryText",div:{width:"fit-content",height:"fit-content"}}),Ye=W("div",{width:"100%",label:{fontSize:"$label1",fontWeight:"$semibold",marginBottom:"$2",display:"inline-block",width:"100%",span:{marginLeft:"$1",color:"$danger"}},variants:{displayedValue:{chip:{},string:{[`${ce}`]:{flexWrap:"nowrap",justifyContent:"flex-start",maxWidth:"calc(100% - 1rem - 1rem)",".itemListString":{maxWidth:"100%",height:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"$primaryText"}}}},variant:{combobox:{},select:{[`${se}`]:{cursor:"pointer"}}}}}),et=n.forwardRef((r,h)=>{const{collection:p,rootChildren:c,sectionCollection:d,listBoxRef:f,isLoading:g,numberOfRows:s,onLoadMore:m}=r,C=F(h);return s&&s>=0?e(Te,{ref:C,children:e(ne,{isLoading:g,collection:p,listBoxRef:f,rootChildren:c,sectionCollection:d,renderOptions:k=>k.slice(0,Math.min(s,p.length)).map(a=>w("div",{children:[a.title&&e(re,{children:a.title}),a.children.map(v=>v?e(le,{item:v,focusKey:void 0,currentKeys:[],disabledKeys:[],onSelect:()=>{}},v.key):null)]},a.id)),onLoadMore:m})}):null}),tt=et,ot=()=>w("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:[e("g",{clipPath:"url(#clip0_5299_13653)",children:e("path",{d:"M9.11731 7.88215C9.45908 8.22392 9.45908 8.77759 9.11731 9.11936C8.94779 9.29024 8.72359 9.375 8.49938 9.375C8.27518 9.375 8.05153 9.28956 7.88092 9.11867L4.99966 6.23892L2.11867 9.11799C1.94779 9.29024 1.72386 9.375 1.49993 9.375C1.276 9.375 1.05235 9.29024 0.881328 9.11799C0.539557 8.77622 0.539557 8.22255 0.881328 7.88078L3.76313 4.99897L0.881328 2.11854C0.539557 1.77677 0.539557 1.2231 0.881328 0.881328C1.2231 0.539557 1.77677 0.539557 2.11854 0.881328L4.99966 3.7645L7.88146 0.882695C8.22323 0.540925 8.7769 0.540925 9.11867 0.882695C9.46044 1.22446 9.46044 1.77813 9.11867 2.1199L6.23687 5.00171L9.11731 7.88215Z",fill:"currentColor"})}),e("defs",{children:e("clipPath",{id:"clip0_5299_13653",children:e("rect",{width:"10",height:"10",fill:"white"})})})]});function oe(r,h,p){if(h!=null&&h.length>=0){const c=[];for(const d of h)c.push(d);return c}else if(r!=null&&r.length>0&&p){const c=[];for(const d of r)c.push(d);return c}return[]}const nt=n.forwardRef((r,h)=>{const{id:p=`cdg-element-${Math.random().toString(36).substring(2)}`,css:c={},isOpen:d,children:f,isErrored:g,isDisabled:s,isRequired:m,isReadOnly:C,helperText:k,defaultOpen:a,errorMessage:v,selectedKeys:M,numberOfRows:z,displayedValue:x="chip",icon:l=e(Oe,{}),disabledKeys:u=[],isLoading:H=!1,variant:V="combobox",customDisplayValue:A,defaultSelectedKeys:X=[],label:de,placeholder:ae,onLoadMore:ue=()=>{},onBlur:he=()=>{},onFocus:fe=()=>{},onSelectionChange:P=()=>{},onOpenChange:_=()=>{},...pe}=r,[R,S]=n.useState(!1),[ge,q]=n.useState(!1),[D,ye]=n.useState(""),[b,G]=n.useState(oe(X,M)),[y,I]=n.useState(),we=F(h),K=F(null),E=F(null),me=n.useRef(null),be=n.useRef(null),J=n.useRef(null),{refs:Q,floatingStyles:Ce,context:ke}=Ae({open:R,onOpenChange:S,middleware:[Ze(8),Ue()],whileElementsMounted:Ve}),ve=Pe(ke),{getReferenceProps:xe,getFloatingProps:$e}=_e([ve]),$=n.useMemo(()=>Fe(f,ie),[f]),Y=n.useMemo(()=>Ne(f),[f]),T=n.useMemo(()=>D===""?$:$.filter(t=>{const o=je(t);return o==null?void 0:o.toLowerCase().includes(D.toLowerCase())}),[$,D]),O=n.useMemo(()=>new ze(T,u),[T,u]),B=n.useMemo(()=>{const t=[];return $.length>0&&b&&b.length>0&&b.forEach(o=>{const i=$.find(L=>L.key==o);i&&t.push({key:o,rendered:i==null?void 0:i.props.children})}),t},[b,$,b.length]);n.useEffect(()=>{G(oe(X,M,!0))},[JSON.stringify(M),$]),n.useEffect(()=>{!d&&a&&S(a),d&&S(d)},[d]),n.useEffect(()=>{var t,o;I([...b].pop()),_==null||_(R),R?(t=E.current)==null||t.focus():(o=E.current)==null||o.blur()},[R]);const Se=t=>{if(K.current){const o=t.target.value;if(ye(o),S(!0),o!==""){const i=document.createElement("div");i.style.position="absolute",i.style.top="0",i.style.left="-9999px",i.style.overflow="hidden",i.style.visibility="hidden",i.style.whiteSpace="nowrap",i.style.height="0",i.style.width="fit-content",i.style.maxWidth=`${K.current.clientWidth-62}px`,i.innerHTML=o.replace(/\s/g,"&nbsp;"),document.body.appendChild(i),t.target.focus(),t.target.style.width=`${i.clientWidth+4}px`,i.remove()}else t.target.style.width="4px"}},Le=t=>{switch(t.key){case"ArrowUp":case"ArrowLeft":{t.preventDefault();const o=y!=null&&y!=-1?O.getKeyAbove(y):O.getFirstKey();o&&I(o);break}case"ArrowDown":case"ArrowRight":{t.preventDefault();const o=y!=null&&y!=-1?O.getKeyBelow(y):O.getFirstKey();o&&I(o);break}case"Enter":{t.preventDefault(),y&&Z(y);break}case"Escape":{t.preventDefault(),S(!1);break}case"Tab":{S(!1);break}}},Z=(t,o=!1)=>{var i;if(!C){const L=new Set(b),U=b.find(Me=>Me==t);U?(L.delete(U),U==y&&I(Array.from(L).pop()??void 0)):o||(L.add(t),I(t)),G([...L]),P==null||P([...L]),(i=E.current)==null||i.focus()}},Re=t=>{Z(t,!0)},ee=()=>{var t;s||(S(!0),(t=E.current)==null||t.focus())},Be=()=>{const t=B.map(o=>o.rendered);return t.length>0?e(N,{children:t.join(", ")}):""};return w(Ye,{css:c,ref:we,...pe,displayedValue:x,variant:V,children:[de&&w("label",{onClick:ee,htmlFor:p,children:[r.label,m&&e("span",{children:"*"})]}),e("div",{ref:Q.setReference,...xe,children:w(se,{className:"dropdownContainer",ref:K,isErrored:!!g,isDisabled:!!s,onClick:ee,children:[w(ce,{className:"selectedItemWrapper",children:[B.length===0&&D===""&&!R&&!ge&&e("p",{className:"placeholder",children:ae}),x=="chip"&&B.length>0&&B.map(t=>{const o=s||u.includes(t.key);return w(Qe,{style:{cursor:s?"not-allowed":"pointer"},className:"multiple-dropdown-chip",children:[e("div",{children:t.rendered}),o?e(N,{}):e("div",{className:"multiple-dropdown-chip-icon",onClick:()=>{!s&&![...u].includes(t.key)&&Re(t.key)},children:e(ot,{})})]},t.key)}),x=="string"&&A&&B.length>0?e("div",{className:"itemListString",children:A}):x=="string"&&!A&&B.length>0?e("div",{className:"itemListString",children:Be()}):null,!s&&V=="combobox"&&e("input",{id:p,type:"text",ref:E,value:D,onChange:Se,onBlur:()=>q(!1),onFocus:()=>q(!0)})]}),e("div",{className:"dropdown-icon",children:l})]})}),T&&R&&e("div",{className:"Popover",ref:Q.setFloating,style:{...Ce,zIndex:60},...$e,children:e(We,{isEmpty:H?!1:T.length===0,visualizeRef:J,triggerRef:K,onBlur:he,onFocus:fe,handleKeyDown:Le,children:e(Je,{focusKey:y,isLoading:H,collection:T,rootChildren:f,listBoxRef:me,currentKeys:b,disabledKeys:u,sectionCollection:Y,onSelect:Z,onLoadMore:ue})})}),e(tt,{ref:be,isLoading:H,collection:$,listBoxRef:J,rootChildren:f,numberOfRows:z,sectionCollection:Y,onLoadMore:()=>{}}),g&&v&&e(te,{error:!!g,children:v}),k&&e(te,{children:k})]})}),j=nt;j.Item=ie;j.Header=Ke;j.Section=He;j.displayName="MultipleDropdown";export{j as M};
