import{R as y,r as m}from"./index-5e72961f.js";import{_ as C}from"./_define_property-1764bf98.js";function w(l){return null}w.getCollectionNode=function*(e,t){let{childItems:r,title:n,children:i}=e,u=e.title||e.children,c=e.textValue||(typeof u=="string"?u:"")||e["aria-label"]||"";!c&&!(t!=null&&t.suppressTextValueWarning)&&console.warn("<Item> with non-plain text contents is unsupported by type to select for accessibility. Please add a `textValue` prop."),yield{type:"item",props:e,rendered:u,textValue:c,"aria-label":e["aria-label"],hasChildNodes:p(e),*childNodes(){if(r)for(let f of r)yield{type:"item",value:f};else if(n){let f=[];y.Children.forEach(i,d=>{f.push({type:"item",element:d})}),yield*f}}}};function p(l){return l.hasChildItems!=null?l.hasChildItems:!!(l.childItems||l.title&&y.Children.count(l.children)>0)}let S=w;class I{build(e,t){return this.context=t,v(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:t,items:r}=e;if(typeof t=="function"){if(!r)throw new Error("props.children was a function but props.items is missing");for(let n of e.items)yield*this.getFullNode({value:n},{renderer:t})}else{let n=[];y.Children.forEach(t,u=>{n.push(u)});let i=0;for(let u of n){let c=this.getFullNode({element:u,index:i},{});for(let f of c)i++,yield f}}}getKey(e,t,r,n){if(e.key!=null)return e.key;if(t.type==="cell"&&t.key!=null)return`${n}${t.key}`;let i=t.value;if(i!=null){var u;let c=(u=i.key)!==null&&u!==void 0?u:i.id;if(c==null)throw new Error("No key found for item");return c}return n?`${n}.${t.index}`:`$.${t.index}`}getChildState(e,t){return{renderer:t.renderer||e.renderer}}*getFullNode(e,t,r,n){let i=e.element;if(!i&&e.value&&t&&t.renderer){let f=this.cache.get(e.value);if(f&&(!f.shouldInvalidate||!f.shouldInvalidate(this.context))){f.index=e.index,f.parentKey=n?n.key:null,yield f;return}i=t.renderer(e.value)}if(y.isValidElement(i)){let f=i.type;if(typeof f!="function"&&typeof f.getCollectionNode!="function"){let o=typeof i.type=="function"?i.type.name:i.type;throw new Error(`Unknown element <${o}> in collection.`)}let d=f.getCollectionNode(i.props,this.context),a=e.index,h=d.next();for(;!h.done&&h.value;){let o=h.value;e.index=a;let $=o.key;$||($=o.element?null:this.getKey(i,e,t,r));let x=[...this.getFullNode({...o,key:$,index:a,wrapper:E(e.wrapper,o.wrapper)},this.getChildState(t,o),r?`${r}${i.key}`:i.key,n)];for(let s of x){if(s.value=o.value||e.value,s.value&&this.cache.set(s.value,s),e.type&&s.type!==e.type)throw new Error(`Unsupported type <${b(s.type)}> in <${b(n.type)}>. Only <${b(e.type)}> is supported.`);a++,yield s}h=d.next(x)}return}if(e.key==null)return;let u=this,c={type:e.type,props:e.props,key:e.key,parentKey:n?n.key:null,value:e.value,level:n?n.level+1:0,index:e.index,rendered:e.rendered,textValue:e.textValue,"aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes,childNodes:v(function*(){if(!e.hasChildNodes)return;let f=0;for(let d of e.childNodes()){d.key!=null&&(d.key=`${c.key}${d.key}`),d.index=f;let a=u.getFullNode(d,u.getChildState(t,d),c.key,c);for(let h of a)f++,yield h}})};yield c}constructor(){C(this,"cache",new WeakMap)}}function v(l){let e=[],t=null;return{*[Symbol.iterator](){for(let r of e)yield r;t||(t=l());for(let r of t)e.push(r),yield r}}}function E(l,e){if(l&&e)return t=>l(e(t));if(l)return l;if(e)return e}function b(l){return l[0].toUpperCase()+l.slice(1)}function R(l,e,t,r=[]){let n=m.useMemo(()=>new I,[]),i=m.useRef(null);return m.useMemo(()=>{if(l.collection)return l.collection;let u=n.build(l,t);return i.current=e(u,i.current),i.current},[n,l.children,l.items,l.collection,t,...r])}function V(l,e){return typeof e.getChildren=="function"?e.getChildren(l.key):l.childNodes}function U(l){return F(l,0)}function F(l,e){if(e<0)return;let t=0;for(let r of l){if(t===e)return r;t++}}function W(l){let e;for(let t of l)e=t;return e}function P(l,e,t){if(e.parentKey===t.parentKey)return e.index-t.index;let r=g(l,e),n=g(l,t),i=r.slice(0,n.length).findIndex((u,c)=>u!==n[c]);return i!==-1?(e=r[i],t=n[i],e.index-t.index):-1}function g(l,e){let t=[];for(;(e==null?void 0:e.parentKey)!=null;)e=l.getItem(e.parentKey),t.unshift(e);return t}const k=new WeakMap;function z(l){let e=k.get(l);if(e!=null)return e;e=0;let t=r=>{for(let n of r)n.type==="section"?t(V(n,l)):e++};return t(l),k.set(l,e),e}export{S as $,R as a,z as b,P as c,U as d,V as e,F as f,W as g};
