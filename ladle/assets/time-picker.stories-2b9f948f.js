import{s as F,R as se,r as d,j as s,a as re,F as me}from"./index-bbce26b5.js";import{C as pe,R as B}from"./components-0a4e624a.js";import{l as x}from"./lodash-451d60d8.js";import{P as fe}from"./index-1ea1579a.js";import{T as he}from"./index-5dc97b38.js";import{u as ge}from"./use-dom-ref-b98156a9.js";import"./index-8efba24b.js";import{B as be}from"./button-183c1190.js";import"./floating-ui.react.esm-69870459.js";import"./useCurrentTheme-630429aa.js";const L={start:0,end:0,format:"",max:0,min:0},j={hour:null,minute:null,second:null,session:null},ie=["hours12","minutes","sessions"],ke=4,ce="AM",we="PM",Ie=[ce,we];F("input",{width:"100%",fontSize:"$label1",fontWeight:"$semibold",lineHeight:"$normal",padding:"$1_5 $3",border:0,borderRadius:"$md",backgroundColor:"transparent","&:focus":{outline:"none",backgroundColor:"$cdgblue120"},"&::placeholder":{color:"$tertiaryText",fontSize:"$label1",fontWeight:"$semibold"}});const De=F("div",{".time-picker-input .right-icon":{width:"$6",height:"$6"},".time-picker-input-icon":{display:"flex",cursor:"pointer",borderRadius:"$full",backgroundColor:"transparent",border:"none",padding:"$1"},".time-picker-input-icon:active":{backgroundColor:"$gray20"},".time-picker-input-icon svg":{width:"$4",height:"$4"},".time-picker-input-icon path":{fill:"$secondaryText"}}),Te=F("div",{background:"$background",border:"1px solid $divider",borderRadius:"$md",zIndex:9999}),Ce=F("div",{display:"flex",height:"$80",width:"100%",overflowY:"hidden",marginTop:"$1"}),xe=F("div",{padding:"$1",overflowY:"hidden",overflowX:"hidden",height:"100%",width:"$12_5",position:"relative","&:hover":{overflowY:"auto"},"&:not(:last-child)":{borderRight:"1px solid $divider"}}),ye=F("button",{backgroundColor:"$white",border:"none",display:"flex",justifyContent:"center",alignItems:"center",padding:"$3",borderRadius:"$md",width:"$10_5",height:"$10_5",cursor:"pointer",fontWeight:500,boxSizing:"border-box","&:hover":{backgroundColor:"$primaryBg"},fontSize:"$body3",lineHeight:"$5_25","&.active":{backgroundColor:"$cdgBlue100",color:"$background"}}),Se=F("div",{padding:"$2",display:"flex",justifyContent:"flex-end",borderTop:"1px solid $divider",button:{fontWeight:500,fontSize:"$body3",lineHeight:"$5_25"}});F("div",{display:"flex"});F("div",{whiteSpace:"break-spaces"});function $e(n){const{selectedTime:i,time:u,onClickItem:a,displayDataType:m,isOpen:R,itemId:E,focusingItemId:y}=n,l=d.useRef(null);d.useEffect(()=>{var S;E===y&&((S=l.current)==null||S.focus())},[y,E]),d.useEffect(()=>{R&&i===u&&setTimeout(()=>{O("auto")},0)},[R]),d.useEffect(()=>{i===u&&l.current&&O("smooth")},[i,u]);const O=S=>{var $;l.current&&(($=l.current.parentElement)==null||$.scroll({top:l.current.offsetTop-ke,behavior:S}))};return s(ye,{ref:l,className:`cdg-timepicker-dropdown-item ${i===u?"active":""}`,onClick:a(u,m),tabIndex:-1,children:u})}const Ae=se.memo($e);function ae(n){const i={hour:x.cloneDeep(L),minute:x.cloneDeep(L),second:x.cloneDeep(L),session:x.cloneDeep(L)};return n.includes("HH")?i.hour={start:n.indexOf("HH"),end:n.indexOf("HH")+2,format:"HH",min:0,max:23}:n.includes("hh")&&(i.hour={start:n.indexOf("hh"),end:n.indexOf("hh")+2,format:"hh",min:1,max:12}),n.includes("mm")&&(i.minute={start:n.indexOf("mm"),end:n.indexOf("mm")+2,format:"mm",min:0,max:59}),n.includes("ss")&&(i.second={start:n.indexOf("ss"),end:n.indexOf("ss")+2,format:"ss",min:0,max:59}),n.includes("AA"),n.includes("AA")&&(i.session={...x.cloneDeep(L),start:n.indexOf("AA"),end:n.indexOf("AA")+2,format:"AA"}),i}function J(n,i){const u=ae(n),a=x.cloneDeep(L);for(const m in u){const{start:R,end:E,format:y,max:l,min:O}=u[m];if(i>=R&&i<=E){a.start=R,a.end=E,a.format=y,a.min=O,a.max=l;break}}return a}function Pe(n,i,u,a){return n.substring(0,u)+i+n.substring(a)}const te=(n,i,u=1)=>{const a=[];for(;n<=i;)a.push(n),n=n+u;return a},Q=(n,i,u)=>{const a=n[u],m=a==null?void 0:a.type,R=m?a==null?void 0:a.items.findIndex(E=>{var y;return E.toString().padStart(2,"0")===((y=i[m])==null?void 0:y.toString())}):"0";return`${u}-${R}`},Re=50;function Ee(n){const{isOpen:i=!0,hourStep:u=1,minuteStep:a=1,value:m=j,hasFooter:R=!0,isUncontrolledComponent:E=!0,views:y=ie,isReadOnly:l,onItemClick:O,onOkClick:S,onEscapeKeyDown:$}=n,A=d.useRef(null),M=d.useRef(null),[b,z]=d.useState([]),[t,I]=d.useState(""),[D,_]=d.useState(j);d.useEffect(()=>{const r=[];y.forEach(h=>{switch(h){case"hours24":r.push({default:"00",items:te(0,23,u),type:"hour"});break;case"hours12":r.push({default:"01",items:te(1,12,u),type:"hour"});break;case"minutes":r.push({default:"00",items:te(0,59,a),type:"minute"});break;case"seconds":r.push({default:"00",items:te(0,59,1),type:"second"});break;case"sessions":r.push({default:ce,items:Ie,type:"session"});break}}),z(r)},[y,u,a]),d.useEffect(()=>{_(m||j)},[m]),d.useEffect(()=>{i?(I(r=>{const[h]=r.split("-");return Q(b,D,h?Number(h):0)}),A.current&&(A.current.style.minWidth=`${b.length*Re}px`)):I("")},[i,D,b]);const V=d.useCallback((r,h)=>()=>{if(l)return;const g=x.cloneDeep(D);g[h]=r,Object.keys(D).map(C=>{if(C!==h&&!D[C]){const U=b.find(ne=>ne.type===C);U&&(g[C]=U.default)}}),E&&_(g),O(g)},[l,D,E,b,O]),o=()=>{S&&S()},Y=(r,h)=>{const[g]=t.split("-");t?b[Number(g)]&&I(`${g}-${h}`):I(Q(b,D,r))},Z=(r=!1)=>{var T;const[h]=t.split("-"),g=r?b.length-1:0;if(document.activeElement===M.current){I(Q(b,D,g));return}if(t){const C=r?Number(h)-1:Number(h)+1;b[C]?I(Q(b,D,C)):R?((T=M.current)==null||T.focus(),I("")):I(Q(b,D,g))}};return re(Te,{onKeyDown:r=>{if(!i)return;const[h,g]=t.split("-"),T=b[Number(h)],C=(T==null?void 0:T.items.length)||0;switch(r.code){case"ArrowUp":if(r.stopPropagation(),r.preventDefault(),T){const U=Number(g)-1>=0?(Number(g)-1)%C:C-1;Y(0,U)}break;case"ArrowDown":r.stopPropagation(),r.preventDefault(),T&&Y(0,(Number(g)+1)%C);break;case"Tab":r.stopPropagation(),r.preventDefault(),Z(r.shiftKey);break;case"Escape":$==null||$();break}},ref:A,children:[s(Ce,{children:b.map((r,h)=>s(xe,{className:"time-picker-dropdown-control",children:r.items.map((g,T)=>s(Ae,{itemId:`${h}-${T}`,focusingItemId:t,isOpen:i,selectedDisplayList:D,time:g.toString().padStart(2,"0"),selectedTime:D[r.type],displayDataType:r.type,onClickItem:V},g))},h))}),R&&s(Se,{children:s(be,{variant:"ghost",onClick:o,tabIndex:-1,ref:M,children:"OK"})})]})}const Me=se.memo(Ee),ve=se.forwardRef((n,i)=>{const{css:u={},className:a,value:m,hourStep:R=1,minuteStep:E=1,hasFooter:y=!0,formatTime:l="hh:mm AA",views:O=ie,defaultValue:S,onTimeChange:$,onOpenChange:A,...M}=n,[b,z]=d.useState(!1),[t,I]=d.useState(x.cloneDeep(L)),[D,_]=d.useState(x.cloneDeep(j)),V=d.useMemo(()=>!!S||!S&&!m,[S,m]),o=d.useRef(null),Y=d.useRef(null),Z=ge(i),G=d.useMemo(()=>ae(l),[l]);d.useEffect(()=>{const e=m??S;if(o.current&&(o.current.value=e??""),e){const{hour:c,minute:p,second:f,session:w}=G;_({hour:e.substring(c.start,c.end),minute:e.substring(p.start,p.end),second:e.substring(f.start,f.end),session:e.substring(w.start,w.end)})}else _(x.cloneDeep(j))},[m,S]);const r=d.useCallback(e=>{if(V&&_(e),o.current){const c=l.replace("hh",String(e.hour).padStart(2,"0")).replace("HH",String(e.hour).padStart(2,"0")).replace("mm",String(e.minute).padStart(2,"0")).replace("ss",String(e.second).padStart(2,"0")).replace("AA",String(e.session));V&&(o.current.value=c),$&&$(c)}},[y,l,V,$]),h=(e=!1)=>c=>{var p,f;!b&&e||(c==null||c.preventDefault(),c==null||c.stopPropagation(),(!((p=o.current)!=null&&p.value)||((f=o.current)==null?void 0:f.value)===l)&&(o.current&&(o.current.value=""),_(x.cloneDeep(j))),e&&(z(!1),A==null||A(!1)),I(x.cloneDeep(L)))},g=e=>{e.preventDefault(),C()},T=e=>{e.preventDefault(),C()},C=()=>{M.isReadOnly||M.isDisabled||setTimeout(()=>{if(o.current){o.current.value||(o.current.value=l);const e=o.current.selectionStart??0,c=J(l,e);I(c),o.current.setSelectionRange(c.start,c.end)}})},U=e=>{var W,q;if(!o.current||e.code==="Tab"||M.isReadOnly||M.isDisabled||(e.preventDefault(),e.stopPropagation(),!V&&!$))return;let p=!1;const f=o.current.value,w=f.split(""),v=+`${w[t.start]}${w[t.end-1]}`,k=l.substring(t.start,t.end),H=f.substring(t.start,t.end),X=t.end-3,P=t.end+2;switch(e.code){case"Backspace":ee(f,k,{start:t.start,end:t.end},t);break;case"Space":break;case"ArrowLeft":if(X<=0)return;{const K=J(l,X);I(K),(W=o.current)==null||W.setSelectionRange(K.start,K.end)}break;case"ArrowRight":if(P>l.length)return;{const K=J(l,P);I(K),(q=o.current)==null||q.setSelectionRange(K.start,K.end)}break;case"ArrowUp":oe("up",t.format,v,f,H,"AM");break;case"ArrowDown":oe("down",t.format,v,f,H,"PM");break;default:t.format==="AA"?(e.key.toLowerCase()==="a"||e.key.toLowerCase()==="p")&&ee(f,`${e.key.toUpperCase()}M`,{start:t.start,end:t.end},t):(p=/\d/.test(e.key),p&&ne(f,w,e.key,P));break}},ne=(e="",c=[],p,f=0)=>{let w="";const v=x.cloneDeep(t);let k=x.cloneDeep(v);+`${c[t.start]}${c[t.end-1]}${p}`<=t.max?(w=`${c[t.end-1]??"0"}${p}`,k=J(l,f)):(w=`0${p}`,+`${c[t.end-1]}0`>=t.max&&(k=J(l,f))),k.format?I(k):k=v,ee(e,w,{start:v.start,end:v.end},k)},oe=(e,c,p,f,w,v)=>{if(!o.current)return;let k="";const H=e==="up";if(c==="AA")["pm","am"].includes(w.toLowerCase())?k=w.toUpperCase()==="PM"?"AM":"PM":k=v.toUpperCase();else{const X=H?t.min:t.max;if(isNaN(p))k=X.toString().padStart(2,"0")??"00";else if(H){const P=p+1>t.max?t.min:p+1;k=(P==null?void 0:P.toString().padStart(2,"0"))??"00"}else{const P=p-1<t.min?t.max:p-1;k=(P==null?void 0:P.toString().padStart(2,"0"))??"00"}}ee(f,k,{start:t.start,end:t.end},t)},ee=(e,c,p,f)=>{if(!o.current)return;o.current.value=Pe(e,c,p.start,p.end);const{hour:w,minute:v,second:k,session:H}=G;_({hour:o.current.value.substring(w.start,w.end),minute:o.current.value.substring(v.start,v.end),second:o.current.value.substring(k.start,k.end),session:o.current.value.substring(H.start,H.end)}),Object.keys(G).some(P=>{var q;const W=G[P];return W.format&&W.format===((q=o.current)==null?void 0:q.value.substring(W.start,W.end))})||$&&$(o.current.value||""),o.current.setSelectionRange(f.start,f.end)},le=e=>{e.stopPropagation(),e.preventDefault(),!M.isDisabled&&z(c=>(A==null||A(!c),!c))},ue=()=>{z(!1),A==null||A(!1)},de=d.useCallback(()=>{var e;(e=Y.current)==null||e.focus()},[]);return s(De,{ref:Z,className:a,css:u,children:s(fe,{anchor:s(he,{inputRef:o,onFocus:g,onBlur:h(),onClick:T,onKeyDown:U,placeholder:l,className:"time-picker-input",rightIcon:s("button",{onClick:le,className:"time-picker-input-icon",disabled:M.isDisabled,ref:Y,children:s("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s("path",{d:"M7.34375 4.28125C7.34375 3.91758 7.63633 3.625 8 3.625C8.36367 3.625 8.65625 3.91758 8.65625 4.28125V7.65L10.9887 9.20312C11.2895 9.40547 11.3715 9.81289 11.1473 10.1137C10.9695 10.4145 10.5621 10.4965 10.2613 10.2723L7.63633 8.52227C7.45312 8.42383 7.34375 8.21875 7.34375 7.97539V4.28125ZM8 1C11.8664 1 15 4.13359 15 8C15 11.8664 11.8664 15 8 15C4.13359 15 1 11.8664 1 8C1 4.13359 4.13359 1 8 1ZM2.3125 8C2.3125 11.1418 4.8582 13.6875 8 13.6875C11.1418 13.6875 13.6875 11.1418 13.6875 8C13.6875 4.8582 11.1418 2.3125 8 2.3125C4.8582 2.3125 2.3125 4.8582 2.3125 8Z"})})}),...M}),attachToElement:Z.current&&Z.current.parentElement,direction:"bottom-left",offset:8,isOpen:b,onClose:h(!0),children:s(Me,{isUncontrolledComponent:V,views:O,isOpen:b,value:D,onItemClick:r,onOkClick:ue,hourStep:R,minuteStep:E,hasFooter:y,isReadOnly:!!M.isReadOnly,onEscapeKeyDown:de})})})}),N=ve;N.displayName="TimePicker";const Ue=()=>{const[n,i]=d.useState(""),[u,a]=d.useState("");return s(me,{children:re(pe,{children:[s("h3",{children:"Default (format: hh:mm AA)"}),s(B,{children:s(N,{defaultValue:"12:00 PM",onFocus:()=>console.log("onFocus"),onBlur:()=>console.log("onBlur"),onOpenChange:m=>console.log("onOpenChange: ",m)})}),s("h3",{children:"Disable"}),s(B,{children:s(N,{defaultValue:"12:00 PM",isDisabled:!0})}),s("h3",{children:"Readonly"}),s(B,{children:s(N,{defaultValue:"12:00 PM",isReadOnly:!0})}),s("h3",{children:"With 12-hours uncontrolled"}),s(B,{children:s(N,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],defaultValue:"11:05:50 PM"})}),s("h3",{children:"With 12-hours controlled"}),s(B,{children:s(N,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],value:n,onTimeChange:m=>{console.log("Value 12-hours changed: ",m),i(m)}})}),s("h3",{children:"With 24-hours uncontrolled"}),s(B,{children:s(N,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,defaultValue:"05:05:55"})}),s("h3",{children:"With 24-hours controlled"}),s(B,{children:s(N,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,value:u,onTimeChange:m=>{console.log("Value 24-hours changed: ",u),a(m)}})})]})})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Ue as Default};
