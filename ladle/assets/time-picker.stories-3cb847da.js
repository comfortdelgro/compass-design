import{s as _,R as ee,r as p,j as s,a as ne,F as le}from"./index-d6bb7a09.js";import{C as ue,R as K}from"./components-ac652b21.js";import{l as x}from"./lodash-ca47723a.js";import{P as de}from"./index-741c3c2b.js";import{T as pe}from"./index-bdf50c21.js";import{u as me}from"./use-dom-ref-3f2db4fc.js";import"./index-255baae9.js";import{B as fe}from"./button-964d312c.js";import"./floating-ui.react.esm-400b6fa7.js";import"./useCurrentTheme-dc731eee.js";const L={start:0,end:0,format:"",max:0,min:0},z={hour:null,minute:null,second:null,session:null},se=["hours24","minutes","sessions"],he=4,oe="AM",ge="PM",be=[oe,ge];_("input",{width:"100%",fontSize:"$label1",fontWeight:"$semibold",lineHeight:"$normal",padding:"$1_5 $3",border:0,borderRadius:"$md",backgroundColor:"transparent","&:focus":{outline:"none",backgroundColor:"$cdgblue120"},"&::placeholder":{color:"$tertiaryText",fontSize:"$label1",fontWeight:"$semibold"}});const ke=_("div",{".time-picker-input .right-icon":{width:"$6",height:"$6"},".time-picker-input-icon":{display:"flex",cursor:"pointer",borderRadius:"$full",backgroundColor:"transparent",border:"none",padding:"$1"},".time-picker-input-icon:active":{backgroundColor:"$gray20"},".time-picker-input-icon svg":{width:"$4",height:"$4"},".time-picker-input-icon path":{fill:"$secondaryText"}}),we=_("div",{background:"$background",border:"1px solid $divider",borderRadius:"$md",zIndex:9999}),Ie=_("div",{display:"flex",height:"$80",width:"100%",overflowY:"hidden",marginTop:"$1"}),De=_("div",{padding:"$1",overflowY:"hidden",overflowX:"hidden",height:"100%",width:"$12_5",position:"relative","&:hover":{overflowY:"auto"},"&:not(:last-child)":{borderRight:"1px solid $divider"}}),xe=_("button",{backgroundColor:"$white",border:"none",display:"flex",justifyContent:"center",alignItems:"center",padding:"$3",borderRadius:"$md",width:"$10_5",height:"$10_5",cursor:"pointer",fontWeight:500,boxSizing:"border-box","&:hover":{backgroundColor:"$primaryBg"},fontSize:"$body3",lineHeight:"$5_25","&.active":{backgroundColor:"$cdgBlue100",color:"$background"}}),ye=_("div",{padding:"$2",display:"flex",justifyContent:"flex-end",borderTop:"1px solid $divider",button:{fontWeight:500,fontSize:"$body3",lineHeight:"$5_25"}});_("div",{display:"flex"});_("div",{whiteSpace:"break-spaces"});function Te(n){const{selectedTime:i,time:l,onClickItem:c,displayDataType:g,isOpen:S,itemId:$,focusingItemId:C}=n,d=p.useRef(null);p.useEffect(()=>{var R;$===C&&((R=d.current)==null||R.focus())},[C,$]),p.useEffect(()=>{S&&i===l&&setTimeout(()=>{M("auto")},0)},[S]),p.useEffect(()=>{i===l&&d.current&&M("smooth")},[i,l]);const M=R=>{var v;d.current&&((v=d.current.parentElement)==null||v.scroll({top:d.current.offsetTop-he,behavior:R}))};return s(xe,{ref:d,className:`cdg-timepicker-dropdown-item ${i===l?"active":""}`,onClick:c(l,g),tabIndex:-1,children:l})}const Se=ee.memo(Te);function re(n){const i={hour:x.cloneDeep(L),minute:x.cloneDeep(L),second:x.cloneDeep(L),session:x.cloneDeep(L)};return n.includes("HH")?i.hour={start:n.indexOf("HH"),end:n.indexOf("HH")+2,format:"HH",min:0,max:23}:n.includes("hh")&&(i.hour={start:n.indexOf("hh"),end:n.indexOf("hh")+2,format:"hh",min:1,max:12}),n.includes("mm")&&(i.minute={start:n.indexOf("mm"),end:n.indexOf("mm")+2,format:"mm",min:0,max:59}),n.includes("ss")&&(i.second={start:n.indexOf("ss"),end:n.indexOf("ss")+2,format:"ss",min:0,max:59}),n.includes("AA"),n.includes("AA")&&(i.session={...x.cloneDeep(L),start:n.indexOf("AA"),end:n.indexOf("AA")+2,format:"AA"}),i}function Z(n,i){const l=re(n),c=x.cloneDeep(L);for(const g in l){const{start:S,end:$,format:C,max:d,min:M}=l[g];if(i>=S&&i<=$){c.start=S,c.end=$,c.format=C,c.min=M,c.max=d;break}}return c}function $e(n,i,l,c){return n.substring(0,l)+i+n.substring(c)}const Q=(n,i,l=1)=>{const c=[];for(;n<=i;)c.push(n),n=n+l;return c},G=(n,i,l)=>{const c=n[l],g=c==null?void 0:c.type,S=g?c==null?void 0:c.items.findIndex($=>{var C;return $.toString().padStart(2,"0")===((C=i[g])==null?void 0:C.toString())}):"0";return`${l}-${S}`},Ce=50;function Ae(n){const{isOpen:i=!0,hourStep:l=1,minuteStep:c=1,value:g=z,hasFooter:S=!0,views:$=se,isReadOnly:C,onItemClick:d,onOkClick:M,onEscapeKeyDown:R}=n,v=p.useRef(null),A=p.useRef(null),[b,Y]=p.useState([]),[t,D]=p.useState(""),[y,F]=p.useState(z);p.useEffect(()=>{const r=[];$.forEach(m=>{switch(m){case"hours24":r.push({default:"00",items:Q(0,23,l),type:"hour"});break;case"hours12":r.push({default:"01",items:Q(1,12,l),type:"hour"});break;case"minutes":r.push({default:"00",items:Q(0,59,c),type:"minute"});break;case"seconds":r.push({default:"00",items:Q(0,59,1),type:"second"});break;case"sessions":r.push({default:oe,items:be,type:"session"});break}}),Y(r)},[$,l,c]),p.useEffect(()=>{F(g||z)},[g]),p.useEffect(()=>{i?(D(r=>{const[m]=r.split("-");return G(b,y,m?Number(m):0)}),v.current&&(v.current.style.minWidth=`${b.length*Ce}px`)):D("")},[i,y,b]);const o=(r,m)=>()=>{if(C)return;const f=x.cloneDeep(y);f[m]=r,Object.keys(y).map(T=>{if(T!==m&&!y[T]){const U=b.find(q=>q.type===T);U&&(f[T]=U.default)}}),F(f),d(f)},X=()=>{M&&M()},W=(r,m)=>{const[f]=t.split("-");t?b[Number(f)]&&D(`${f}-${m}`):D(G(b,y,r))},B=(r=!1)=>{var w;const[m]=t.split("-"),f=r?b.length-1:0;if(document.activeElement===A.current){D(G(b,y,f));return}if(t){const T=r?Number(m)-1:Number(m)+1;b[T]?D(G(b,y,T)):S?((w=A.current)==null||w.focus(),D("")):D(G(b,y,f))}};return ne(we,{onKeyDown:r=>{if(!i)return;const[m,f]=t.split("-"),w=b[Number(m)],T=(w==null?void 0:w.items.length)||0;switch(r.code){case"ArrowUp":if(r.stopPropagation(),r.preventDefault(),w){const U=Number(f)-1>=0?(Number(f)-1)%T:T-1;W(0,U)}break;case"ArrowDown":r.stopPropagation(),r.preventDefault(),w&&W(0,(Number(f)+1)%T);break;case"Tab":r.stopPropagation(),r.preventDefault(),B(r.shiftKey);break;case"Escape":R==null||R();break}},ref:v,children:[s(Ie,{children:b.map((r,m)=>s(De,{className:"time-picker-dropdown-control",children:r.items.map((f,w)=>s(Se,{itemId:`${m}-${w}`,focusingItemId:t,isOpen:i,selectedDisplayList:y,time:f.toString().padStart(2,"0"),selectedTime:y[r.type],displayDataType:r.type,onClickItem:o},f))},m))}),S&&s(ye,{children:s(fe,{variant:"ghost",onClick:X,tabIndex:-1,ref:A,children:"OK"})})]})}const Pe=ee.memo(Ae),Re=ee.forwardRef((n,i)=>{const{css:l={},className:c,value:g,hourStep:S=1,minuteStep:$=1,hasFooter:C=!0,formatTime:d="hh:mm AA",views:M=se,defaultValue:R,onTimeChange:v,...A}=n,[b,Y]=p.useState(!1),[t,D]=p.useState(x.cloneDeep(L)),[y,F]=p.useState(x.cloneDeep(z)),o=p.useRef(null),X=p.useRef(null),W=me(i),B=p.useMemo(()=>re(d),[d]);p.useEffect(()=>{const e=g??R;if(o.current&&(o.current.value=e??""),e){const{hour:u,minute:a,second:k,session:I}=B;F({hour:e.substring(u.start,u.end),minute:e.substring(a.start,a.end),second:e.substring(k.start,k.end),session:e.substring(I.start,I.end)})}else F(x.cloneDeep(z))},[g,R]);const te=p.useCallback(e=>{F(e),o.current&&(o.current.value=d.replace("hh",String(e.hour).padStart(2,"0")).replace("HH",String(e.hour).padStart(2,"0")).replace("mm",String(e.minute).padStart(2,"0")).replace("ss",String(e.second).padStart(2,"0")).replace("AA",String(e.session)),v&&v(o.current.value))},[C]),r=(e=!1)=>u=>{var a,k;!b&&e||(u==null||u.preventDefault(),u==null||u.stopPropagation(),(!((a=o.current)!=null&&a.value)||((k=o.current)==null?void 0:k.value)===d)&&(o.current&&(o.current.value=""),F(x.cloneDeep(z))),e&&Y(!1),D(x.cloneDeep(L)))},m=e=>{e.preventDefault(),w()},f=e=>{e.preventDefault(),w()},w=()=>{A.isReadOnly||A.isDisabled||setTimeout(()=>{if(o.current){o.current.value||(o.current.value=d);const e=o.current.selectionStart??0,u=Z(d,e);D(u),o.current.setSelectionRange(u.start,u.end)}})},T=e=>{var P,V;if(!o.current||e.code==="Tab"||A.isReadOnly||A.isDisabled)return;e.preventDefault(),e.stopPropagation();let u=!1;const a=o.current.value,k=a.split(""),I=+`${k[t.start]}${k[t.end-1]}`,E=d.substring(t.start,t.end),h=a.substring(t.start,t.end),H=t.end-3,j=t.end+2;switch(e.code){case"Backspace":J(a,E,{start:t.start,end:t.end},t);break;case"Space":break;case"ArrowLeft":if(H<=0)return;{const O=Z(d,H);D(O),(P=o.current)==null||P.setSelectionRange(O.start,O.end)}break;case"ArrowRight":if(j>d.length)return;{const O=Z(d,j);D(O),(V=o.current)==null||V.setSelectionRange(O.start,O.end)}break;case"ArrowUp":q("up",t.format,I,a,h,"AM");break;case"ArrowDown":q("down",t.format,I,a,h,"PM");break;default:t.format==="AA"?(e.key.toLowerCase()==="a"||e.key.toLowerCase()==="p")&&J(a,`${e.key.toUpperCase()}M`,{start:t.start,end:t.end},t):(u=/\d/.test(e.key),u&&U(a,k,e.key,j));break}},U=(e="",u=[],a,k=0)=>{let I="";const E=x.cloneDeep(t);let h=x.cloneDeep(E);+`${u[t.start]}${u[t.end-1]}${a}`<=t.max?(I=`${u[t.end-1]??"0"}${a}`,h=Z(d,k)):(I=`0${a}`,+`${u[t.end-1]}0`>=t.max&&(h=Z(d,k))),h.format?D(h):h=E,J(e,I,{start:E.start,end:E.end},h)},q=(e,u,a,k,I,E)=>{if(!o.current)return;let h="";const H=e==="up";if(u==="AA")["pm","am"].includes(I.toLowerCase())?h=I.toUpperCase()==="PM"?"AM":"PM":h=E.toUpperCase();else{const j=H?t.min:t.max;if(isNaN(a))h=j.toString().padStart(2,"0")??"00";else if(H){const P=a+1>t.max?t.min:a+1;h=(P==null?void 0:P.toString().padStart(2,"0"))??"00"}else{const P=a-1<t.min?t.max:a-1;h=(P==null?void 0:P.toString().padStart(2,"0"))??"00"}}J(k,h,{start:t.start,end:t.end},t)},J=(e,u,a,k)=>{if(!o.current)return;o.current.value=$e(e,u,a.start,a.end);const{hour:I,minute:E,second:h,session:H}=B;F({hour:o.current.value.substring(I.start,I.end),minute:o.current.value.substring(E.start,E.end),second:o.current.value.substring(h.start,h.end),session:o.current.value.substring(H.start,H.end)}),Object.keys(B).some(P=>{var O;const V=B[P];return V.format&&V.format===((O=o.current)==null?void 0:O.value.substring(V.start,V.end))})||v&&v(o.current.value||""),o.current.setSelectionRange(k.start,k.end)},ie=e=>{e.stopPropagation(),e.preventDefault(),!A.isDisabled&&Y(!0)},ce=()=>{Y(!1)},ae=p.useCallback(()=>{var e;(e=X.current)==null||e.focus()},[]);return s(ke,{ref:W,className:c,css:l,children:s(de,{anchor:s(pe,{inputRef:o,onFocus:m,onBlur:r(),onClick:f,onKeyDown:T,placeholder:d,className:"time-picker-input",rightIcon:s("button",{onClick:ie,className:"time-picker-input-icon",disabled:A.isDisabled,ref:X,children:s("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s("path",{d:"M7.34375 4.28125C7.34375 3.91758 7.63633 3.625 8 3.625C8.36367 3.625 8.65625 3.91758 8.65625 4.28125V7.65L10.9887 9.20312C11.2895 9.40547 11.3715 9.81289 11.1473 10.1137C10.9695 10.4145 10.5621 10.4965 10.2613 10.2723L7.63633 8.52227C7.45312 8.42383 7.34375 8.21875 7.34375 7.97539V4.28125ZM8 1C11.8664 1 15 4.13359 15 8C15 11.8664 11.8664 15 8 15C4.13359 15 1 11.8664 1 8C1 4.13359 4.13359 1 8 1ZM2.3125 8C2.3125 11.1418 4.8582 13.6875 8 13.6875C11.1418 13.6875 13.6875 11.1418 13.6875 8C13.6875 4.8582 11.1418 2.3125 8 2.3125C4.8582 2.3125 2.3125 4.8582 2.3125 8Z"})})}),...A}),attachToElement:W.current&&W.current.parentElement,direction:"bottom-left",offset:8,isOpen:b,onClose:r(!0),children:s(Pe,{views:M,isOpen:b,value:y,onItemClick:te,onOkClick:ce,hourStep:S,minuteStep:$,hasFooter:C,isReadOnly:!!A.isReadOnly,onEscapeKeyDown:ae})})})}),N=Re;N.displayName="TimePicker";const Ke=()=>{const[n,i]=p.useState(""),[l,c]=p.useState("");return s(le,{children:ne(ue,{children:[s("h3",{children:"Default (format: hh:mm AA)"}),s(K,{children:s(N,{defaultValue:"12:00 PM"})}),s("h3",{children:"Disable"}),s(K,{children:s(N,{defaultValue:"12:00 PM",isDisabled:!0})}),s("h3",{children:"Readonly"}),s(K,{children:s(N,{defaultValue:"12:00 PM",isReadOnly:!0})}),s("h3",{children:"With 12-hours uncontrolled"}),s(K,{children:s(N,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],defaultValue:"11:05:50 PM"})}),s("h3",{children:"With 12-hours controlled"}),s(K,{children:s(N,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],value:n,onTimeChange:g=>{console.log("Value 12-hours changed: ",g),i(g)}})}),s("h3",{children:"With 24-hours uncontrolled"}),s(K,{children:s(N,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,defaultValue:"05:05:55"})}),s("h3",{children:"With 24-hours controlled"}),s(K,{children:s(N,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,value:l,onTimeChange:g=>{console.log("Value 24-hours changed: ",l),c(g)}})})]})})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Ke as Default};
