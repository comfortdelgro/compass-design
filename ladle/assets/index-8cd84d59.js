"use client";import{j as S}from"./jsx-runtime-ea7736fc.js";import{c as P}from"./cloneDeep-c22ea01b.js";import{r as d,R as be}from"./index-6c164b11.js";import{P as we}from"./index-53a599f3.js";import{T as ke}from"./index-2802fc62.js";import{c as U,C as ye}from"./string-cf4adbb3.js";import{u as Ie}from"./use-dom-ref-7c72e1a5.js";import"./index-c28b9cd4.js";import{B as Te}from"./button-8faa8e19.js";const H={start:0,end:0,format:"",max:0,min:0},W={hour:null,minute:null,second:null,session:null},ie=["hours24","minutes","sessions"],De=4,oe="AM",Se="PM",Pe=[oe,Se],Ce="_timePickerInput_zopan_6",xe="_timePickerInputIcon_zopan_10",ve="_timePickerDropdownItem_zopan_28",_e="_active_zopan_47",Ne="_timePickerDropdownWrapper_zopan_51",Ae="_timePickerDropdownContent_zopan_57",Re="_timePickerDropdownControl_zopan_64",Me="_timePickerDropdownFooter_zopan_78",K={timePickerInput:Ce,timePickerInputIcon:xe,timePickerDropdownItem:ve,active:_e,timePickerDropdownWrapper:Ne,timePickerDropdownContent:Ae,timePickerDropdownControl:Re,timePickerDropdownFooter:Me};function ae(r){const{selectedTime:c,time:f,onClickItem:h,displayDataType:T,isOpen:R,itemId:C,focusingItemId:N,minTime:p=""}=r,M=d.useRef(null);d.useEffect(()=>{var w;C===N&&((w=M.current)==null||w.focus())},[N,C]),d.useEffect(()=>{R&&c===f&&setTimeout(()=>{O("auto")},0)},[R,c,f]),d.useEffect(()=>{c===f&&M.current&&O("smooth")},[c,f]);const O=w=>{var V;M.current&&((V=M.current.parentElement)==null||V.scroll({top:M.current.offsetTop-De,behavior:w}))};return S.jsx("button",{ref:M,id:C,className:U(K.timePickerDropdownItem,c===f&&K.active,`cdg-timepicker-dropdown-item__${C}`,"cdg-timepicker-dropdown-item"),onClick:h(f,T),tabIndex:-1,disabled:T!=="session"&&p==="-"||T==="session"&&p==="PM"&&f==="AM"||Number(p)>Number(f),children:f})}ae.__docgenInfo={description:"",methods:[],displayName:"TimePickerDropdownItem",props:{itemId:{required:!0,tsType:{name:"string"},description:""},focusingItemId:{required:!0,tsType:{name:"string"},description:""},selectedDisplayList:{required:!0,tsType:{name:"Record",elements:[{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:`Record<
  SelectedKey,
  string | number | null
>`},description:""},selectedTime:{required:!0,tsType:{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]},description:""},minTime:{required:!0,tsType:{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]},description:""},time:{required:!0,tsType:{name:"string"},description:""},isOpen:{required:!1,tsType:{name:"boolean"},description:""},displayDataType:{required:!0,tsType:{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},description:""},onClickItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(time: string, type: SelectedKey) => () => void",signature:{arguments:[{type:{name:"string"},name:"time"},{type:{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},name:"type"}],return:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}}}},description:""}}};function ue(r){const c={hour:P(H),minute:P(H),second:P(H),session:P(H)};return r.includes("HH")?c.hour={start:r.indexOf("HH"),end:r.indexOf("HH")+2,format:"HH",min:0,max:23}:r.includes("hh")&&(c.hour={start:r.indexOf("hh"),end:r.indexOf("hh")+2,format:"hh",min:1,max:12}),r.includes("mm")&&(c.minute={start:r.indexOf("mm"),end:r.indexOf("mm")+2,format:"mm",min:0,max:59}),r.includes("ss")&&(c.second={start:r.indexOf("ss"),end:r.indexOf("ss")+2,format:"ss",min:0,max:59}),r.includes("AA"),r.includes("AA")&&(c.session={...P(H),start:r.indexOf("AA"),end:r.indexOf("AA")+2,format:"AA"}),c}function J(r,c){const f=ue(r),h=P(H);for(const T in f){const{start:R,end:C,format:N,max:p,min:M}=f[T];if(c>=R&&c<=C){h.start=R,h.end=C,h.format=N,h.min=M,h.max=p;break}}return h}function Ee(r,c,f,h){return r.substring(0,f)+c+r.substring(h)}const ne=(r,c,f=1)=>{const h=[];for(;r<=c;)h.push(r),r=r+f;return h},Q=(r,c,f)=>{const h=r[f],T=h==null?void 0:h.type,R=T?h==null?void 0:h.items.findIndex(C=>{var N;return C.toString().padStart(2,"0")===((N=c[T])==null?void 0:N.toString())}):"0";return`${f}-${R}`},Oe=50;function ce(r){const{isOpen:c=!0,hourStep:f=1,minuteStep:h=1,value:T=W,hasFooter:R=!0,isUncontrolledComponent:C=!0,views:N=ie,isReadOnly:p,minTimeDropdownValue:M=W,onItemClick:O,onOkClick:w,onEscapeKeyDown:V}=r,x=d.useRef(null),v=d.useRef(null),[g,Y]=d.useState([]),[q,n]=d.useState(""),[y,E]=d.useState(W);d.useEffect(()=>{const a=[],b=N.findIndex(u=>u==="sessions")!==-1;N.forEach(u=>{switch(u){case"hours24":a.push({default:"00",items:ne(0,23,f),type:"hour"});break;case"hours12":a.push({default:"01",items:ne(1,b?11:12,f),type:"hour"});break;case"minutes":a.push({default:"00",items:ne(0,59,h),type:"minute"});break;case"seconds":a.push({default:"00",items:ne(0,59,1),type:"second"});break;case"sessions":a.push({default:oe,items:Pe,type:"session"});break}}),Y(a)},[N,f,h]),d.useEffect(()=>{E(T||W)},[T]),d.useEffect(()=>{c?(n(a=>{const[b]=a.split("-");return Q(g,y,b?Number(b):0)}),x.current&&(x.current.style.minWidth=`${g.length*Oe}px`)):n("")},[c,y,g]);const $=d.useCallback((a,b)=>()=>{if(p)return;const u=P(y);u[b]=a,Object.keys(y).map(I=>{if(I!==b&&!y[I]){const F=g.find(te=>te.type===I);F&&(u[I]=F.default)}}),C&&E(u),O(u)},[p,y,C,g,O]),_=()=>{w&&w()},X=(a,b)=>{var D;const[u]=q.split("-");if(!q)n(Q(g,y,a));else{const I=g[Number(u)],F=(D=x.current)==null?void 0:D.querySelector(`.cdg-timepicker-dropdown-item__${u}-${b}`);I&&!(F!=null&&F.disabled)&&n(`${u}-${b}`)}},j=(a=!1)=>{var D;const[b]=q.split("-"),u=a?g.length-1:0;if(document.activeElement===v.current){n(Q(g,y,u));return}if(q){const I=a?Number(b)-1:Number(b)+1;g[I]?n(Q(g,y,I)):R?((D=v.current)==null||D.focus(),n("")):n(Q(g,y,u))}},o=a=>{if(!c)return;const[b,u]=q.split("-"),D=g[Number(b)],I=(D==null?void 0:D.items.length)||0;switch(a.code){case"ArrowUp":if(a.stopPropagation(),a.preventDefault(),D){const F=Number(u)-1>=0?(Number(u)-1)%I:I-1;X(0,F)}break;case"ArrowDown":a.stopPropagation(),a.preventDefault(),D&&X(0,(Number(u)+1)%I);break;case"Tab":a.stopPropagation(),a.preventDefault(),j(a.shiftKey);break;case"Escape":V==null||V();break}};return S.jsxs("div",{onKeyDown:o,ref:x,className:U(K.timePickerDropdownWrapper,"cdg-time-picker-dropdown-wrapper"),children:[S.jsx("div",{className:U(K.timePickerDropdownContent,"cdg-time-picker-dropdown-wrapper"),children:g.map((a,b)=>S.jsx("div",{className:U(K.timePickerDropdownControl,"cdg-time-picker-dropdown-control"),children:a.items.map((u,D)=>S.jsx(ae,{itemId:`${b}-${D}`,focusingItemId:q,isOpen:c,selectedDisplayList:y,time:u.toString().padStart(2,"0"),selectedTime:y[a.type],minTime:M[a.type],displayDataType:a.type,onClickItem:$},u))},b))}),R&&S.jsx("div",{className:U(K.timePickerDropdownFooter,"cdg-time-picker-dropdown-footer"),children:S.jsx(Te,{variant:"ghost",onClick:_,tabIndex:-1,ref:v,children:"OK"})})]})}ce.__docgenInfo={description:"",methods:[],displayName:"TimePickerDropdown",props:{isOpen:{required:!1,tsType:{name:"boolean"},description:""},value:{required:!1,tsType:{name:"Record",elements:[{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:`Record<
  SelectedKey,
  string | number | null
>`},description:""},hourStep:{required:!1,tsType:{name:"number"},description:""},minuteStep:{required:!1,tsType:{name:"number"},description:""},hasFooter:{required:!1,tsType:{name:"boolean"},description:""},isReadOnly:{required:!1,tsType:{name:"boolean"},description:""},views:{required:!1,tsType:{name:"Array",elements:[{name:"union",raw:`| 'hours12'
| 'hours24'
| 'minutes'
| 'seconds'
| 'sessions'`,elements:[{name:"literal",value:"'hours12'"},{name:"literal",value:"'hours24'"},{name:"literal",value:"'minutes'"},{name:"literal",value:"'seconds'"},{name:"literal",value:"'sessions'"}]}],raw:"ViewType[]"},description:""},isUncontrolledComponent:{required:!0,tsType:{name:"boolean"},description:""},minTimeDropdownValue:{required:!1,tsType:{name:"Record",elements:[{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:`Record<
  SelectedKey,
  string | number | null
>`},description:""},onItemClick:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: TimePickerDropdownSelectedDisplayList) => void",signature:{arguments:[{type:{name:"Record",elements:[{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:`Record<
  SelectedKey,
  string | number | null
>`},name:"value"}],return:{name:"void"}}},description:""},onOkClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEscapeKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const le=be.forwardRef((r,c)=>{const{css:f={},className:h,value:T,hourStep:R=1,minuteStep:C=1,hasFooter:N=!0,formatTime:p="hh:mm AA",views:M=ie,defaultValue:O,minTime:w="",isFloatingPortal:V=!0,onTimeChange:x,onOpenChange:v,...g}=r,[Y,q]=d.useState(!1),[n,y]=d.useState(P(H)),[E,$]=d.useState(P(W)),[_,X]=d.useState(P(W)),j=d.useMemo(()=>!!O||!O&&!T,[O,T]),o=d.useRef(null),a=d.useRef(null),b=Ie(c),u=d.useMemo(()=>ue(p),[p]);d.useEffect(()=>{if(w&&E){const{hour:e,minute:s,second:l,session:m}=u,t={hour:w.substring(e.start,e.end),minute:w.substring(s.start,s.end),second:w.substring(l.start,l.end),session:w.substring(m.start,m.end)};t.session&&t.session===E.session||!t.session?Number(E.hour)>Number(t.hour)?(t.minute="0",t.second="0",t.session=""):Number(E.minute)>Number(t.minute)&&(t.second="0",t.session=""):t.session==="PM"&&E.session==="AM"?(t.hour="-",t.minute="-",t.second="-",t.session="PM"):(t.hour="0",t.minute="0",t.second="0",t.session=""),X(t)}},[w,E,u]),d.useEffect(()=>{const e=T??O;if(o.current&&(o.current.value=e??""),e){const{hour:s,minute:l,second:m,session:t}=u;$({hour:e.substring(s.start,s.end),minute:e.substring(l.start,l.end),second:e.substring(m.start,m.end),session:e.substring(t.start,t.end)})}else $(P(W))},[T,O,u]);const D=d.useCallback(e=>{if(j&&$(e),o.current){const s=p.replace("hh",String(e.hour).padStart(2,"0")).replace("HH",String(e.hour).padStart(2,"0")).replace("mm",String(e.minute).padStart(2,"0")).replace("ss",String(e.second).padStart(2,"0")).replace("AA",String(e.session));j&&(o.current.value=s),x&&x(s)}},[p,j,x]),I=d.useCallback(()=>{const{hour:e,minute:s,second:l,session:m}=u,t={hour:w.substring(e.start,e.end),minute:w.substring(s.start,s.end),second:w.substring(l.start,l.end),session:w.substring(m.start,m.end)};let k=!1;const i={...E};(Number(i.hour)<Number(_.hour)||_.hour==="-")&&(k=!0,i.hour=t.hour),(Number(i.minute)<Number(_.minute)||_.minute==="-")&&(k=!0,i.minute=t.minute),(Number(i.second)<Number(_.second)||_.second==="-")&&(k=!0,i.second=t.second),i.session==="AM"&&_.session==="PM"&&(k=!0,i.session="PM");const L=p.replace("hh",String(i.hour).padStart(2,"0")).replace("HH",String(i.hour).padStart(2,"0")).replace("mm",String(i.minute).padStart(2,"0")).replace("ss",String(i.second).padStart(2,"0")).replace("AA",String(i.session));k&&j&&o.current&&(o.current.value=L),k&&($(i),x&&x(L))},[p,j,w,_.hour,_.minute,_.second,_.session,x,E,u]),F=d.useCallback((e=!1)=>s=>{var l,m;!Y&&e||(s==null||s.preventDefault(),s==null||s.stopPropagation(),!((l=o.current)!=null&&l.value)||((m=o.current)==null?void 0:m.value)===p?(o.current&&(o.current.value=""),$(P(W))):I(),e&&(q(!1),v==null||v(!1)),y(P(H)))},[p,Y,v,I]),te=e=>{e.preventDefault(),se()},me=e=>{e.preventDefault(),se()},se=()=>{g.isReadOnly||g.isDisabled||setTimeout(()=>{if(o.current){o.current.value||(o.current.value=p);const e=o.current.selectionStart??0,s=J(p,e);y(s),o.current.setSelectionRange(s.start,s.end)}})},de=e=>{var z,G;if(!o.current||e.code==="Tab"||g.isReadOnly||g.isDisabled||(e.preventDefault(),e.stopPropagation(),!j&&!x))return;let l=!1;const m=o.current.value,t=m.split(""),k=+`${t[n.start]}${t[n.end-1]}`,i=p.substring(n.start,n.end),L=m.substring(n.start,n.end),Z=n.end-3,A=n.end+2;switch(e.code){case"Backspace":ee(m,i,{start:n.start,end:n.end},n);break;case"Space":break;case"ArrowLeft":if(Z<=0)return;{const B=J(p,Z);y(B),(z=o.current)==null||z.setSelectionRange(B.start,B.end)}break;case"ArrowRight":if(A>p.length)return;{const B=J(p,A);y(B),(G=o.current)==null||G.setSelectionRange(B.start,B.end)}break;case"ArrowUp":re("up",n.format,k,m,L,"AM");break;case"ArrowDown":re("down",n.format,k,m,L,"PM");break;default:n.format==="AA"?(e.key.toLowerCase()==="a"||e.key.toLowerCase()==="p")&&ee(m,`${e.key.toUpperCase()}M`,{start:n.start,end:n.end},n):(l=/\d/.test(e.key),l&&pe(m,t,e.key,A));break}},pe=(e="",s=[],l,m=0)=>{let t="";const k=P(n);let i=P(k);+`${s[n.start]}${s[n.end-1]}${l}`<=n.max?(t=`${s[n.end-1]??"0"}${l}`,i=J(p,m)):(t=`0${l}`,+`${s[n.end-1]}0`>=n.max&&(i=J(p,m))),i.format?y(i):i=k,ee(e,t,{start:k.start,end:k.end},i)},re=(e,s,l,m,t,k)=>{if(!o.current)return;let i="";const L=e==="up";if(s==="AA")["pm","am"].includes(t.toLowerCase())?i=t.toUpperCase()==="PM"?"AM":"PM":i=k.toUpperCase();else{const Z=L?n.min:n.max;if(isNaN(l))i=Z.toString().padStart(2,"0")??"00";else if(L){const A=l+1>n.max?n.min:l+1;i=(A==null?void 0:A.toString().padStart(2,"0"))??"00"}else{const A=l-1<n.min?n.max:l-1;i=(A==null?void 0:A.toString().padStart(2,"0"))??"00"}}ee(m,i,{start:n.start,end:n.end},n)},ee=(e,s,l,m)=>{if(!o.current)return;o.current.value=Ee(e,s,l.start,l.end);const{hour:t,minute:k,second:i,session:L}=u;$({hour:o.current.value.substring(t.start,t.end),minute:o.current.value.substring(k.start,k.end),second:o.current.value.substring(i.start,i.end),session:o.current.value.substring(L.start,L.end)}),Object.keys(u).some(A=>{var G;const z=u[A];return z.format&&z.format===((G=o.current)==null?void 0:G.value.substring(z.start,z.end))})||x&&x(o.current.value||""),o.current.setSelectionRange(m.start,m.end)},fe=e=>{e.stopPropagation(),e.preventDefault(),!g.isDisabled&&q(s=>(v==null||v(!s),!s))},he=()=>{I(),q(!1),v==null||v(!1)},ge=d.useCallback(()=>{var e;(e=a.current)==null||e.focus()},[]);return S.jsx(ye,{css:f,childrenRef:b,children:S.jsx("div",{ref:b,className:U(K.timePickerContainer,h,"cdg-time-picker-container"),children:S.jsx(we,{anchor:S.jsx(ke,{inputRef:o,onFocus:te,onBlur:F(),onClick:me,onKeyDown:de,placeholder:p,className:U(K.timePickerInput,"cdg-time-picker-input"),rightIcon:S.jsx("button",{onClick:fe,className:U(K.timePickerInputIcon,"cdg-time-picker-input-icon"),disabled:g.isDisabled,ref:a,children:S.jsx("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:S.jsx("path",{d:"M7.34375 4.28125C7.34375 3.91758 7.63633 3.625 8 3.625C8.36367 3.625 8.65625 3.91758 8.65625 4.28125V7.65L10.9887 9.20312C11.2895 9.40547 11.3715 9.81289 11.1473 10.1137C10.9695 10.4145 10.5621 10.4965 10.2613 10.2723L7.63633 8.52227C7.45312 8.42383 7.34375 8.21875 7.34375 7.97539V4.28125ZM8 1C11.8664 1 15 4.13359 15 8C15 11.8664 11.8664 15 8 15C4.13359 15 1 11.8664 1 8C1 4.13359 4.13359 1 8 1ZM2.3125 8C2.3125 11.1418 4.8582 13.6875 8 13.6875C11.1418 13.6875 13.6875 11.1418 13.6875 8C13.6875 4.8582 11.1418 2.3125 8 2.3125C4.8582 2.3125 2.3125 4.8582 2.3125 8Z"})})}),...g}),attachToElement:b.current&&b.current.parentElement,direction:"bottom-left",offset:8,isOpen:Y,onOutsidePress:F(!0),isFloatingPortal:V,children:S.jsx(ce,{isUncontrolledComponent:j,views:M,isOpen:Y,value:E,onItemClick:D,onOkClick:he,hourStep:R,minuteStep:C,hasFooter:N,isReadOnly:!!g.isReadOnly,onEscapeKeyDown:ge,minTimeDropdownValue:_})})})})});le.__docgenInfo={description:"",methods:[],displayName:"TimePicker"};le.displayName="TimePicker";export{le as T};
