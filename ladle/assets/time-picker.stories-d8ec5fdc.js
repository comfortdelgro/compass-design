import{s as x,R as U,r as h,j as t,F as X,a as q}from"./index-4c46b99a.js";import{C as ce,R as _}from"./components-343e0105.js";import{l as k}from"./lodash-96f53229.js";import{P as ae}from"./index-62535533.js";import{T as le}from"./index-c052ceac.js";import{u as de}from"./use-dom-ref-6bf95fd0.js";import"./index-b53f8881.js";import{B as ue}from"./button-31ab96fd.js";import"./floating-ui.react.esm-c385e38b.js";import"./useCurrentTheme-1a102d04.js";const R={start:0,end:0,format:"",max:0,min:0},V={hour:null,minute:null,second:null,session:null},J=["hours24","minutes","sessions"],me=4,Q="AM",pe="PM",he=[Q,pe];x("input",{width:"100%",fontSize:"$label1",fontWeight:"$semibold",lineHeight:"$normal",padding:"$1_5 $3",border:0,borderRadius:"$md",backgroundColor:"transparent","&:focus":{outline:"none",backgroundColor:"$cdgblue120"},"&::placeholder":{color:"$tertiaryText",fontSize:"$label1",fontWeight:"$semibold"}});const fe=x("div",{".time-picker-input .right-icon":{width:"$6",height:"$6"},".time-picker-input-icon":{display:"flex",cursor:"pointer",borderRadius:"$full"},".time-picker-input-icon:active":{backgroundColor:"$gray20"},".time-picker-input-icon svg":{width:"$6",height:"$6"}}),ge=x("div",{background:"$background",border:"1px solid $divider",borderRadius:"$md",zIndex:9999}),ke=x("div",{display:"flex",height:"$80",width:"100%",overflowY:"hidden",marginTop:"$1"}),be=x("div",{padding:"$1",overflowY:"hidden",overflowX:"hidden",height:"100%",width:"$12_5",position:"relative","&:hover":{overflowY:"auto"},"&:not(:last-child)":{borderRight:"1px solid $divider"}}),we=x("button",{backgroundColor:"$white",border:"none",display:"flex",justifyContent:"center",alignItems:"center",padding:"$3",borderRadius:"$md",width:"$10_5",height:"$10_5",cursor:"pointer",fontWeight:500,boxSizing:"border-box","&:hover":{backgroundColor:"$infoBg"},fontSize:"$body3",lineHeight:"$5_25","&.active":{backgroundColor:"$cdgBlue100",color:"$background"}}),Ce=x("div",{padding:"$2",display:"flex",justifyContent:"flex-end",borderTop:"1px solid $divider",button:{fontWeight:500,fontSize:"$body3",lineHeight:"$5_25"}});x("div",{display:"flex"});x("div",{whiteSpace:"break-spaces"});function Se(s){const{selectedTime:c,time:a,onClickItem:l,displayDataType:g,isOpen:$}=s,C=h.useRef(null);h.useEffect(()=>{$&&c===a&&setTimeout(()=>{T("auto")},0)},[$]),h.useEffect(()=>{c===a&&C.current&&T("smooth")},[c,a]);const T=d=>{var A;C.current&&((A=C.current.parentElement)==null||A.scroll({top:C.current.offsetTop-me,behavior:d}))};return t(we,{ref:C,className:c===a?"active":"",onClick:l(a,g),children:a})}const De=U.memo(Se);function ee(s){const c={hour:k.cloneDeep(R),minute:k.cloneDeep(R),second:k.cloneDeep(R),session:k.cloneDeep(R)};return s.includes("HH")?c.hour={start:s.indexOf("HH"),end:s.indexOf("HH")+2,format:"HH",min:0,max:23}:s.includes("hh")&&(c.hour={start:s.indexOf("hh"),end:s.indexOf("hh")+2,format:"hh",min:1,max:12}),s.includes("mm")&&(c.minute={start:s.indexOf("mm"),end:s.indexOf("mm")+2,format:"mm",min:0,max:59}),s.includes("ss")&&(c.second={start:s.indexOf("ss"),end:s.indexOf("ss")+2,format:"ss",min:0,max:59}),s.includes("AA"),s.includes("AA")&&(c.session={...k.cloneDeep(R),start:s.indexOf("AA"),end:s.indexOf("AA")+2,format:"AA"}),c}function B(s,c){const a=ee(s),l=k.cloneDeep(R);for(const g in a){const{start:$,end:C,format:T,max:d,min:A}=a[g];if(c>=$&&c<=C){l.start=$,l.end=C,l.format=T,l.min=A,l.max=d;break}}return l}function Te(s,c,a,l){return s.substring(0,a)+c+s.substring(l)}const j=(s,c,a=1)=>{const l=[];for(;s<=c;)l.push(s),s=s+a;return l};function ye(s){const{isOpen:c=!0,hourStep:a=1,minuteStep:l=1,value:g=V,hasFooter:$=!0,onItemClick:C,onOkClick:T,views:d=J,isReadOnly:A}=s,[N,F]=h.useState([]),[b,H]=h.useState(V);h.useEffect(()=>{const m=[];d.forEach(I=>{switch(I){case"hours24":m.push({default:"00",items:j(0,23,a),type:"hour"});break;case"hours12":m.push({default:"01",items:j(1,12,a),type:"hour"});break;case"minutes":m.push({default:"00",items:j(0,59,l),type:"minute"});break;case"seconds":m.push({default:"00",items:j(0,59,1),type:"second"});break;case"sessions":m.push({default:Q,items:he,type:"session"});break}}),F(m)},[d,a,l]),h.useEffect(()=>{H(g||V)},[g]);const W=(m,I)=>()=>{if(A)return;const w=k.cloneDeep(b);w[I]=m,Object.keys(b).map(P=>{if(P!==I&&!b[P]){const M=N.find(z=>z.type===P);M&&(w[P]=M.default)}}),H(w),C(w)},n=()=>{T&&T()};return t(X,{children:q(ge,{children:[t(ke,{children:N.map((m,I)=>t(be,{className:"time-picker-dropdown-control",children:m.items.map(w=>t(De,{isOpen:c,selectedDisplayList:b,time:w.toString().padStart(2,"0"),selectedTime:b[m.type],displayDataType:m.type,onClickItem:W},w))},I))}),$&&t(Ce,{children:t(ue,{variant:"ghost",onClick:n,children:"OK"})})]})})}const $e=U.memo(ye),xe=U.forwardRef((s,c)=>{const{css:a={},className:l,value:g,hourStep:$=1,minuteStep:C=1,hasFooter:T=!0,formatTime:d="hh:mm AA",views:A=J,defaultValue:N,onTimeChange:F,...b}=s,[H,W]=h.useState(!1),[n,m]=h.useState(k.cloneDeep(R)),[I,w]=h.useState(k.cloneDeep(V)),o=h.useRef(null),P=de(c),M=h.useMemo(()=>ee(d),[d]);h.useEffect(()=>{const e=g??N;if(o.current&&(o.current.value=e??""),e){const{hour:i,minute:r,second:p,session:f}=M;w({hour:e.substring(i.start,i.end),minute:e.substring(r.start,r.end),second:e.substring(p.start,p.end),session:e.substring(f.start,f.end)})}else w(k.cloneDeep(V))},[g,N]);const z=h.useCallback(e=>{w(e),o.current&&(o.current.value=d.replace("hh",String(e.hour).padStart(2,"0")).replace("HH",String(e.hour).padStart(2,"0")).replace("mm",String(e.minute).padStart(2,"0")).replace("ss",String(e.second).padStart(2,"0")).replace("AA",String(e.session)),F&&F(o.current.value))},[T]),Y=(e=!1)=>i=>{var r,p;!H&&e||(i==null||i.preventDefault(),i==null||i.stopPropagation(),(!((r=o.current)!=null&&r.value)||((p=o.current)==null?void 0:p.value)===d)&&(o.current&&(o.current.value=""),w(k.cloneDeep(V))),e&&W(!1),m(k.cloneDeep(R)))},te=e=>{e.preventDefault(),Z()},ne=e=>{e.preventDefault(),Z()},Z=()=>{b.isReadOnly||b.isDisabled||setTimeout(()=>{if(o.current){o.current.value||(o.current.value=d);const e=o.current.selectionStart??0,i=B(d,e);m(i),o.current.setSelectionRange(i.start,i.end)}})},se=e=>{var S,E;if(!o.current||e.code==="Tab"||b.isReadOnly||b.isDisabled)return;e.preventDefault(),e.stopPropagation();let i=!1;const r=o.current.value,p=r.split(""),f=+`${p[n.start]}${p[n.end-1]}`,D=d.substring(n.start,n.end),u=r.substring(n.start,n.end),v=n.end-3,L=n.end+2;switch(e.code){case"Backspace":K(r,D,{start:n.start,end:n.end},n);break;case"Space":break;case"ArrowLeft":if(v<=0)return;{const y=B(d,v);m(y),(S=o.current)==null||S.setSelectionRange(y.start,y.end)}break;case"ArrowRight":if(L>d.length)return;{const y=B(d,L);m(y),(E=o.current)==null||E.setSelectionRange(y.start,y.end)}break;case"ArrowUp":G("up",n.format,f,r,u,"AM");break;case"ArrowDown":G("down",n.format,f,r,u,"PM");break;default:n.format==="AA"?(e.key.toLowerCase()==="a"||e.key.toLowerCase()==="p")&&K(r,`${e.key.toUpperCase()}M`,{start:n.start,end:n.end},n):(i=/\d/.test(e.key),i&&oe(r,p,e.key,L));break}},oe=(e="",i=[],r,p=0)=>{let f="";const D=k.cloneDeep(n);let u=k.cloneDeep(D);+`${i[n.start]}${i[n.end-1]}${r}`<=n.max?(f=`${i[n.end-1]??"0"}${r}`,u=B(d,p)):(f=`0${r}`,+`${i[n.end-1]}0`>=n.max&&(u=B(d,p))),u.format?m(u):u=D,K(e,f,{start:D.start,end:D.end},u)},G=(e,i,r,p,f,D)=>{if(!o.current)return;let u="";const v=e==="up";if(i==="AA")["pm","am"].includes(f.toLowerCase())?u=f.toUpperCase()==="PM"?"AM":"PM":u=D.toUpperCase();else{const L=v?n.min:n.max;if(isNaN(r))u=L.toString().padStart(2,"0")??"00";else if(v){const S=r+1>n.max?n.min:r+1;u=(S==null?void 0:S.toString().padStart(2,"0"))??"00"}else{const S=r-1<n.min?n.max:r-1;u=(S==null?void 0:S.toString().padStart(2,"0"))??"00"}}K(p,u,{start:n.start,end:n.end},n)},K=(e,i,r,p)=>{if(!o.current)return;o.current.value=Te(e,i,r.start,r.end);const{hour:f,minute:D,second:u,session:v}=M;w({hour:o.current.value.substring(f.start,f.end),minute:o.current.value.substring(D.start,D.end),second:o.current.value.substring(u.start,u.end),session:o.current.value.substring(v.start,v.end)}),Object.keys(M).some(S=>{var y;const E=M[S];return E.format&&E.format===((y=o.current)==null?void 0:y.value.substring(E.start,E.end))})||F&&F(o.current.value||""),o.current.setSelectionRange(p.start,p.end)},re=()=>{b.isDisabled||W(!0)},ie=()=>{W(!1)};return t(fe,{ref:P,className:l,css:a,children:t(ae,{anchor:t(le,{inputRef:o,onFocus:te,onBlur:Y(),onClick:ne,onKeyDown:se,placeholder:d,className:"time-picker-input",rightIcon:t("div",{onClick:re,className:"time-picker-input-icon",children:t("svg",{viewBox:"0 0 24 24",children:t("path",{d:"M11.3438 8.28125C11.3438 7.91758 11.6363 7.625 12 7.625C12.3637 7.625 12.6562 7.91758 12.6562 8.28125V11.65L14.9887 13.2031C15.2895 13.4055 15.3715 13.8129 15.1473 14.1137C14.9695 14.4145 14.5621 14.4965 14.2613 14.2723L11.6363 12.5223C11.4531 12.4238 11.3438 12.2188 11.3438 11.9754V8.28125ZM12 5C15.8664 5 19 8.13359 19 12C19 15.8664 15.8664 19 12 19C8.13359 19 5 15.8664 5 12C5 8.13359 8.13359 5 12 5ZM6.3125 12C6.3125 15.1418 8.8582 17.6875 12 17.6875C15.1418 17.6875 17.6875 15.1418 17.6875 12C17.6875 8.8582 15.1418 6.3125 12 6.3125C8.8582 6.3125 6.3125 8.8582 6.3125 12Z",fill:"currentColor"})})}),...b}),attachToElement:P.current&&P.current.parentElement,offset:8,isOpen:H,onClose:Y(!0),children:t($e,{views:A,isOpen:H,value:I,onItemClick:z,onOkClick:ie,hourStep:$,minuteStep:C,hasFooter:T,isReadOnly:!!b.isReadOnly})})})}),O=U.memo(xe);O.displayName="TimePicker";const He=()=>{const[s,c]=h.useState(""),[a,l]=h.useState("");return t(X,{children:q(ce,{children:[t("h3",{children:"Default (format: hh:mm AA)"}),t(_,{children:t(O,{defaultValue:"12:00 PM"})}),t("h3",{children:"Disable"}),t(_,{children:t(O,{defaultValue:"12:00 PM",isDisabled:!0})}),t("h3",{children:"Readonly"}),t(_,{children:t(O,{defaultValue:"12:00 PM",isReadOnly:!0})}),t("h3",{children:"With 12-hours uncontrolled"}),t(_,{children:t(O,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],defaultValue:"11:05:50 PM"})}),t("h3",{children:"With 12-hours controlled"}),t(_,{children:t(O,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],value:s,onTimeChange:g=>{console.log("Value 12-hours changed: ",g),c(g)}})}),t("h3",{children:"With 24-hours uncontrolled"}),t(_,{children:t(O,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,defaultValue:"05:05:55"})}),t("h3",{children:"With 24-hours controlled"}),t(_,{children:t(O,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,value:a,onTimeChange:g=>{console.log("Value 24-hours changed: ",a),l(g)}})})]})})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{He as Default};
