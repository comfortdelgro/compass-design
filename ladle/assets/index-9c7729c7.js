import{r as O,s as S,R as F,j as y,a as x,F as k}from"./index-bbce26b5.js";import{C as I}from"./calendar-c8226834.js";import{u as B,a as W,b as w,c as U,d as Z,D as $,P as K,e as j}from"./useOverlayTriggerState-ac8b5fcb.js";import{b as R,u as E,a as q,d as G,c as L,r as N,e as z,i as A,g as C,h as H,D as J,t as Q,j as X,p as M,k as Y}from"./useCalendarState-7485952b.js";import{u as _}from"./use-dom-ref-b98156a9.js";function p(e,a,i){const l=R(),r=R(),t=R(),{labelProps:o,fieldProps:s,descriptionProps:f,errorMessageProps:b}=B({...e,labelElementType:"span"}),c=W(a,i),u=s["aria-labelledby"]||s.id,{locale:m}=E(),h=a.formatValue(m,{month:"long"}),D=h?`selectedDateDescription ${h}`:"",g=q(D),P=[g["aria-describedby"],s["aria-describedby"]].filter(Boolean).join(" ")||void 0,V=G(e),v=O.useMemo(()=>L(i),[i]),{focusWithinProps:n}=w({...e,isDisabled:a.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...V,...c,...s,...g,...n,role:"group","aria-disabled":e.isDisabled||null,"aria-labelledby":u,"aria-describedby":P,onKeyDown(d){a.isOpen||e.onKeyDown&&e.onKeyDown(d)},onKeyUp(d){a.isOpen||e.onKeyUp&&e.onKeyUp(d)}},labelProps:{...o,onClick:()=>{v.focusFirst()}},fieldProps:{...s,id:t,[N]:"presentation","aria-describedby":P,value:a.value,onChange:a.setValue,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:a.validationState,autoFocus:e.autoFocus},descriptionProps:f,errorMessageProps:b,buttonProps:{...g,id:l,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${u} ${l}`,"aria-describedby":P,"aria-expanded":a.isOpen||void 0,onPress:()=>a.setOpen(!0)},dialogProps:{id:r,"aria-labelledby":`${u} ${l}`},calendarProps:{autoFocus:!0,value:a.dateValue,onChange:a.setDateValue,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,defaultFocusedValue:a.dateValue?void 0:e.placeholderValue,validationState:a.validationState,errorMessage:e.errorMessage}}}function ee(e){var v;const a=U(e),[i,l]=z(e.value,e.defaultValue,e.onChange),r=i||e.placeholderValue,[t,o]=Z(r,e.granularity),s=i!=null?i.toDate(o??"UTC"):null,f=t==="hour"||t==="minute"||t==="second",b=e.shouldCloseOnSelect??!0,[c,u]=O.useState(),[m,h]=O.useState();if(O.useEffect(()=>{i&&(u(i),"hour"in i&&h(i))},[i]),r&&!(t in r))throw new Error("Invalid granularity "+t+" for value "+r.toString());const D=(n,d)=>{l("timeZone"in d?d.set(Q(n)):X(n,d)),u(void 0),h(void 0)},g=n=>{const d=typeof b=="function"?b():b;f?m||d?D(n,m||C(e.placeholderValue)):u(n):l(n),d&&setTimeout(()=>{a.setOpen(!1)},0)},P=n=>{c?D(c,n):h(n)},V=e.validationState||(A(i,e.minValue,e.maxValue)?"invalid":null)||(i&&((v=e.isDateUnavailable)!=null&&v.call(e,i))?"invalid":null);return{value:i,setValue:l,dateValue:c,timeValue:m,setDateValue:g,setTimeValue:P,granularity:t,hasTime:f,...a,setOpen(n){!n&&!i&&c&&f&&D(c,m||C(e.placeholderValue)),a.setOpen(n)},validationState:V,formatValue(n,d){if(!s)return"";const T=H(d,{granularity:t,timeZone:o,hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:i.calendar.identifier==="gregory"&&i.era==="BC"});return new J(n,T).format(s)}}}const ae=S("div",{width:"fit-content"}),ie=S("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),le=F.forwardRef((e,a)=>{const{css:i={},maxValue:l=M("2999-03-10"),ctaButtonRender:r}=e,t=ee({...e,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:e.shouldCloseOnSelect??!1}),o=_(a),{groupProps:s,fieldProps:f,buttonProps:b,dialogProps:c,calendarProps:u}=p({...e,isReadOnly:e.isReadOnly?!0:!!e.isMobile},t,o),m={necessityIndicator:e.necessityIndicator,...f},h=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return u.isReadOnly=h(),y(ae,{css:i,children:x(Y,{children:[y(te,{ref:o,groupProps:s,fieldProps:m,buttonProps:b,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,label:e.label,errorMessage:e.errorMessage,helperText:e.helperText}),y(ne,{maxValue:l,state:t,calendarProps:u,calendarRef:o,dialogProps:c,css:e.calendarCSS,ctaButtonRender:r})]})})}),te=F.forwardRef((e,a)=>{const{groupProps:i,fieldProps:l,buttonProps:r,label:t,isInvalid:o,isMobile:s,isReadOnly:f=!1,errorMessage:b,helperText:c}=e;return y(ie,{...i,ref:a,children:y($,{...l,"aria-describedby":l["aria-describedby"]??"",buttonProps:r,label:t,isInvalid:o,isMobile:s,isReadOnly:f,errorMessage:b,helperText:c})})}),ne=e=>{const{state:a,calendarRef:i,dialogProps:l,calendarProps:r,maxValue:t=M("2999-03-10"),ctaButtonRender:o,css:s={}}=e;return y(k,{children:a.isOpen&&y(K,{state:a,triggerRef:i,offset:8,placement:"bottom start",children:y(j,{...l,"aria-describedby":l["aria-describedby"]??"","aria-label":l["aria-label"]??"","aria-labelledby":l["aria-labelledby"]??"",children:y(I,{state:a,hasFooter:!0,...r,maxValue:t,css:s,ctaButtonRender:o})})})})},se=le;se.displayName="DatePicker";export{se as D};
