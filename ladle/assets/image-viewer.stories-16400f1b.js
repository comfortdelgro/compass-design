import{s as Z,j as i,a as j,r as f,F as te,R as X}from"./index-f44380ee.js";import"./index-848668cb.js";import{z as De,A as Oe,B as He,C as $e,D as Fe,E as Ve,F as We,G as Be,H as Ne,I as Pe}from"./index-0d2c4177.js";import{l as be}from"./lodash-ec382a18.js";import{B as A}from"./index-947751b3.js";import{I as we}from"./index-ea9d0aad.js";import{T as je}from"./index-ead8f185.js";import"./index.es-26e19131.js";import{S as Ze}from"./index-3050f29b.js";import{u as Ke}from"./useColors-7df90356.js";import{B as S}from"./button-75352c4c.js";import"./use-dom-ref-586729b0.js";import"./keyframes-f8701b15.js";var s=(e=>(e[e.zoomIn=1]="zoomIn",e[e.zoomOut=2]="zoomOut",e[e.prev=3]="prev",e[e.next=4]="next",e[e.rotateLeft=5]="rotateLeft",e[e.rotateRight=6]="rotateRight",e[e.reset=7]="reset",e[e.close=8]="close",e[e.scaleX=9]="scaleX",e[e.scaleY=10]="scaleY",e))(s||{}),h=(e=>(e.setVisible="setVisible",e.setActiveIndex="setActiveIndex",e.update="update",e.clear="clear",e))(h||{});const Ge=84,p=55,Te=Z("div",{appearance:"none",border:"none",boxSizing:"border-box",margin:"0px",zIndex:"51",backgroundColor:"rgba(0, 0, 0, 0.6)",position:"fixed",top:0,left:0,overflow:"hidden",width:"100vw",height:"100vh"}),Ue=Z("div",{zIndex:"52",position:"fixed",marginBottom:20,top:20,left:0,display:"flex",flexDirection:"row",width:"100vw",alignItems:"center",justifyContent:"center"}),_e=Z("div",{zIndex:"52",position:"fixed",bottom:60,left:0,display:"flex",width:"100vw",alignItems:"center",justifyContent:"center"}),Ae=Z("div",{display:"flex",width:"100vw",alignItems:"center",justifyContent:"center"}),qe=Z("div",{zIndex:52,position:"fixed",height:50,bottom:0,left:0,display:"flex",alignItems:"center",justifyContent:"center",width:"100vw"}),Je=Z("div",{zIndex:53,height:50,marginBottom:10,img:{width:"60px",height:"50px",opacity:.5,marginRight:2,marginLeft:2,borderRadius:4},".active":{opacity:1,border:"2px solid $cdgBlue80"}});function Qe(e){return i(_e,{children:j(je.Label,{css:{textAlign:"center"},variant:"label1",children:[e.alt&&`${e.alt} `,`(${e.width} x ${e.height}) `,i("b",{children:`${e.activeIndex+1} ${e.totalName} ${e.count}`})]})})}function pe(e){const o=f.useRef(!1),m=f.useRef({x:0,y:0}),[r,d]=f.useState({x:0,y:0});f.useEffect(()=>()=>{L(!0),$(!0)},[]),f.useEffect(()=>($(),()=>{$(!0)})),f.useEffect(()=>(e.visible&&e.drag&&L(),!e.visible&&e.drag&&H(),()=>{L(!0)}),[e.drag,e.visible]),f.useEffect(()=>{const c=r.x-m.current.x,I=r.y-m.current.y;m.current={x:r.x,y:r.y},e.onChangeImgState(e.width,e.height,e.top+I,e.left+c)},[r]);function g(){e.onResize()}function K(c){e.onCanvasMouseDown(c),O(c)}function O(c){c.button===0&&(!e.visible||!e.drag||(c.preventDefault(),c.stopPropagation(),o.current=!0,m.current={x:c.nativeEvent.clientX,y:c.nativeEvent.clientY}))}const G=c=>{o.current&&d({x:c.clientX,y:c.clientY})};function H(){o.current=!1}function $(c){let I="addEventListener";c&&(I="removeEventListener"),window[I]("resize",g,!1)}function L(c){let I="addEventListener";c&&(I="removeEventListener"),document[I]("click",H,!1),document[I]("mousemove",G,!1)}const F={width:`${e.width}px`,height:`${e.height}px`,transform:`translateX(${e.left!==null?`${e.left}px`:"aoto"}) translateY(${e.top}px)
    rotate(${e.rotate}deg) scaleX(${e.scaleX}) scaleY(${e.scaleY})`};let M=null;return e.imgSrc!==""&&(M=i("img",{src:e.imgSrc,style:F,onMouseDown:O})),e.loading&&(M=i(A,{css:{display:"flex",height:`${window.innerHeight-84}px`,justifyContent:"center",alignItems:"center"},children:i(Ze,{size:"2xl"})})),i(A,{onMouseDown:K,css:{zIndex:e.zIndex},children:M})}function et(e){const{activeIndex:o=0}=e;function m(r){o!==r&&e.onChangeImg(r)}return i(qe,{children:e.images.map((r,d)=>i(Je,{onClick:()=>{m(d)},children:i("img",{className:d===o?"active":"",src:r.src,alt:r.alt})},d))})}const tt=[{key:"zoomIn",actionType:s.zoomIn,icon:De},{key:"reset",actionType:s.reset,icon:Oe},{key:"zoomOut",actionType:s.zoomOut,icon:He},{key:"prev",actionType:s.prev,icon:$e},{key:"next",actionType:s.next,icon:Fe},{key:"rotateLeft",actionType:s.rotateLeft,icon:Ve},{key:"rotateRight",actionType:s.rotateRight,icon:We},{key:"scaleX",actionType:s.scaleX,icon:Be},{key:"scaleY",actionType:s.scaleY,icon:Ne}];function ee(e,o){return e.filter(r=>o.indexOf(r.key)<0)}function at(e){function o(g){e.onAction(g)}const m=Ke();function r(g){return i(S,{variant:"ghost",onClick:()=>{o(g)},"data-key":g.key,children:g.icon?i(we,{icon:g.icon,color:m.cdgBlue40}):i(te,{children:g.key})},g.key)}let d=e.toolbars;return e.zoomable||(d=ee(d,["zoomIn","zoomOut","reset"])),e.changeable||(d=ee(d,["prev","next"])),e.rotatable||(d=ee(d,["rotateLeft","rotateRight"])),e.scalable||(d=ee(d,["scaleX","scaleY"])),i(Ue,{children:i(Ae,{children:d.map(g=>r(g))})})}function w(e,o){return{type:e,payload:o||{}}}const it=e=>{var ge;const{visible:o=!1,onClose:m=be.noop,images:r=[],activeIndex:d=0,drag:g=!0,zoomable:K=!0,rotatable:O=!0,scalable:G=!0,onMaskClick:H=be.noop,changeable:$=!0,customToolbar:L=t=>t,zoomSpeed:F=.05,disableKeyboardSupport:M=!1,noResetZoomAfterChange:c=!1,noLimitInitializationSize:I=!1,defaultScale:N=1,loop:Ie=!0,disableMouseZoom:xe=!1,isShowImageInformation:ye=!0,isShowToolbar:Se=!0,isShowPreview:Ce=!0,totalName:ke="of",minScale:q=.1}=e,ze={index:0,visible:!1,activeIndex:e.activeIndex??0,width:0,height:0,top:15,left:0,rotate:0,imageWidth:0,imageHeight:0,scaleX:N,scaleY:N,loading:!1,loadFailed:!1,startLoading:!1};function ae(){let t=window.innerWidth,l=window.innerHeight;return e.container&&(t=e.container.offsetWidth,l=e.container.offsetHeight),{width:t,height:l}}const x=f.useRef(ae()),J=Ge;function Re(t,l){switch(l.type){case h.setVisible:return{...t,visible:!!l.payload.visible};case h.setActiveIndex:return{...t,activeIndex:Number(l.payload.index),startLoading:!0};case h.update:return{...t,...l.payload};case h.clear:return{...t,width:0,height:0,scaleX:N,scaleY:N,rotate:1,imageWidth:0,imageHeight:0,loadFailed:!1,top:0,left:0,loading:!1}}return t}const T=f.useRef(null),U=f.useRef(!1),se=f.useRef(0),[a,b]=f.useReducer(Re,ze);f.useEffect(()=>(U.current=!0,()=>{U.current=!1}),[]),f.useEffect(()=>{x.current=ae()},[e.container]),f.useEffect(()=>{o&&U.current&&b(w(h.setVisible,{visible:!0}))},[o]),f.useEffect(()=>(M||document.addEventListener("keydown",ue,!0),T.current&&T.current.addEventListener("wheel",he,!1),()=>{document.removeEventListener("keydown",ue,!0),T.current&&T.current.removeEventListener("wheel",he,!1)})),f.useEffect(()=>{o&&b(w(h.setActiveIndex,{index:d}))},[d,o,r]);function ie(t,l=!1){b(w(h.update,{loading:!0,loadFailed:!1}));let n={src:"",alt:""};r.length>0&&(n=r[t]);let u=!1;const v=new Image;v.onload=()=>{U.current&&(u||y(v.width,v.height,!0))},v.onerror=()=>{if(U.current)if(e.defaultImg){b(w(h.update,{loading:!1,loadFailed:!0,startLoading:!1}));const P=e.defaultImg.width||x.current.width*.5,D=e.defaultImg.height||x.current.height*.5;y(P,D,!1)}else b(w(h.update,{loading:!1,loadFailed:!1,startLoading:!1}))},v.src=n.src,v.complete&&(u=!0,y(v.width,v.height,!0));function y(P,D,_){if(t!==se.current)return;let W=P,B=D;e.defaultSize&&(W=e.defaultSize.width,B=e.defaultSize.height),n.defaultSize&&(W=n.defaultSize.width,B=n.defaultSize.height);const[C,k]=ce(W,B),z=(x.current.width-C)/2,R=(x.current.height-k-J)/2;let me=N,ve=N;c&&!l&&(me=a.scaleX,ve=a.scaleY),b(w(h.update,{width:C,height:k,left:z,top:R,imageWidth:P,imageHeight:D,loading:!1,rotate:0,scaleX:me,scaleY:ve,loadFailed:!_,startLoading:!1}))}}f.useEffect(()=>{a.startLoading&&(se.current=a.activeIndex,ie(a.activeIndex))},[a.startLoading,a.activeIndex]);function ce(t,l){let n=0,u=0;const v=x.current.width*.8,y=(x.current.height-J)*.8;return n=Math.min(v,t),u=n/t*l,u>y&&(u=y,n=u/l*t),I&&(n=t,u=l),[n,u]}function ne(t){if(!(!Ie&&(t>=r.length||t<0))&&(t>=r.length&&(t=0),t<0&&(t=r.length-1),t!==a.activeIndex)){if(e.onChange){const l=le(t);e.onChange(l,t)}b(w(h.setActiveIndex,{index:t}))}}function le(t){let l={src:"",alt:""},n=null;return t!==void 0?n=t:n=a.activeIndex,r.length>0&&n>=0&&(l=r[n]),l}function Xe(t){b(w(h.update,{scaleX:a.scaleX*t}))}function Ye(t){b(w(h.update,{scaleY:a.scaleY*t}))}function de(t=!1){b(w(h.update,{rotate:a.rotate+90*(t?1:-1)}))}function V(t){switch(t){case s.prev:ne(a.activeIndex-1);break;case s.next:ne(a.activeIndex+1);break;case s.zoomIn:const l=oe();re(l.x,l.y,1,F);break;case s.zoomOut:const n=oe();re(n.x,n.y,-1,F);break;case s.rotateLeft:de();break;case s.rotateRight:de(!0);break;case s.reset:ie(a.activeIndex,!0);break;case s.scaleX:Xe(-1);break;case s.scaleY:Ye(-1);break}}function fe(t){if(V(t.actionType),t.onClick){const l=le();t.onClick(l)}}function Ee(t,l,n,u){b(w(h.update,{width:t,height:l,top:n,left:u}))}function Le(){if(x.current=ae(),o){const t=(x.current.width-a.width)/2,l=(x.current.height-a.height-J)/2;b(w(h.update,{left:t,top:l}))}}function Me(t){H(t)}function ue(t){const l=t.keyCode||t.which||t.charCode;let n=!1;switch(l){case 27:m(),n=!0;break;case 37:t.ctrlKey?V(s.rotateLeft):V(s.prev),n=!0;break;case 39:t.ctrlKey?V(s.rotateRight):V(s.next),n=!0;break;case 38:V(s.zoomIn),n=!0;break;case 40:V(s.zoomOut),n=!0;break;case 49:t.ctrlKey&&(ie(a.activeIndex),n=!0);break}n&&(t.preventDefault(),t.stopPropagation())}function he(t){if(xe||a.loading)return;t.preventDefault();let l=0;const n=t.deltaY;if(n===0?l=0:l=n>0?-1:1,l!==0){let u=t.clientX,v=t.clientY;if(e.container){const y=e.container.getBoundingClientRect();u-=y.left,v-=y.top}re(u,v,l,F)}}function oe(){return{x:a.left+a.width/2,y:a.top+a.height/2}}function re(t,l,n,u){const v=oe(),y=t-v.x,P=l-v.y;let D=0,_=0,W=0,B=0,C=0,k=0;if(a.width===0){const[z,R]=ce(a.imageWidth,a.imageHeight);_=(x.current.width-z)/2,D=(x.current.height-J-R)/2,W=a.width+z,B=a.height+R,C=k=1}else{const z=a.scaleX>0?1:-1,R=a.scaleY>0?1:-1;C=a.scaleX+u*n*z,k=a.scaleY+u*n*R,typeof e.maxScale<"u"&&(Math.abs(C)>e.maxScale&&(C=e.maxScale*z),Math.abs(k)>e.maxScale&&(k=e.maxScale*R)),Math.abs(C)<q&&(C=q*z),Math.abs(k)<q&&(k=q*R),D=a.top+-n*P/a.scaleX*u*z,_=a.left+-n*y/a.scaleY*u*R,W=a.width,B=a.height}b(w(h.update,{width:W,scaleX:C,scaleY:k,height:B,top:D,left:_,loading:!1}))}let Q={src:"",alt:""};return o&&a.visible&&!a.loading&&a.activeIndex!==null&&!a.startLoading&&(Q=le()),i(te,{children:o&&j(Te,{children:[e.noClose||i(S,{variant:"primary",css:{right:15,top:10,width:32,display:"flex",padding:"5px 0",borderRadius:16,position:"absolute",zIndex:p+5},onClick:m,children:i(we,{icon:Pe,color:"white"})}),j(A,{onTransitionEnd:()=>{o||b(w(h.setVisible,{visible:!1}))},ref:T,children:[i(A,{css:{zIndex:p}}),i(pe,{imgSrc:a.loadFailed&&((ge=e==null?void 0:e.defaultImg)==null?void 0:ge.src)||Q.src,visible:o,width:a.width,height:a.height,top:a.top,left:a.left,rotate:a.rotate,onChangeImgState:Ee,onResize:Le,zIndex:p+5,scaleX:a.scaleX,scaleY:a.scaleY,loading:a.loading,drag:g,container:e.container,onCanvasMouseDown:Me}),j(A,{css:{zIndex:p+5},children:[Se&&i(at,{onAction:fe,zoomable:K,rotatable:O,scalable:G,changeable:$,toolbars:L(tt)}),ye&&i(Qe,{onAction:fe,alt:Q.alt??"",width:a.imageWidth,height:a.imageHeight,activeIndex:a.activeIndex,count:r.length,totalName:ke}),Ce&&i(et,{images:e.images,activeIndex:a.activeIndex,onChangeImg:ne})]})]})]})})},Y=e=>{const[o,m]=f.useState(!1);return f.useEffect(()=>{e.visible&&!o&&m(!0)},[e.visible,o]),o?i(it,{...e}):null},E=Array.from(Array(8).keys()).map(e=>({src:`https://picsum.photos/id/${e+1}/5000/3333`,alt:`Image ${e+1}`})),bt=()=>{const[e,o]=X.useState(!1);return j(te,{children:[i("h3",{children:"Default "}),i(S,{onClick:()=>o(!0),children:"Open image viewer"}),i(Y,{visible:e,onClose:()=>{o(!1)},images:E,onMaskClick:()=>{o(!1)}})]})},wt=()=>{const[e,o]=X.useState(!1),[m,r]=X.useState(!1),[d,g]=X.useState(!1),[K,O]=X.useState(!1),[G,H]=X.useState(!1),[$,L]=X.useState(!1),[F,M]=X.useState(!1),[c,I]=X.useState(!1);return j(te,{children:[i("h3",{children:"Active index"}),i(S,{onClick:()=>o(!0),children:"Open image viewer"}),i(Y,{visible:e,activeIndex:1,onClose:()=>{o(!1)},images:E}),i("h3",{children:"Disable drag"}),i(S,{onClick:()=>r(!0),children:"Open image viewer"}),i(Y,{visible:m,drag:!1,onClose:()=>{r(!1)},images:E}),i("h3",{children:"Disable zoomable"}),i(S,{onClick:()=>g(!0),children:"Open image viewer"}),i(Y,{visible:d,zoomable:!1,onClose:()=>{g(!1)},images:E}),i("h3",{children:"Disable rotatable"}),i(S,{onClick:()=>O(!0),children:"Open image viewer"}),i(Y,{visible:K,zoomable:!1,disableMouseZoom:!0,onClose:()=>{O(!1)},images:E}),i("h3",{children:"Disable scalable"}),i(S,{onClick:()=>H(!0),children:"Open image viewer"}),i(Y,{visible:G,scalable:!1,onClose:()=>{H(!1)},images:E}),i("h3",{children:"Hidden image information"}),i(S,{onClick:()=>L(!0),children:"Open image viewer"}),i(Y,{visible:$,isShowImageInformation:!1,onClose:()=>{L(!1)},images:E}),i("h3",{children:"Hidden preview"}),i(S,{onClick:()=>M(!0),children:"Open image viewer"}),i(Y,{visible:F,isShowPreview:!1,onClose:()=>{M(!1)},images:E}),i("h3",{children:"Hidden toolbar"}),i(S,{onClick:()=>I(!0),children:"Open image viewer"}),i(Y,{visible:c,isShowToolbar:!1,onClose:()=>{I(!1)},images:E})]})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{bt as Default,wt as Variants};
