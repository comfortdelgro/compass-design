import{s as J,g as oe,R as F,r as i,j as b,a as U}from"./index-b2761b56.js";import{C as ae}from"./components-37256a88.js";import{u as le}from"./use-dom-ref-b82bff2a.js";import{a as Q,$ as se}from"./import-103c32e0.js";const ce=J("div",{width:"100%",display:"flex",flexDirection:"column",label:{fontSize:"$label1",fontWeight:"$medium",lineHeight:"$normal",display:"block",marginBottom:"$1",color:"$gray90",span:{marginLeft:"$1",color:"$danger"}},div:{display:"flex",width:"100%",input:{flex:1,color:"$gray100",padding:"$3 $4",textAlign:"center",borderRadius:"0",backgroundColor:"$white",fontSize:"$label1",fontWeight:"$semibold",borderWidth:"1px",borderStyle:"solid",borderColor:"$divider",transition:"$default"},"input::placeholder":{color:"$tertiaryText"},button:{color:"$gray100",aspectRatio:"1",width:"$14",cursor:"pointer",fontWeight:"$bold",borderWidth:"1px",borderStyle:"solid",borderColor:"$divider",transition:"$default",backgroundColor:"$gray10"},"button[aria-label='decrease']":{borderRight:"none",borderRadius:"4px 0 0 4px"},"button[aria-label='increase']":{borderLeft:"none",borderRadius:"0 4px 4px 0"}},":focus-within":{input:{outline:"none",borderColor:"$cdgBlue120"},button:{borderColor:"$cdgBlue120",backgroundColor:"#E6ECF7"}},variants:{isDisabled:{true:{cursor:"not-allowed",div:{input:{backgroundColor:"$gray30",cursor:"not-allowed"},button:{borderColor:"$gray30",cursor:"not-allowed"}}}},isErrored:{true:{div:{input:{outline:"none",borderColor:"$danger"},button:{borderColor:"$danger"}},":focus-within":{input:{outline:"none",borderColor:"$danger"},button:{borderColor:"$danger",backgroundColor:"$gray10"}}}}}}),X=J("div",{fontSize:"$label2",fontWeight:"$medium",transition:"$default",marginTop:"$1",color:"$gray70",variants:{error:{true:{color:"$danger"}}}});function ie(...e){return(...t)=>{for(const n of e)typeof n=="function"&&n(...t)}}function k(...e){const t={...e[0]};for(let n=1;n<e.length;n++){const r=e[n];for(const o in r){const l=t[o],s=r[o];typeof l=="function"&&typeof s=="function"&&o.startsWith("o")&&o[1]==="n"&&o.charCodeAt(2)>=65&&o.charCodeAt(2)<=90?t[o]=ie(l,s):(o==="className"||o==="UNSAFE_className")&&typeof l=="string"&&typeof s=="string"?t[o]=oe(l,s):t[o]=s!==void 0?s:l}}return t}const Z=typeof window<"u"?F.useLayoutEffect:()=>{};class ue{constructor(t,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=t}isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}}function de(e){const t=i.useRef({isFocused:!1,onBlur:e,observer:null});return t.current.onBlur=e,Z(()=>{const n=t.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]),i.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){t.current.isFocused=!0;const r=n.target,o=l=>{t.current.isFocused=!1,r.disabled&&t.current.onBlur(new ue("blur",l)),t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};r.addEventListener("focusout",o,{once:!0}),t.current.observer=new MutationObserver(()=>{var l;t.current.isFocused&&r.disabled&&((l=t.current.observer)==null||l.disconnect(),r.dispatchEvent(new FocusEvent("blur")),r.dispatchEvent(new FocusEvent("focusout",{bubbles:!0})))}),t.current.observer.observe(r,{attributes:!0,attributeFilter:["disabled"]})}},[])}function ee(e){const{isDisabled:t,onFocus:n,onBlur:r,onFocusChange:o}=e,l=i.useCallback(c=>(c.target===c.currentTarget&&(r&&r(c),o&&o(!1)),!0),[r,o]),s=de(l),a=i.useCallback(c=>{c.target===c.currentTarget&&document.activeElement===c.target&&(n&&n(c),o&&o(!0),s(c))},[o,n,s]);return{focusProps:{onFocus:!t&&(n||o||r)?a:void 0,onBlur:!t&&(r||o)?l:void 0}}}function fe(e){if(be())e.focus({preventScroll:!0});else{const t=me(e);e.focus(),pe(t)}}let O=!1;function be(){if(!O){O=!1;try{document.createElement("div").focus({get preventScroll(){return O=!0,!0}})}catch{}}return O}function me(e){let t=e.parentNode;const n=[],r=document.scrollingElement??document.documentElement;for(;t instanceof HTMLElement&&t!==r;)(t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth)&&n.push({element:t,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),t=t.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function pe(e){for(const{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}function _(e){if(e){let t=!0;return n=>{const r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){t=!1}};e(r),t&&n.stopPropagation()}}else return()=>{}}function he(e){return{keyboardProps:e.isDisabled?{}:{onKeyDown:_(e.onKeyDown),onKeyUp:_(e.onKeyUp)}}}function ge(e,t){Z(()=>{var n;return(n=e.ref)!=null&&n.current&&(e.ref.current=t.current),()=>{var r;(r=e.ref)!=null&&r.current&&(e.ref.current=null)}},[e,t])}const te=F.createContext(null);function ye(e){const t=i.useContext(te)||{};ge(t,e);let{ref:n,...r}=t;return r}function ve(e,t){const{children:n,...r}=e,o={...r,ref:t};return b(te.Provider,{value:o,children:n})}F.forwardRef(ve);function Se(e,t){const{focusProps:n}=ee(e),{keyboardProps:r}=he(e),o=k(n,r),l=ye(t),s=e.isDisabled?{}:l,a=i.useRef(e.autoFocus);return i.useEffect(()=>{a.current&&t.current&&fe(t.current),a.current=!1},[t]),{focusableProps:k({...o,tabIndex:e.excludeFromTabOrder&&!e.isDisabled?-1:void 0},s)}}function Pe(e,t){const{isDisabled:n=!1,isRequired:r=!1,isReadOnly:o=!1,validationState:l,type:s="text",onChange:a=()=>{}}=e,{focusableProps:c}=Se(e,t);return{inputProps:k(e,{type:s,pattern:e.pattern,disabled:n,readOnly:o,"aria-required":r||void 0,"aria-invalid":l==="invalid"||void 0,"aria-errormessage":e["aria-errormessage"],"aria-activedescendant":e["aria-activedescendant"],"aria-autocomplete":e["aria-autocomplete"],"aria-haspopup":e["aria-haspopup"],value:e.value,defaultValue:e.value?void 0:e.defaultValue,onChange:u=>a(u.target.value),autoComplete:e.autoComplete,maxLength:e.maxLength,minLength:e.minLength,name:e.name,placeholder:e.placeholder,inputMode:e.inputMode,onCopy:e.onCopy,onCut:e.onCut,onPaste:e.onPaste,onCompositionEnd:e.onCompositionEnd,onCompositionStart:e.onCompositionStart,onCompositionUpdate:e.onCompositionUpdate,onSelect:e.onSelect,onBeforeInput:e.onBeforeInput,onInput:e.onInput,...c})}}function G(){return typeof window<"u"&&window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"}function Ce(e,t,n){const r=i.useRef(t);r.current=t,i.useEffect(()=>{if(!G())return;const a=n.current,c=u=>{const y=r.current;let d;switch(u.inputType){case"historyUndo":case"historyRedo":return;case"deleteContent":case"deleteByCut":case"deleteByDrag":d=a.value.slice(0,a.selectionStart)+a.value.slice(a.selectionEnd);break;case"deleteContentForward":d=a.selectionEnd===a.selectionStart?a.value.slice(0,a.selectionStart)+a.value.slice(a.selectionEnd+1):a.value.slice(0,a.selectionStart)+a.value.slice(a.selectionEnd);break;case"deleteContentBackward":d=a.selectionEnd===a.selectionStart?a.value.slice(0,a.selectionStart-1)+a.value.slice(a.selectionStart):a.value.slice(0,a.selectionStart)+a.value.slice(a.selectionEnd);break;case"deleteSoftLineBackward":case"deleteHardLineBackward":d=a.value.slice(a.selectionStart);break;default:u.data!=null&&(d=a.value.slice(0,a.selectionStart)+u.data+a.value.slice(a.selectionEnd));break}(d==null||!y.validate(d))&&u.preventDefault()};return a.addEventListener("beforeinput",c,!1),()=>{a.removeEventListener("beforeinput",c,!1)}},[n,r]);const o=G()?null:a=>{const c=a.target.value.slice(0,a.target.selectionStart)+a.data+a.target.value.slice(a.target.selectionEnd);t.validate(c)||a.preventDefault()},{inputProps:l}=Pe(e,n),s=i.useRef(null);return{...k(l,{onBeforeInput:o,onCompositionStart(){const{value:a,selectionStart:c,selectionEnd:u}=n.current;s.current={value:a,selectionStart:c,selectionEnd:u}},onCompositionEnd(){if(!t.validate(n.current.value)){const{value:a,selectionStart:c,selectionEnd:u}=s.current;n.current.value=a,n.current.setSelectionRange(c,u),t.setInputValue(a)}}})}}function Ee(e){const t=i.useRef(),{isReadOnly:n,onIncrement:r,onDecrement:o,onIncrementPage:l,onDecrementPage:s,onDecrementToMin:a,onIncrementToMax:c}=e,u=i.useRef(e);u.current=e;const y=()=>clearTimeout(t.current);i.useEffect(()=>()=>y(),[]);const d=m=>{if(!(m.ctrlKey||m.metaKey||m.shiftKey||m.altKey||n))switch(m.key){case"PageUp":l&&(m.preventDefault(),l());break;case"ArrowUp":case"Up":r&&(m.preventDefault(),r());break;case"PageDown":s&&(m.preventDefault(),s());break;case"ArrowDown":case"Down":o&&(m.preventDefault(),o());break;case"Home":a&&(m.preventDefault(),a());break;case"End":c&&(m.preventDefault(),c());break}},p=i.useRef(!1);return{onKeyDown:d,onFocus:()=>{p.current=!0},onBlur:()=>{p.current=!1}}}function De(e={}){return i.useMemo(()=>new Q("en-US",e),[e])}function we(e,t,n,r){i.useEffect(()=>{const o=e.current;return o&&n!==null&&o.addEventListener(t,n,r),()=>{o&&n!==null&&o.removeEventListener(t,n,r)}},[e,t,r])}function Ve(e,t){const{onScroll:n,isDisabled:r}=e,o=i.useCallback(l=>{const s=l;s.ctrlKey||(s.preventDefault(),s.stopPropagation(),n&&n({deltaX:s.deltaX,deltaY:s.deltaY}))},[n]);we(t,"wheel",r?null:o,{passive:!1})}function xe(e,t,n){const{label:r,description:o,errorMessage:l,formatOptions:s,autoFocus:a=!1,isRequired:c=!1,isReadOnly:u=!1,isDisabled:y=!1,maxValue:d=1/0,minValue:p=-1/0,disableScroll:g=!0,validationState:v="valid",onBlur:m=()=>{},onKeyUp:N=()=>{},onFocus:T=()=>{},onKeyDown:H=()=>{},onFocusChange:w=()=>{},...S}=e,{inputValue:R,numberValue:x,commit:B,increment:h,decrement:D,incrementToMax:K,decrementToMin:L}=t,{focusProps:W}=ee({onBlur:()=>B()}),I=De({...s,currencySign:void 0}),A=i.useMemo(()=>isNaN(x)?"":I.format(x),[I,x]),q=Ee({maxValue:d,minValue:p,textValue:A,isRequired:c,isReadOnly:u,isDisabled:y,value:x,onIncrement:h,onDecrement:D,onIncrementToMax:K,onDecrementToMin:L}),Y=i.useCallback(C=>{Math.abs(C.deltaY)<=Math.abs(C.deltaX)||(C.deltaY>0?h():C.deltaY<0&&D())},[D,h]);Ve({onScroll:Y,isDisabled:y||u||g},n);const f=Ce({...S,label:r,autoFocus:a,isReadOnly:u,isRequired:c,isDisabled:y,description:o,errorMessage:l,type:"text",validationState:v,defaultValue:"",value:R,autoComplete:"off",inputMode:"numeric",onBlur:m,onFocus:T,onKeyUp:N,onChange:C=>{t.setInputValue(C)},onKeyDown:H,onFocusChange:w},t,n),P=k(q,W,f,{autoCorrect:"off"}),V=()=>{var C;document.activeElement!==n.current&&((C=n.current)==null||C.focus())},$={"aria-label":"increase",slot:"increment",type:"button",tabIndex:-1,disabled:!t.canIncrement,onClick:()=>{V(),h()},onMouseDown:C=>C.preventDefault()},re={"aria-label":"decrease",slot:"decrement",type:"button",tabIndex:-1,disabled:!t.canDecrement,onClick:()=>{V(),D()},onMouseDown:C=>C.preventDefault()};return delete P.isErrored,delete P.isReadOnly,delete P.isRequired,delete P.isDisabled,delete P.helperText,delete P.defaultValue,delete P.errorMessage,delete P.validationState,delete P.onUpdate,delete P.onFocusChange,{inputProps:P,incrementButtonProps:$,decrementButtonProps:re}}function Me(e,t=-1/0,n=1/0){return Math.min(Math.max(e,t),n)}function M(e,t,n,r){const o=(e-(t||0))%r;let l=Math.abs(o)*2>=r?e+Math.sign(o)*(r-Math.abs(o)):e-o;t?l<t?l=t:n&&l>n&&(l=t+Math.floor((n-t)/r)*r):n&&l>n&&(l=Math.floor(n/r)*r);const s=r.toString(),a=s.indexOf("."),c=a>=0?s.length-a:0;if(c>0){const u=Math.pow(10,c);l=Math.round(l*u)/u}return l}function Te(e,t,n){const[r,o]=i.useState(e??t),l=i.useRef(e!==void 0),s=e!==void 0,a=i.useRef(r);l.current=s;const c=i.useCallback((u,...y)=>{const d=(p,...g)=>{n&&(Object.is(a.current,p)||n(p,...g)),s||(a.current=p)};typeof u=="function"?o((g,...v)=>{const m=u(s?a.current:g,...v);return d(m,...y),s?g:m}):(s||o(u),d(u,...y))},[s,n]);return s?a.current=e:e=r,[e,c]}function $e(e){const{step:t,value:n,minValue:r,maxValue:o,isReadOnly:l,isDisabled:s,defaultValue:a,formatOptions:c,locale:u="en-US",onChange:y}=e,[d,p]=Te(n,a&&isNaN(a)?NaN:a,y),[g,v]=i.useState(()=>isNaN(d)?"":new Q(u,c).format(d)),m=i.useMemo(()=>new se(u,c),[u,c]),N=i.useMemo(()=>m.getNumberingSystem(g),[m,g]),T=i.useMemo(()=>new Q(u,{...c,numberingSystem:N}),[u,c,N]),H=i.useMemo(()=>T.resolvedOptions(),[T]),w=i.useCallback(f=>isNaN(f)||f===null?"":T.format(f),[T]);let S=t||1;H.style==="percent"&&!t&&(S=.01);const R=i.useRef(d),x=i.useRef(u),B=i.useRef(c);(!Object.is(d,R.current)||u!==x.current||c!==B.current)&&(v(w(d)),R.current=d,x.current=u,B.current=c);const h=i.useMemo(()=>m.parse(g),[m,g]),D=i.useRef(0);D.current=h;const K=()=>{if(!g.length){p(NaN),v(n===void 0?"":w(d));return}if(isNaN(D.current)){v(w(d));return}let f;t?f=M(D.current,r,o,t):f=Me(D.current,r,o),f=m.parse(w(f)),p(f),v(w(n===void 0?f:d))},L=(f,P)=>{const V=D.current;if(isNaN(V))return M(P||0,r,o,S);{const $=M(V,r,o,S);return f==="+"&&$>V||f==="-"&&$<V?$:M(j(f,V,S),r,o,S)}},W=()=>{const f=L("+",r);f===d&&v(w(f)),p(f)},I=()=>{const f=L("-",o);f===d&&v(w(f)),p(f)},A=()=>{o!=null&&p(M(o,r,o,S))},q=()=>{r!=null&&p(r)},Y=i.useMemo(()=>!s&&!l&&(isNaN(h)||!o||M(h,r,o,S)>h||j("+",h,S)<=o),[s,l,r,o,S,h]),z=i.useMemo(()=>!s&&!l&&(isNaN(h)||!r||M(h,r,o,S)<h||j("-",h,S)>=r),[s,l,r,o,S,h]);return{inputValue:g,canIncrement:Y,canDecrement:z,minValue:r??-1/0,maxValue:o??1/0,numberValue:h,commit:K,validate:f=>m.isValidPartialNumber(f,r,o),increment:W,decrement:I,setInputValue:v,incrementToMax:A,decrementToMin:q}}function j(e,t,n){let r=e==="+"?t+n:t-n;if(t%1!==0||n%1!==0){const o=t.toString().split("."),l=n.toString().split("."),s=o[1]&&o[1].length||0,a=l[1]&&l[1].length||0,c=Math.pow(10,Math.max(s,a));t=Math.round(t*c),n=Math.round(n*c),r=e==="+"?t+n:t-n,r/=c}return r}const Fe=F.forwardRef((e,t)=>{const{css:n={},isErrored:r=!1,id:o=`cdg-element-${Math.random().toString(36).substring(2)}`,onUpdate:l,className:s,label:a,isRequired:c,...u}=e,y=le(t),d=$e(u),{inputProps:p,incrementButtonProps:g,decrementButtonProps:v}=xe(e,d,y);return F.useEffect(()=>{l==null||l(d.inputValue,d.numberValue)},[d.numberValue,d.inputValue]),U(ce,{css:n,isErrored:!!r,isDisabled:!!p.disabled,className:s,children:[e.label&&U("label",{htmlFor:o,children:[a,c&&b("span",{children:"*"})]}),U("div",{children:[b("button",{...v,children:"-"}),b("input",{...p,id:o,ref:y}),b("button",{...g,children:"+"})]}),r&&e.errorMessage&&b(X,{error:!0,children:e.errorMessage}),e.helperText&&b(X,{children:e.helperText})]})}),E=Fe;E.displayName="QuantityToggle";const Le=()=>{const[e,t]=i.useState(0);return U(ae,{children:[b("h3",{children:"Controlled"}),b(E,{placeholder:"Price",label:"Potato Price",value:e,onChange:n=>t(n),formatOptions:{style:"currency",currency:"USD"},onUpdate:(n,r)=>{console.log("onUpdate value",n),console.log("onUpdate number",r)}}),b("h3",{children:"Un-Controlled"}),b(E,{label:"Potato Price",placeholder:"Price",formatOptions:{style:"currency",currency:"USD"}}),b("h3",{children:"Step values"}),b(E,{label:"Step",step:10}),b(E,{label:"Step + minValue",minValue:2,step:3}),b(E,{label:"Step + minValue + maxValue",minValue:2,maxValue:21,step:3}),b("h3",{children:"Units"}),b(E,{label:"Package width",defaultValue:4,formatOptions:{style:"unit",unit:"inch",unitDisplay:"long"}}),b(E,{label:"Transaction amount",defaultValue:45,formatOptions:{style:"currency",currency:"EUR",currencyDisplay:"code",currencySign:"accounting"}}),b("h3",{children:"Enable Scroll"}),b(E,{label:"Potato Price",placeholder:"Price",disableScroll:!1}),b("h3",{children:"Disabled"}),b(E,{label:"Disabled",isDisabled:!0,defaultValue:25}),b("h3",{children:"Read only"}),b(E,{label:"Read only",isReadOnly:!0,defaultValue:32}),b("h3",{children:"Errored"}),b(E,{label:"Errored",defaultValue:2,isErrored:!0,helperText:"Bla Bla Bla"})]})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Le as Variants};
