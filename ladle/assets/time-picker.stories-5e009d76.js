import{s as _,R as ne,r as u,j as s,a as oe,F as ue}from"./index-12a99532.js";import{C as pe,R as B}from"./components-79765e20.js";import{l as C}from"./lodash-3df4c0ad.js";import{P as me}from"./index-47404c39.js";import{T as fe}from"./index-85e0de2f.js";import{u as he}from"./use-dom-ref-2bd5dd1a.js";import"./index-ab5e21ba.js";import{B as ge}from"./button-6255561c.js";import"./floating-ui.react.esm-82ea3778.js";import"./useCurrentTheme-29b321da.js";import"./ripple-01c7c154.js";const N={start:0,end:0,format:"",max:0,min:0},Y={hour:null,minute:null,second:null,session:null},re=["hours24","minutes","sessions"],be=4,ie="AM",ke="PM",we=[ie,ke];_("input",{width:"100%",fontSize:"$label1",fontWeight:"$semibold",lineHeight:"$normal",padding:"$1_5 $3",border:0,borderRadius:"$md",backgroundColor:"transparent","&:focus":{outline:"none",backgroundColor:"$cdgblue120"},"&::placeholder":{color:"$tertiaryText",fontSize:"$label1",fontWeight:"$semibold"}});const Ie=_("div",{".time-picker-input .right-icon":{width:"$6",height:"$6"},".time-picker-input-icon":{display:"flex",cursor:"pointer",borderRadius:"$full",backgroundColor:"transparent",border:"none",padding:"$1"},".time-picker-input-icon:active":{backgroundColor:"$gray20"},".time-picker-input-icon svg":{width:"$4",height:"$4"},".time-picker-input-icon path":{fill:"$secondaryText"}}),De=_("div",{background:"$background",border:"1px solid $divider",borderRadius:"$md",zIndex:9999}),Ce=_("div",{display:"flex",height:"$80",width:"100%",overflowY:"hidden",marginTop:"$1"}),Te=_("div",{padding:"$1",overflowY:"hidden",overflowX:"hidden",height:"100%",width:"$12_5",position:"relative","&:hover":{overflowY:"auto"},"&:not(:last-child)":{borderRight:"1px solid $divider"}}),ye=_("button",{backgroundColor:"$white",border:"none",display:"flex",justifyContent:"center",alignItems:"center",padding:"$3",borderRadius:"$md",width:"$10_5",height:"$10_5",cursor:"pointer",fontWeight:500,boxSizing:"border-box","&:hover":{backgroundColor:"$primaryBg"},fontSize:"$body3",lineHeight:"$5_25","&.active":{backgroundColor:"$cdgBlue100",color:"$background"}}),xe=_("div",{padding:"$2",display:"flex",justifyContent:"flex-end",borderTop:"1px solid $divider",button:{fontWeight:500,fontSize:"$body3",lineHeight:"$5_25"}});_("div",{display:"flex"});_("div",{whiteSpace:"break-spaces"});function Se(t){const{selectedTime:i,time:d,onClickItem:c,displayDataType:f,isOpen:A,itemId:P,focusingItemId:T}=t,a=u.useRef(null);u.useEffect(()=>{var y;P===T&&((y=a.current)==null||y.focus())},[T,P]),u.useEffect(()=>{A&&i===d&&setTimeout(()=>{v("auto")},0)},[A]),u.useEffect(()=>{i===d&&a.current&&v("smooth")},[i,d]);const v=y=>{var x;a.current&&((x=a.current.parentElement)==null||x.scroll({top:a.current.offsetTop-be,behavior:y}))};return s(ye,{ref:a,className:`cdg-timepicker-dropdown-item ${i===d?"active":""}`,onClick:c(d,f),tabIndex:-1,children:d})}const $e=ne.memo(Se);function ce(t){const i={hour:C.cloneDeep(N),minute:C.cloneDeep(N),second:C.cloneDeep(N),session:C.cloneDeep(N)};return t.includes("HH")?i.hour={start:t.indexOf("HH"),end:t.indexOf("HH")+2,format:"HH",min:0,max:23}:t.includes("hh")&&(i.hour={start:t.indexOf("hh"),end:t.indexOf("hh")+2,format:"hh",min:1,max:12}),t.includes("mm")&&(i.minute={start:t.indexOf("mm"),end:t.indexOf("mm")+2,format:"mm",min:0,max:59}),t.includes("ss")&&(i.second={start:t.indexOf("ss"),end:t.indexOf("ss")+2,format:"ss",min:0,max:59}),t.includes("AA"),t.includes("AA")&&(i.session={...C.cloneDeep(N),start:t.indexOf("AA"),end:t.indexOf("AA")+2,format:"AA"}),i}function X(t,i){const d=ce(t),c=C.cloneDeep(N);for(const f in d){const{start:A,end:P,format:T,max:a,min:v}=d[f];if(i>=A&&i<=P){c.start=A,c.end=P,c.format=T,c.min=v,c.max=a;break}}return c}function Ae(t,i,d,c){return t.substring(0,d)+i+t.substring(c)}const te=(t,i,d=1)=>{const c=[];for(;t<=i;)c.push(t),t=t+d;return c},q=(t,i,d)=>{const c=t[d],f=c==null?void 0:c.type,A=f?c==null?void 0:c.items.findIndex(P=>{var T;return P.toString().padStart(2,"0")===((T=i[f])==null?void 0:T.toString())}):"0";return`${d}-${A}`},Pe=50;function Re(t){const{isOpen:i=!0,hourStep:d=1,minuteStep:c=1,value:f=Y,hasFooter:A=!0,isUncontrolledComponent:P=!0,views:T=re,isReadOnly:a,onItemClick:v,onOkClick:y,onEscapeKeyDown:x}=t,R=u.useRef(null),V=u.useRef(null),[b,n]=u.useState([]),[O,M]=u.useState(""),[k,F]=u.useState(Y);u.useEffect(()=>{const o=[];T.forEach(h=>{switch(h){case"hours24":o.push({default:"00",items:te(0,23,d),type:"hour"});break;case"hours12":o.push({default:"01",items:te(1,12,d),type:"hour"});break;case"minutes":o.push({default:"00",items:te(0,59,c),type:"minute"});break;case"seconds":o.push({default:"00",items:te(0,59,1),type:"second"});break;case"sessions":o.push({default:ie,items:we,type:"session"});break}}),n(o)},[T,d,c]),u.useEffect(()=>{F(f||Y)},[f]),u.useEffect(()=>{i?(M(o=>{const[h]=o.split("-");return q(b,k,h?Number(h):0)}),R.current&&(R.current.style.minWidth=`${b.length*Pe}px`)):M("")},[i,k,b]);const r=u.useCallback((o,h)=>()=>{if(a)return;const g=C.cloneDeep(k);g[h]=o,Object.keys(k).map(S=>{if(S!==h&&!k[S]){const z=b.find(Q=>Q.type===S);z&&(g[S]=z.default)}}),P&&(console.log("setSelectedDisplayList"),F(g)),v(g)},[a,k,P,b,v]),J=()=>{y&&y()},U=(o,h)=>{const[g]=O.split("-");O?b[Number(g)]&&M(`${g}-${h}`):M(q(b,k,o))},j=(o=!1)=>{var D;const[h]=O.split("-"),g=o?b.length-1:0;if(document.activeElement===V.current){M(q(b,k,g));return}if(O){const S=o?Number(h)-1:Number(h)+1;b[S]?M(q(b,k,S)):A?((D=V.current)==null||D.focus(),M("")):M(q(b,k,g))}};return oe(De,{onKeyDown:o=>{if(!i)return;const[h,g]=O.split("-"),D=b[Number(h)],S=(D==null?void 0:D.items.length)||0;switch(o.code){case"ArrowUp":if(o.stopPropagation(),o.preventDefault(),D){const z=Number(g)-1>=0?(Number(g)-1)%S:S-1;U(0,z)}break;case"ArrowDown":o.stopPropagation(),o.preventDefault(),D&&U(0,(Number(g)+1)%S);break;case"Tab":o.stopPropagation(),o.preventDefault(),j(o.shiftKey);break;case"Escape":x==null||x();break}},ref:R,children:[s(Ce,{children:b.map((o,h)=>s(Te,{className:"time-picker-dropdown-control",children:o.items.map((g,D)=>s($e,{itemId:`${h}-${D}`,focusingItemId:O,isOpen:i,selectedDisplayList:k,time:g.toString().padStart(2,"0"),selectedTime:k[o.type],displayDataType:o.type,onClickItem:r},g))},h))}),A&&s(xe,{children:s(ge,{variant:"ghost",onClick:J,tabIndex:-1,ref:V,children:"OK"})})]})}const Oe=ne.memo(Re),Ee=ne.forwardRef((t,i)=>{const{css:d={},className:c,value:f,hourStep:A=1,minuteStep:P=1,hasFooter:T=!0,formatTime:a="hh:mm AA",views:v=re,defaultValue:y,onTimeChange:x,...R}=t,[V,b]=u.useState(!1),[n,O]=u.useState(C.cloneDeep(N)),[M,k]=u.useState(C.cloneDeep(Y)),F=u.useMemo(()=>!!y||!y&&!f,[y,f]),r=u.useRef(null),J=u.useRef(null),U=he(i),j=u.useMemo(()=>ce(a),[a]);u.useEffect(()=>{const e=f??y;if(r.current&&(r.current.value=e??""),e){const{hour:l,minute:p,second:m,session:I}=j;k({hour:e.substring(l.start,l.end),minute:e.substring(p.start,p.end),second:e.substring(m.start,m.end),session:e.substring(I.start,I.end)})}else k(C.cloneDeep(Y))},[f,y]);const se=u.useCallback(e=>{if(F&&k(e),r.current){const l=a.replace("hh",String(e.hour).padStart(2,"0")).replace("HH",String(e.hour).padStart(2,"0")).replace("mm",String(e.minute).padStart(2,"0")).replace("ss",String(e.second).padStart(2,"0")).replace("AA",String(e.session));F&&(r.current.value=l),x&&x(l)}},[T,a,F,x]),o=(e=!1)=>l=>{var p,m;!V&&e||(l==null||l.preventDefault(),l==null||l.stopPropagation(),(!((p=r.current)!=null&&p.value)||((m=r.current)==null?void 0:m.value)===a)&&(r.current&&(r.current.value=""),k(C.cloneDeep(Y))),e&&b(!1),O(C.cloneDeep(N)))},h=e=>{e.preventDefault(),D()},g=e=>{e.preventDefault(),D()},D=()=>{R.isReadOnly||R.isDisabled||setTimeout(()=>{if(r.current){r.current.value||(r.current.value=a);const e=r.current.selectionStart??0,l=X(a,e);O(l),r.current.setSelectionRange(l.start,l.end)}})},S=e=>{var W,G;if(!r.current||e.code==="Tab"||R.isReadOnly||R.isDisabled||(e.preventDefault(),e.stopPropagation(),!F&&!x))return;let p=!1;const m=r.current.value,I=m.split(""),E=+`${I[n.start]}${I[n.end-1]}`,w=a.substring(n.start,n.end),H=m.substring(n.start,n.end),Z=n.end-3,$=n.end+2;switch(e.code){case"Backspace":ee(m,w,{start:n.start,end:n.end},n);break;case"Space":break;case"ArrowLeft":if(Z<=0)return;{const K=X(a,Z);O(K),(W=r.current)==null||W.setSelectionRange(K.start,K.end)}break;case"ArrowRight":if($>a.length)return;{const K=X(a,$);O(K),(G=r.current)==null||G.setSelectionRange(K.start,K.end)}break;case"ArrowUp":Q("up",n.format,E,m,H,"AM");break;case"ArrowDown":Q("down",n.format,E,m,H,"PM");break;default:n.format==="AA"?(e.key.toLowerCase()==="a"||e.key.toLowerCase()==="p")&&ee(m,`${e.key.toUpperCase()}M`,{start:n.start,end:n.end},n):(p=/\d/.test(e.key),p&&z(m,I,e.key,$));break}},z=(e="",l=[],p,m=0)=>{let I="";const E=C.cloneDeep(n);let w=C.cloneDeep(E);+`${l[n.start]}${l[n.end-1]}${p}`<=n.max?(I=`${l[n.end-1]??"0"}${p}`,w=X(a,m)):(I=`0${p}`,+`${l[n.end-1]}0`>=n.max&&(w=X(a,m))),w.format?O(w):w=E,ee(e,I,{start:E.start,end:E.end},w)},Q=(e,l,p,m,I,E)=>{if(!r.current)return;let w="";const H=e==="up";if(l==="AA")["pm","am"].includes(I.toLowerCase())?w=I.toUpperCase()==="PM"?"AM":"PM":w=E.toUpperCase();else{const Z=H?n.min:n.max;if(isNaN(p))w=Z.toString().padStart(2,"0")??"00";else if(H){const $=p+1>n.max?n.min:p+1;w=($==null?void 0:$.toString().padStart(2,"0"))??"00"}else{const $=p-1<n.min?n.max:p-1;w=($==null?void 0:$.toString().padStart(2,"0"))??"00"}}ee(m,w,{start:n.start,end:n.end},n)},ee=(e,l,p,m)=>{if(!r.current)return;r.current.value=Ae(e,l,p.start,p.end);const{hour:I,minute:E,second:w,session:H}=j;k({hour:r.current.value.substring(I.start,I.end),minute:r.current.value.substring(E.start,E.end),second:r.current.value.substring(w.start,w.end),session:r.current.value.substring(H.start,H.end)}),Object.keys(j).some($=>{var G;const W=j[$];return W.format&&W.format===((G=r.current)==null?void 0:G.value.substring(W.start,W.end))})||x&&x(r.current.value||""),r.current.setSelectionRange(m.start,m.end)},ae=e=>{e.stopPropagation(),e.preventDefault(),!R.isDisabled&&b(!0)},le=()=>{b(!1)},de=u.useCallback(()=>{var e;(e=J.current)==null||e.focus()},[]);return s(Ie,{ref:U,className:c,css:d,children:s(me,{anchor:s(fe,{inputRef:r,onFocus:h,onBlur:o(),onClick:g,onKeyDown:S,placeholder:a,className:"time-picker-input",rightIcon:s("button",{onClick:ae,className:"time-picker-input-icon",disabled:R.isDisabled,ref:J,children:s("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s("path",{d:"M7.34375 4.28125C7.34375 3.91758 7.63633 3.625 8 3.625C8.36367 3.625 8.65625 3.91758 8.65625 4.28125V7.65L10.9887 9.20312C11.2895 9.40547 11.3715 9.81289 11.1473 10.1137C10.9695 10.4145 10.5621 10.4965 10.2613 10.2723L7.63633 8.52227C7.45312 8.42383 7.34375 8.21875 7.34375 7.97539V4.28125ZM8 1C11.8664 1 15 4.13359 15 8C15 11.8664 11.8664 15 8 15C4.13359 15 1 11.8664 1 8C1 4.13359 4.13359 1 8 1ZM2.3125 8C2.3125 11.1418 4.8582 13.6875 8 13.6875C11.1418 13.6875 13.6875 11.1418 13.6875 8C13.6875 4.8582 11.1418 2.3125 8 2.3125C4.8582 2.3125 2.3125 4.8582 2.3125 8Z"})})}),...R}),attachToElement:U.current&&U.current.parentElement,direction:"bottom-left",offset:8,isOpen:V,onClose:o(!0),children:s(Oe,{isUncontrolledComponent:F,views:v,isOpen:V,value:M,onItemClick:se,onOkClick:le,hourStep:A,minuteStep:P,hasFooter:T,isReadOnly:!!R.isReadOnly,onEscapeKeyDown:de})})})}),L=Ee;L.displayName="TimePicker";const Ue=()=>{const[t,i]=u.useState(""),[d,c]=u.useState("");return s(ue,{children:oe(pe,{children:[s("h3",{children:"Default (format: hh:mm AA)"}),s(B,{children:s(L,{defaultValue:"12:00 PM"})}),s("h3",{children:"Disable"}),s(B,{children:s(L,{defaultValue:"12:00 PM",isDisabled:!0})}),s("h3",{children:"Readonly"}),s(B,{children:s(L,{defaultValue:"12:00 PM",isReadOnly:!0})}),s("h3",{children:"With 12-hours uncontrolled"}),s(B,{children:s(L,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],defaultValue:"11:05:50 PM"})}),s("h3",{children:"With 12-hours controlled"}),s(B,{children:s(L,{formatTime:"hh:mm:ss AA",views:["hours12","minutes","seconds","sessions"],value:t,onTimeChange:f=>{console.log("Value 12-hours changed: ",f),i(f)}})}),s("h3",{children:"With 24-hours uncontrolled"}),s(B,{children:s(L,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,defaultValue:"05:05:55"})}),s("h3",{children:"With 24-hours controlled"}),s(B,{children:s(L,{formatTime:"HH:mm:ss",views:["hours24","minutes","seconds"],hasFooter:!0,value:d,onTimeChange:f=>{console.log("Value 24-hours changed: ",d),c(f)}})})]})})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Ue as Default};
