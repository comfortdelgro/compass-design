import{s as G,r as g,j as R,R as oe,a as N,F as Q}from"./index-bac5e390.js";import{B as ue}from"./index-e2938966.js";import"./index-8f02f36d.js";import{u as le,l as U,_ as X,z as q,Y as ee,y as ae,$ as ce,A as de,i as h,d as fe,aF as ne,ab as me,ak as ge,e as be,aK as he,t as H,V as ve,W as De,aG as xe,O as te,aL as re,aM as pe,aN as Re,a0 as ye,G as Ve,p as Ce,x as Se,a6 as $e,ae as we,K as F,aI as Me,aJ as se}from"./useCalendarState-46760d69.js";import{u as Te,a as z}from"./useEvent-fa6332d8.js";import{u as Fe}from"./use-dom-ref-c2dd4c70.js";import{B as K}from"./button-4f431114.js";const ke=G("div",{padding:"$3 $4 $3 $4",display:"flex",flexDirection:"column",gap:"$1",maxWidth:"193px",width:"100%",borderRight:"1px solid #F5F5F5"}),Ie=G("button",{margin:0,padding:"$3 $4",width:"100%",maxWidth:"160px",fontSize:"$label1",textAlign:"left",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"$button",color:"$primaryText","&:hover":{borderRadius:"6px",backgroundColor:"$gray20",fontWeight:"bold"},"&:focus-visible":{outline:"none",borderRadius:"6px",boxShadow:"0px 0px 0px 4px #F2F4F7"},"&:disabled":{backgroundColor:"transparent",fontWeight:"$normal",cursor:"not-allowed"},variants:{variants:{active:{backgroundColor:"$cdgBlue10",borderRadius:"6px","&:focus-visible":{backgroundColor:"$cdgBlue10",boxShadow:"0px 0px 0px 4px #F2F4F7"}},inactive:{}}},defaultVariants:{variants:"inactive"}}),Oe=n=>{const[e,d]=g.useState(null),[c,f]=g.useState(null),{state:a,customShortcuts:b=D=>D}=n,{locale:s}=le();g.useEffect(()=>{var D,L;!(c!=null&&c.start)||!c.end||e&&((D=a.value.end)==null?void 0:D.compare(c.end))!==0&&((L=a.value.start)==null?void 0:L.compare(c.start))!==0&&d(null)},[a.value]);const i=new Intl.DateTimeFormat(s).resolvedOptions().timeZone,l=U(i),v=l.subtract({days:1}),t=l.subtract({weeks:1}),C=l.subtract({months:1}),m=X(l,s),V=q(l,s),r=X(t,s),y=q(t,s),x=ee(l),k=ae(l),I=ee(C),S=ae(C),u=ce(l),M=de(l),O=[{label:"Today",isDisable:(()=>h(l,a.minValue,a.maxValue))(),getValue:()=>({end:l,start:l})},{label:"Yesterday",isDisable:(()=>h(v,a.minValue,a.maxValue))(),getValue:()=>({end:v,start:v})},{label:"This Week",isDisable:(()=>h(m,a.minValue,a.maxValue)||h(V,a.minValue,a.maxValue))(),getValue:()=>({start:m,end:V})},{label:"Last Week",isDisable:(()=>h(r,a.minValue,a.maxValue)||h(y,a.minValue,a.maxValue))(),getValue:()=>({start:r,end:y})},{label:"This Month",isDisable:(()=>h(x,a.minValue,a.maxValue)||h(k,a.minValue,a.maxValue))(),getValue:()=>({start:x,end:k})},{label:"Last Month",isDisable:(()=>h(I,a.minValue,a.maxValue)||h(S,a.minValue,a.maxValue))(),getValue:()=>({start:I,end:S})},{label:"This Year",isDisable:(()=>h(u,a.minValue,a.maxValue)||h(M,a.minValue,a.maxValue))(),getValue:()=>({start:u,end:M})}];return{shorcuts:b(O,D=>h(D,a.minValue,a.maxValue)),selectedItem:e,setSelectedItem:d,setCurrentRangeDate:f}},Pe=n=>{const{state:e,pickerState:d}=n,{shorcuts:c,selectedItem:f,setSelectedItem:a,setCurrentRangeDate:b}=Oe(n),s=i=>{var v;const l=i.getValue();d?d.setDateRange(l):e.setValue(l),l.end&&((v=e.setFocusedDate)==null||v.call(e,l.end)),a(i.label),b(l),e.setAnchorDate(null)};return R(ke,{children:c&&c.map(i=>R(Ie,{"aria-disabled":i.isDisable,type:"button",variants:f===i.label?"active":"inactive",disabled:i.isDisable,onClick:()=>s(i),children:i.label},i.label))})},Be=Pe;function Le(n,e){var t,C,m,V;const d=fe(n);if(e.visibleRange==null)return{};const c=ne(e.visibleRange.start,e.timeZone??"UTC"),f=ne(e.visibleRange.start,e.timeZone??"UTC"),a=Te([!!n.errorMessage,n.validationState]);me.set(e,{ariaLabel:n["aria-label"]??"",ariaLabelledBy:n["aria-labelledby"],errorMessageId:a});const b=g.useRef(!1),s=n.isDisabled||((t=e.isNextVisibleRangeInvalid)==null?void 0:t.call(e));s&&b.current&&(b.current=!1,(C=e.setFocused)==null||C.call(e,!0));const i=g.useRef(!1),l=n.isDisabled||((m=e.isPreviousVisibleRangeInvalid)==null?void 0:m.call(e));l&&i.current&&(i.current=!1,(V=e.setFocused)==null||V.call(e,!0));const v=ge({id:n.id,"aria-label":[n["aria-label"],f].filter(Boolean).join(", "),"aria-labelledby":n["aria-labelledby"]});return{calendarProps:{...d,...v,role:"group","aria-describedby":n["aria-describedby"]||void 0},nextButtonProps:{onPress:()=>{var r;return(r=e.focusNextPage)==null?void 0:r.call(e)},"aria-label":"next",isDisabled:s,onFocus:()=>b.current=!0,onBlur:()=>b.current=!1},prevButtonProps:{onPress:()=>{var r;return(r=e.focusPreviousPage)==null?void 0:r.call(e)},"aria-label":"previous",isDisabled:l,onFocus:()=>i.current=!0,onBlur:()=>i.current=!1},title:c}}function We(n,e,d){const c=Le(n,e),f=g.useRef(!1),a=g.useRef(typeof window<"u"?window:null);z(a,"pointerdown",s=>{f.current=s.width===0&&s.height===0});const b=s=>{var v;if(f.current){f.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;const i=s.target,l=document.getElementById(c.calendarProps.id);l&&l.contains(document.activeElement)&&(!l.contains(i)||!i.closest('button, [role="button"]'))&&((v=e.selectFocusedDate)==null||v.call(e))};return z(a,"pointerup",b),z(a,"pointercancel",b),c.calendarProps.onBlur=s=>{var i;(!s.relatedTarget||!d.current.contains(s.relatedTarget))&&e.anchorDate&&((i=e.selectFocusedDate)==null||i.call(e))},z(d,"touchmove",s=>{e.isDragging&&s.preventDefault()},{passive:!1,capture:!0}),c}function Ae(n){var A,w,W,J;const{value:e,defaultValue:d,onChange:c,createCalendar:f,locale:a,visibleDuration:b={months:1},minValue:s,maxValue:i,shouldOnChangeTriggerOnSameDate:l,...v}=n,[t,C]=be(e,d||null,c),[m,V]=g.useState(t!=null&&t.start&&!t.end?t==null?void 0:t.start:null);let r="center";if(t&&t.start&&t.end){const p=he(H(t.start),b,a,s,i).add(b).subtract({days:1});t.end.compare(p)>0&&(r="start")}const y=g.useRef(null),[x,k]=g.useState(),I=g.useMemo(()=>ve(s,x==null?void 0:x.start),[s,x]),S=g.useMemo(()=>De(i,x==null?void 0:x.end),[i,x]),u=xe({...v,value:t&&t.start,createCalendar:f,locale:a,visibleDuration:b,minValue:I,maxValue:S,selectionAlignment:r}),M=o=>{o&&n.isDateUnavailable&&!n.allowsNonContiguousRanges?(y.current={start:re(o,u,-1),end:re(o,u,1)},k(y.current)):(y.current=null,k(void 0))},O=g.useRef(u.visibleRange);(!te((A=u.visibleRange)==null?void 0:A.start,(w=O.current)==null?void 0:w.start)||!te((W=u.visibleRange)==null?void 0:W.end,(J=O.current)==null?void 0:J.end))&&(M(m),O.current=u.visibleRange);const P=o=>{o?(V(o),M(o)):(V(null),M(null))},$=m?_(m,u.focusedDate):t&&_(t.start,t.end),D=o=>{var p,T;if(!n.isReadOnly&&(o=pe(o,I,S),o=Re(o,(p=u.visibleRange)==null?void 0:p.start,n.isDateUnavailable),!!o))if(!m)P(o),c==null||c({start:o,end:null});else if(m.compare(o)>0||((T=t==null?void 0:t.end)==null?void 0:T.compare(o))===0)P(o),c==null||c({start:o,end:null});else{const E=_(m,o);C({start:ie(E.start,t==null?void 0:t.start),end:ie(E.end,t==null?void 0:t.end)}),P(null)}},[L,Y]=g.useState(!1),{isDateUnavailable:B}=n,j=g.useMemo(()=>!t||m?!1:B&&(B(t.start)||B(t.end))?!0:h(t.start,s,i)||h(t.end,s,i),[B,t,m,s,i]),Z=n.validationState||(j?"invalid":null);return{...u,value:t,shouldOnChangeTriggerOnSameDate:l,setValue:C,anchorDate:m,setAnchorDate:P,highlightedRange:$,validationState:Z,selectFocusedDate(){D(u.focusedDate)},selectDate:D,highlightDate(o){var p;m&&((p=u.setFocusedDate)==null||p.call(u,o))},isSelected(o){var p,T;return $&&o.compare($.start)>=0&&o.compare($.end)<=0&&!((p=u.isCellDisabled)!=null&&p.call(u,o))&&!((T=u.isCellUnavailable)!=null&&T.call(u,o))},isInvalid(o){var p,T,E;return((p=u.isInvalid)==null?void 0:p.call(u,o))||h(o,(T=y.current)==null?void 0:T.start,(E=y.current)==null?void 0:E.end)},isDragging:L,setDragging:Y}}function _(n,e){return!n||!e?null:(e.compare(n)<0&&([n,e]=[e,n]),{start:H(n),end:H(e)})}function ie(n,e){return n=ye(n,(e==null?void 0:e.calendar)||new Ve),e&&"hour"in e?e.set(n):n}function Ee(n){const e=a=>typeof window<"u"?window.matchMedia(a).matches:!1,[d,c]=g.useState(e(n));function f(){c(e(n))}return g.useEffect(()=>{const a=window.matchMedia(n);return f(),a.addListener?a.addListener(f):a.addEventListener("change",f),()=>{a.removeListener?a.removeListener(f):a.removeEventListener("change",f)}},[n]),d}const Ne=G("div",{width:"fit-content",backgroundColor:"$background",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.08)",borderRadius:"$md",padding:"$4","& .calendar-body":{display:"flex",justifyContent:"space-between",gap:"$2"},"& .calendar-footer":{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"$6",paddingTop:"$6",borderTop:"1px solid $gray40",color:"$primaryText"},"& .calendar-footer .calendar-footer-right-side":{display:"flex",alignItems:"center",gap:"$4"},"& .calendar-footer .preview-date":{margin:0,fontSize:"$body3"},"& .calendar-footer button":{padding:"$1 $2_5",height:"$8",fontSize:"$label2"},variants:{variants:{extend:{display:"flex",flexDirection:"row",padding:0,"& > div:nth-child(2)":{padding:"$4"}},basic:{}}},defaultVariants:{variants:"basic"}});G("div",{display:"flex",flexDirection:"row"});const Ue=oe.forwardRef((n,e)=>{var Y,B,j,Z,A;const{state:d,hasFooter:c,css:f={},maxValue:a=Ce("2999-02-17"),hasShortcuts:b=!1,ctaButtonRender:s,visibleMonths:i=2,onSearchButtonClick:l,customShortcuts:v,...t}=n,m=Ee("(max-width: 768px)")?1:i,{locale:V}=le(),r=Ae({...t,value:n.state?(Y=n.state)==null?void 0:Y.value:n.value,visibleDuration:{months:m},locale:V,createCalendar:Se}),y=Fe(e),{calendarProps:x,prevButtonProps:k,nextButtonProps:I}=We(t,r,y),S=$e({}),{setIsReset:u}=we(),M=()=>{r.setValue({start:null,end:null}),r.setAnchorDate(null),u==null||u(!0)},O=()=>{var W;const w={start:U(F()),end:U(F())};d?d==null||d.setDateRange(w):r.setValue(w),r.setAnchorDate(null),(W=r.setFocusedDate)==null||W.call(r,U(F()))},P=g.useMemo(()=>{const w=U(F());return h(w,t.minValue,a)},[t.minValue,a]),$=m!==1,D=!!($&&b),L=g.useCallback(()=>s||(D?R(K,{variant:"primary",onPress:w=>l==null?void 0:l(w),children:"Search"}):R(K,{variant:"primary",onPress:O,isDisabled:P,children:"Today"})),[s,D]);return N(Ne,{ref:y,css:f,variants:D?"extend":"basic",children:[D?R(Be,{state:r,pickerState:d,customShortcuts:v}):R(Q,{}),N(ue,{children:[R(Me,{state:r,variant:$?"range":"default",calendarProps:x,prevButtonProps:k,nextButtonProps:I}),N("div",{className:"calendar-body",children:[R(se,{state:r,maxValue:a}),$?R(se,{state:r,offset:{months:1},maxValue:a}):R(Q,{})]}),c&&N("div",{className:"calendar-footer",children:[R(K,{variant:"ghost",onPress:M,children:"Clear"}),N("div",{className:"calendar-footer-right-side",children:[R("p",{className:"preview-date",children:(B=r==null?void 0:r.value)!=null&&B.start&&((j=r==null?void 0:r.value)!=null&&j.end)?S.formatRange(r.value.start.toDate(F()),r.value.end.toDate(F())):`${(Z=r==null?void 0:r.value)!=null&&Z.start?S.format(r.value.start.toDate(F())):""} - ${(A=r==null?void 0:r.value)!=null&&A.end?S.format(r.value.end.toDate(F())):""}`}),L()]})]})]})]})}),He=Ue;export{He as R,Ee as u};
