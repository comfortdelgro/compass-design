import{r as c}from"./index-6c164b11.js";const R=(u,[e,r])=>Math.min(Math.max(u,e),r),L=(u,e)=>{const r=Math.floor(u/e)*e,d=Math.ceil(u/e)*e;return u-r>d-u?d:r},$=u=>{const e=c.useMemo(()=>{const t={prevent:!0,touch:!0,mouse:!0,direction:"both",limit:{x:{max:1/0,min:-1/0},y:{max:1/0,min:-1/0}},stepSize:0,setCSS:!0,disabled:!1,...u};return t.disabled&&(t.mouse=!1,t.touch=!1),t},[u]),r=e.targetRef||c.useRef(null),d=c.useRef({x:0,y:0}),E=c.useRef({x:0,y:0}),l=c.useRef(!1),[b,j]=c.useState({x:0,y:0}),f=c.useCallback((t,n)=>{r.current&&(!(n!=null&&n.skipCalulateStep)&&e.stepSize&&(t={x:L(b.x,typeof e.stepSize=="object"?e.stepSize.x:e.stepSize),y:L(b.y,typeof e.stepSize=="object"?e.stepSize.y:e.stepSize)}),E.current=t,j(t),e.setCSS&&(n!=null&&n.transition?r.current.style.transition=n.transition:r.current.style.transition="",r.current.style.transform=`translate3d(${t.x}px, ${t.y}px, 0)`))},[e.setCSS,e.stepSize]),h=c.useCallback(t=>{var i,s,S,x;const{x:n,y:v}=E.current;let o=n,a=v;if(e.touch&&((s=(i=t.touches)==null?void 0:i[0])!=null&&s.clientX)){const y=t.touches[0];y&&(l.current=!0,o=y.clientX-n,a=y.clientY-v,d.current={x:o,y:a},(S=e.onStart)==null||S.call(e,r,{x:o,y:a},f));return}e.mouse&&t instanceof window.MouseEvent&&t.button===0&&(l.current=!0,o=t.clientX-n,a=t.clientY-v,d.current={x:o,y:a},(x=e.onStart)==null||x.call(e,r,{x:o,y:a},f))},[e,f]),p=c.useCallback(t=>{var S,x,y,g,M,X,C,I,Y,k,w;if(!l.current||!e.mouse&&!e.touch)return;e.prevent&&t.cancelable&&t.preventDefault();const{x:n,y:v}=d.current,{x:o,y:a}=E.current;let i=o,s=a;if(e.touch&&((x=(S=t.touches)==null?void 0:S[0])!=null&&x.clientX)){const z=t.touches[0];z&&(i=z.clientX-n,s=z.clientY-v)}else e.mouse&&t instanceof window.MouseEvent&&t.button===0&&(i=t.clientX-n,s=t.clientY-v);e.stepSize&&(i=L(i,typeof e.stepSize=="object"?e.stepSize.x:e.stepSize),s=L(s,typeof e.stepSize=="object"?e.stepSize.y:e.stepSize)),i=e.direction==="vertical"?0:R(i,[((g=(y=e.limit)==null?void 0:y.x)==null?void 0:g.min)??-1/0,((X=(M=e.limit)==null?void 0:M.x)==null?void 0:X.max)??1/0]),s=e.direction==="horizontal"?0:R(s,[((I=(C=e.limit)==null?void 0:C.y)==null?void 0:I.min)??-1/0,((k=(Y=e.limit)==null?void 0:Y.y)==null?void 0:k.max)??1/0]),(i!==o||s!==a)&&((w=e.onMove)==null||w.call(e,r,{x:i,y:s})),f({x:i,y:s},{skipCalulateStep:!0})},[l,e,f]),m=c.useCallback(t=>{var n;l.current&&(e.touch&&typeof t.touches<"u"||e.mouse&&t instanceof window.MouseEvent&&t.button===0)&&(l.current=!1,(n=e.onEnd)==null||n.call(e,r,E.current,f))},[l,e,f]);return c.useEffect(()=>{const t=r.current;if(!(typeof window>"u"||typeof document>"u"||!t))return e.touch&&(t.addEventListener("touchstart",h),t.addEventListener("touchmove",p,{passive:!e.prevent}),document.addEventListener("touchcancel",m),document.addEventListener("touchend",m)),e.mouse&&(t.addEventListener("mousedown",h),document.addEventListener("mousemove",p),document.addEventListener("mouseup",m)),()=>{e.touch&&(t.removeEventListener("touchstart",h),t.removeEventListener("touchmove",p),document.removeEventListener("touchcancel",m),document.removeEventListener("touchend",m)),e.mouse&&(t.removeEventListener("mousedown",h),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",m))}},[r,e,h,p,m]),{target:e.targetRef?void 0:r,position:b,setPosition:f}};export{$ as u};
