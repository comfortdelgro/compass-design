import{$ as M,a as T,b as k,c as I,d as C}from"./import-1ca76cd5.js";import{r as O,s as $,R as x,j as y,a as B,F as W}from"./index-5f8fa73a.js";import{C as w}from"./calendar-9c0c2733.js";import{u as U,a as Z,b as K,c as E,d as j,D as q,P as G,e as N}from"./useOverlayTriggerState-68f8fb56.js";import{a as R,u as z,b as A,c as H,r as J,d as L,i as Q,g as S,e as X,D as Y}from"./useCalendarState-8c42177e.js";import{u as _}from"./use-dom-ref-86ceca89.js";function p(e,a,i){const l=R(),r=R(),t=R(),{labelProps:o,fieldProps:s,descriptionProps:f,errorMessageProps:b}=U({...e,labelElementType:"span"}),c=Z(a,i),u=s["aria-labelledby"]||s.id,{locale:m}=M(),h=a.formatValue(m,{month:"long"}),g=h?`selectedDateDescription ${h}`:"",P=z(g),D=[P["aria-describedby"],s["aria-describedby"]].filter(Boolean).join(" ")||void 0,V=A(e),v=O.useMemo(()=>H(i),[i]),{focusWithinProps:n}=K({...e,isDisabled:a.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...V,...c,...s,...P,...n,role:"group","aria-disabled":e.isDisabled||null,"aria-labelledby":u,"aria-describedby":D,onKeyDown(d){a.isOpen||e.onKeyDown&&e.onKeyDown(d)},onKeyUp(d){a.isOpen||e.onKeyUp&&e.onKeyUp(d)}},labelProps:{...o,onClick:()=>{v.focusFirst()}},fieldProps:{...s,id:t,[J]:"presentation","aria-describedby":D,value:a.value,onChange:a.setValue,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:a.validationState,autoFocus:e.autoFocus},descriptionProps:f,errorMessageProps:b,buttonProps:{...P,id:l,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${u} ${l}`,"aria-describedby":D,"aria-expanded":a.isOpen||void 0,onPress:()=>a.setOpen(!0)},dialogProps:{id:r,"aria-labelledby":`${u} ${l}`},calendarProps:{autoFocus:!0,value:a.dateValue,onChange:a.setDateValue,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,defaultFocusedValue:a.dateValue?void 0:e.placeholderValue,validationState:a.validationState,errorMessage:e.errorMessage}}}function ee(e){var v;const a=E(e),[i,l]=L(e.value,e.defaultValue,e.onChange),r=i||e.placeholderValue,[t,o]=j(r,e.granularity),s=i!=null?i.toDate(o??"UTC"):null,f=t==="hour"||t==="minute"||t==="second",b=e.shouldCloseOnSelect??!0,[c,u]=O.useState(),[m,h]=O.useState();if(O.useEffect(()=>{i&&(u(i),"hour"in i&&h(i))},[i]),r&&!(t in r))throw new Error("Invalid granularity "+t+" for value "+r.toString());const g=(n,d)=>{l("timeZone"in d?d.set(k(n)):I(n,d)),u(void 0),h(void 0)},P=n=>{const d=typeof b=="function"?b():b;f?m||d?g(n,m||S(e.placeholderValue)):u(n):l(n),d&&setTimeout(()=>{a.setOpen(!1)},0)},D=n=>{c?g(c,n):h(n)},V=e.validationState||(Q(i,e.minValue,e.maxValue)?"invalid":null)||(i&&((v=e.isDateUnavailable)!=null&&v.call(e,i))?"invalid":null);return{value:i,setValue:l,dateValue:c,timeValue:m,setDateValue:P,setTimeValue:D,granularity:t,hasTime:f,...a,setOpen(n){!n&&!i&&c&&f&&g(c,m||S(e.placeholderValue)),a.setOpen(n)},validationState:V,formatValue(n,d){if(!s)return"";const F=X(d,{granularity:t,timeZone:o,hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:i.calendar.identifier==="gregory"&&i.era==="BC"});return new T(n,F).format(s)}}}const ae=$("div",{width:"fit-content"}),ie=$("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),le=x.forwardRef((e,a)=>{const{css:i={},maxValue:l=C("2999-03-10"),ctaButtonRender:r}=e,t=ee({...e,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:e.shouldCloseOnSelect??!1}),o=_(a),{groupProps:s,fieldProps:f,buttonProps:b,dialogProps:c,calendarProps:u}=p({...e,isReadOnly:e.isReadOnly?!0:!!e.isMobile},t,o),m={necessityIndicator:e.necessityIndicator,...f},h=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return u.isReadOnly=h(),y(ae,{css:i,children:B(Y,{children:[y(te,{ref:o,groupProps:s,fieldProps:m,buttonProps:b,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,label:e.label,errorMessage:e.errorMessage,helperText:e.helperText}),y(ne,{maxValue:l,state:t,calendarProps:u,calendarRef:o,dialogProps:c,css:e.calendarCSS,ctaButtonRender:r})]})})}),te=x.forwardRef((e,a)=>{const{groupProps:i,fieldProps:l,buttonProps:r,label:t,isInvalid:o,isMobile:s,isReadOnly:f=!1,errorMessage:b,helperText:c}=e;return y(ie,{...i,ref:a,children:y(q,{...l,"aria-describedby":l["aria-describedby"]??"",buttonProps:r,label:t,isInvalid:o,isMobile:s,isReadOnly:f,errorMessage:b,helperText:c})})}),ne=e=>{const{state:a,calendarRef:i,dialogProps:l,calendarProps:r,maxValue:t=C("2999-03-10"),ctaButtonRender:o,css:s={}}=e;return y(W,{children:a.isOpen&&y(G,{state:a,triggerRef:i,offset:8,placement:"bottom start",children:y(N,{...l,"aria-describedby":l["aria-describedby"]??"","aria-label":l["aria-label"]??"","aria-labelledby":l["aria-labelledby"]??"",children:y(w,{state:a,hasFooter:!0,...r,maxValue:t,css:s,ctaButtonRender:o})})})})},se=le;se.displayName="DatePicker";export{se as D};
