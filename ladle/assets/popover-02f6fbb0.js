import{s as x,R as C,r as f,a as T,j as R}from"./index-e285302b.js";import{u as v}from"./use-dom-ref-58648911.js";const S=x("div",{display:"inline-block"}),B=x("div",{display:"block",position:"absolute",zIndex:"60","&.bottom-center":{transform:"translateX(-50%)"},"&.top-center":{transform:"translateX(-50%)"}}),O=10,j=C.forwardRef((E,$)=>{const{children:k,anchor:y,isOpen:u,offset:s=O,css:P={},direction:p="bottom-left",attachToElement:d,onClose:m=()=>null,...w}=E,[a,L]=f.useState({top:"0",right:"auto",bottom:"auto",left:"0"}),r=v($),e=v(),l=n=>{r.current&&!r.current.contains(n.target)&&e.current&&!e.current.contains(n.target)&&m()};f.useEffect(()=>(document.addEventListener("mousedown",l),document.querySelectorAll('[role="rowgroup"]').forEach(function(n){n.addEventListener("click",l)}),()=>{document.removeEventListener("mousedown",l),document.querySelectorAll('[role="rowgroup"]').forEach(function(n){n.removeEventListener("click",l)})})),f.useEffect(()=>{if(e.current&&r.current)if(u){const n=d||document.body;h(),n.appendChild(e.current)}else e.current.parentElement&&e.current.parentElement.removeChild(e.current)},[u]),f.useEffect(()=>{e.current&&r.current&&h()},[e.current,r.current]);const h=()=>{if(r.current&&e.current){const n=d||document.body;n.style.position="relative";const t={...a},o=r.current.children[0]||r.current,i=o.offsetParent||n,c=r.current.getBoundingClientRect();switch(p){case"bottom-left":default:t.top=`${o.offsetTop+c.height+s}px`,t.left=`${o.offsetLeft}px`,t.bottom="auto",t.right="auto";break;case"bottom-center":t.top=`${o.offsetTop+c.height+s}px`,t.left=`${o.offsetLeft+c.width/2}px`,t.bottom="auto",t.right="auto";break;case"bottom-right":t.top=`${o.offsetTop+c.height+s}px`,t.left="auto",t.bottom="auto",t.right=`${i.clientWidth-o.offsetLeft-c.width}px`;break;case"top-left":t.top="auto",t.left=`${o.offsetLeft}px`,t.bottom=`${i.clientHeight-o.offsetTop+s}px`,t.right="auto";break;case"top-center":t.top="auto",t.left=`${o.offsetLeft+c.width/2}px`,t.bottom=`${i.clientHeight-o.offsetTop+s}px`,t.right="auto";break;case"top-right":t.top="auto",t.left="auto",t.bottom=`${i.clientHeight-o.offsetTop+s}px`,t.right=`${i.clientWidth-o.offsetLeft-c.width}px`;break}L(t)}},b=()=>{m()},g=f.useCallback(()=>{requestAnimationFrame(()=>{e.current&&!e.current.contains(document.activeElement)&&e.current&&!e.current.contains(document.activeElement)&&b()})},[r,b]);return T(S,{className:"cdg-popover",ref:r,css:P,...w,onBlur:g,tabIndex:0,children:[y,R(B,{ref:e,className:`cdg-popover-content ${p}`,style:{top:a.top,left:a.left,right:a.right,bottom:a.bottom},onBlur:g,tabIndex:0,children:k})]})}),H=j;export{H as P};
