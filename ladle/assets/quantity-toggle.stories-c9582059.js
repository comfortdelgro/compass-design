import{s as J,R as F,r as i,j as m,a as U}from"./index-56d078fc.js";import{C as oe}from"./components-d15b83dd.js";import{u as ae}from"./use-dom-ref-da3a6937.js";import{c as le,a as Q,$ as se}from"./clsx.m-30223e4c.js";const ce=J("div",{width:"100%",display:"flex",flexDirection:"column",label:{fontSize:"$label1",fontWeight:"$medium",lineHeight:"$normal",display:"block",marginBottom:"$1",color:"$gray90",span:{marginLeft:"$1",color:"$danger"}},div:{display:"flex",width:"100%",input:{flex:1,color:"#323130",padding:"$3 $4",textAlign:"center",border:"1px solid #EDEBE9",borderRadius:"0",backgroundColor:"$white",fontSize:"$label1",fontWeight:"$semibold"},"input::placeholder":{color:"$gray40"},button:{color:"#323130",aspectRatio:"1",width:"$14",cursor:"pointer",fontWeight:"$bold",border:"1px solid #EDEBE9",backgroundColor:"$gray10"},"button[aria-label='decrease']":{borderRight:"none",borderRadius:"4px 0 0 4px"},"button[aria-label='increase']":{borderLeft:"none",borderRadius:"0 4px 4px 0"}},variants:{isDisabled:{true:{cursor:"not-allowed",div:{input:{backgroundColor:"#EDEBE9",cursor:"not-allowed"},button:{borderColor:"#EDEBE9",cursor:"not-allowed"}}}},isErrored:{true:{div:{input:{borderColor:"$danger"},button:{borderColor:"$danger"}}}}}}),X=J("div",{fontSize:"$label2",fontWeight:"$medium",transition:"$default",marginTop:"$1",color:"$gray70",variants:{error:{true:{color:"$danger"}}}});function ie(...e){return(...t)=>{for(const n of e)typeof n=="function"&&n(...t)}}function B(...e){const t={...e[0]};for(let n=1;n<e.length;n++){const r=e[n];for(const o in r){const l=t[o],c=r[o];typeof l=="function"&&typeof c=="function"&&o.startsWith("o")&&o[1]==="n"&&o.charCodeAt(2)>=65&&o.charCodeAt(2)<=90?t[o]=ie(l,c):(o==="className"||o==="UNSAFE_className")&&typeof l=="string"&&typeof c=="string"?t[o]=le(l,c):t[o]=c!==void 0?c:l}}return t}const Z=typeof window<"u"?F.useLayoutEffect:()=>{};class ue{constructor(t,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=t}isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}}function de(e){const t=i.useRef({isFocused:!1,onBlur:e,observer:null});return t.current.onBlur=e,Z(()=>{const n=t.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]),i.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){t.current.isFocused=!0;const r=n.target,o=l=>{t.current.isFocused=!1,r.disabled&&t.current.onBlur(new ue("blur",l)),t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};r.addEventListener("focusout",o,{once:!0}),t.current.observer=new MutationObserver(()=>{var l;t.current.isFocused&&r.disabled&&((l=t.current.observer)==null||l.disconnect(),r.dispatchEvent(new FocusEvent("blur")),r.dispatchEvent(new FocusEvent("focusout",{bubbles:!0})))}),t.current.observer.observe(r,{attributes:!0,attributeFilter:["disabled"]})}},[])}function ee(e){const{isDisabled:t,onFocus:n,onBlur:r,onFocusChange:o}=e,l=i.useCallback(s=>(s.target===s.currentTarget&&(r&&r(s),o&&o(!1)),!0),[r,o]),c=de(l),a=i.useCallback(s=>{s.target===s.currentTarget&&document.activeElement===s.target&&(n&&n(s),o&&o(!0),c(s))},[o,n,c]);return{focusProps:{onFocus:!t&&(n||o||r)?a:void 0,onBlur:!t&&(r||o)?l:void 0}}}function fe(e){if(me())e.focus({preventScroll:!0});else{const t=be(e);e.focus(),pe(t)}}let O=!1;function me(){if(!O){O=!1;try{document.createElement("div").focus({get preventScroll(){return O=!0,!0}})}catch{}}return O}function be(e){let t=e.parentNode;const n=[],r=document.scrollingElement??document.documentElement;for(;t instanceof HTMLElement&&t!==r;)(t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth)&&n.push({element:t,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),t=t.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function pe(e){for(const{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}function _(e){if(e){let t=!0;return n=>{const r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){t=!1}};e(r),t&&n.stopPropagation()}}else return()=>{}}function he(e){return{keyboardProps:e.isDisabled?{}:{onKeyDown:_(e.onKeyDown),onKeyUp:_(e.onKeyUp)}}}function ge(e,t){Z(()=>{var n;return(n=e.ref)!=null&&n.current&&(e.ref.current=t.current),()=>{var r;(r=e.ref)!=null&&r.current&&(e.ref.current=null)}},[e,t])}const te=F.createContext(null);function ve(e){const t=i.useContext(te)||{};ge(t,e);let{ref:n,...r}=t;return r}function ye(e,t){const{children:n,...r}=e,o={...r,ref:t};return m(te.Provider,{value:o,children:n})}F.forwardRef(ye);function Se(e,t){const{focusProps:n}=ee(e),{keyboardProps:r}=he(e),o=B(n,r),l=ve(t),c=e.isDisabled?{}:l,a=i.useRef(e.autoFocus);return i.useEffect(()=>{a.current&&t.current&&fe(t.current),a.current=!1},[t]),{focusableProps:B({...o,tabIndex:e.excludeFromTabOrder&&!e.isDisabled?-1:void 0},c)}}function Ee(e,t){const{isDisabled:n=!1,isRequired:r=!1,isReadOnly:o=!1,validationState:l,type:c="text",onChange:a=()=>{}}=e,{focusableProps:s}=Se(e,t);return{inputProps:B(e,{type:c,pattern:e.pattern,disabled:n,readOnly:o,"aria-required":r||void 0,"aria-invalid":l==="invalid"||void 0,"aria-errormessage":e["aria-errormessage"],"aria-activedescendant":e["aria-activedescendant"],"aria-autocomplete":e["aria-autocomplete"],"aria-haspopup":e["aria-haspopup"],value:e.value,defaultValue:e.value?void 0:e.defaultValue,onChange:u=>a(u.target.value),autoComplete:e.autoComplete,maxLength:e.maxLength,minLength:e.minLength,name:e.name,placeholder:e.placeholder,inputMode:e.inputMode,onCopy:e.onCopy,onCut:e.onCut,onPaste:e.onPaste,onCompositionEnd:e.onCompositionEnd,onCompositionStart:e.onCompositionStart,onCompositionUpdate:e.onCompositionUpdate,onSelect:e.onSelect,onBeforeInput:e.onBeforeInput,onInput:e.onInput,...s})}}function G(){return typeof window<"u"&&window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"}function Pe(e,t,n){const r=i.useRef(t);r.current=t,i.useEffect(()=>{if(!G())return;const a=n.current,s=u=>{const g=r.current;let d;switch(u.inputType){case"historyUndo":case"historyRedo":return;case"deleteContent":case"deleteByCut":case"deleteByDrag":d=a.value.slice(0,a.selectionStart)+a.value.slice(a.selectionEnd);break;case"deleteContentForward":d=a.selectionEnd===a.selectionStart?a.value.slice(0,a.selectionStart)+a.value.slice(a.selectionEnd+1):a.value.slice(0,a.selectionStart)+a.value.slice(a.selectionEnd);break;case"deleteContentBackward":d=a.selectionEnd===a.selectionStart?a.value.slice(0,a.selectionStart-1)+a.value.slice(a.selectionStart):a.value.slice(0,a.selectionStart)+a.value.slice(a.selectionEnd);break;case"deleteSoftLineBackward":case"deleteHardLineBackward":d=a.value.slice(a.selectionStart);break;default:u.data!=null&&(d=a.value.slice(0,a.selectionStart)+u.data+a.value.slice(a.selectionEnd));break}(d==null||!g.validate(d))&&u.preventDefault()};return a.addEventListener("beforeinput",s,!1),()=>{a.removeEventListener("beforeinput",s,!1)}},[n,r]);const o=G()?null:a=>{const s=a.target.value.slice(0,a.target.selectionStart)+a.data+a.target.value.slice(a.target.selectionEnd);t.validate(s)||a.preventDefault()},{inputProps:l}=Ee(e,n),c=i.useRef(null);return{...B(l,{onBeforeInput:o,onCompositionStart(){const{value:a,selectionStart:s,selectionEnd:u}=n.current;c.current={value:a,selectionStart:s,selectionEnd:u}},onCompositionEnd(){if(!t.validate(n.current.value)){const{value:a,selectionStart:s,selectionEnd:u}=c.current;n.current.value=a,n.current.setSelectionRange(s,u),t.setInputValue(a)}}})}}function De(e){const t=i.useRef(),{isReadOnly:n,onIncrement:r,onDecrement:o,onIncrementPage:l,onDecrementPage:c,onDecrementToMin:a,onIncrementToMax:s}=e,u=i.useRef(e);u.current=e;const g=()=>clearTimeout(t.current);i.useEffect(()=>()=>g(),[]);const d=b=>{if(!(b.ctrlKey||b.metaKey||b.shiftKey||b.altKey||n))switch(b.key){case"PageUp":l&&(b.preventDefault(),l());break;case"ArrowUp":case"Up":r&&(b.preventDefault(),r());break;case"PageDown":c&&(b.preventDefault(),c());break;case"ArrowDown":case"Down":o&&(b.preventDefault(),o());break;case"Home":a&&(b.preventDefault(),a());break;case"End":s&&(b.preventDefault(),s());break}},h=i.useRef(!1);return{onKeyDown:d,onFocus:()=>{h.current=!0},onBlur:()=>{h.current=!1}}}function we(e={}){return i.useMemo(()=>new Q("en-US",e),[e])}function Ce(e,t,n,r){i.useEffect(()=>{const o=e.current;return o&&n!==null&&o.addEventListener(t,n,r),()=>{o&&n!==null&&o.removeEventListener(t,n,r)}},[e,t,r])}function Ve(e,t){const{onScroll:n,isDisabled:r}=e,o=i.useCallback(l=>{const c=l;c.ctrlKey||(c.preventDefault(),c.stopPropagation(),n&&n({deltaX:c.deltaX,deltaY:c.deltaY}))},[n]);Ce(t,"wheel",r?null:o,{passive:!1})}function Me(e,t,n){const{label:r,description:o,errorMessage:l,formatOptions:c,autoFocus:a=!1,isRequired:s=!1,isReadOnly:u=!1,isDisabled:g=!1,maxValue:d=1/0,minValue:h=-1/0,disableScroll:v=!0,validationState:E="valid",onBlur:b=()=>{},onKeyUp:k=()=>{},onFocus:x=()=>{},onKeyDown:H=()=>{},onFocusChange:w=()=>{},...y}=e,{inputValue:N,numberValue:V,commit:R,increment:p,decrement:D,incrementToMax:K,decrementToMin:$}=t,{focusProps:W}=ee({onBlur:()=>R()}),L=we({...c,currencySign:void 0}),A=i.useMemo(()=>isNaN(V)?"":L.format(V),[L,V]),Y=De({maxValue:d,minValue:h,textValue:A,isRequired:s,isReadOnly:u,isDisabled:g,value:V,onIncrement:p,onDecrement:D,onIncrementToMax:K,onDecrementToMin:$}),j=i.useCallback(S=>{Math.abs(S.deltaY)<=Math.abs(S.deltaX)||(S.deltaY>0?p():S.deltaY<0&&D())},[D,p]);Ve({onScroll:j,isDisabled:g||u||v},n);const f=Pe({...y,label:r,autoFocus:a,isReadOnly:u,isRequired:s,isDisabled:g,description:o,errorMessage:l,type:"text",validationState:E,defaultValue:"",value:N,autoComplete:"off",inputMode:"numeric",onBlur:b,onFocus:x,onKeyUp:k,onChange:S=>{t.setInputValue(S)},onKeyDown:H,onFocusChange:w},t,n),I=B(Y,W,f,{autoCorrect:"off"}),C=()=>{var S;document.activeElement!==n.current&&((S=n.current)==null||S.focus())},T={"aria-label":"increase",disabled:!t.canIncrement,onClick:()=>{C(),p()},onMouseDown:S=>S.preventDefault()},re={"aria-label":"decrease",disabled:!t.canDecrement,onClick:()=>{C(),D()},onMouseDown:S=>S.preventDefault()};return{inputProps:I,incrementButtonProps:T,decrementButtonProps:re}}function xe(e,t=-1/0,n=1/0){return Math.min(Math.max(e,t),n)}function M(e,t,n,r){const o=(e-(t||0))%r;let l=Math.abs(o)*2>=r?e+Math.sign(o)*(r-Math.abs(o)):e-o;t?l<t?l=t:n&&l>n&&(l=t+Math.floor((n-t)/r)*r):n&&l>n&&(l=Math.floor(n/r)*r);const c=r.toString(),a=c.indexOf("."),s=a>=0?c.length-a:0;if(s>0){const u=Math.pow(10,s);l=Math.round(l*u)/u}return l}function Te(e,t,n){const[r,o]=i.useState(e??t),l=i.useRef(e!==void 0),c=e!==void 0,a=i.useRef(r);l.current=c;const s=i.useCallback((u,...g)=>{const d=(h,...v)=>{n&&(Object.is(a.current,h)||n(h,...v)),c||(a.current=h)};typeof u=="function"?o((v,...E)=>{const b=u(c?a.current:v,...E);return d(b,...g),c?v:b}):(c||o(u),d(u,...g))},[c,n]);return c?a.current=e:e=r,[e,s]}function Fe(e){const{step:t,value:n,minValue:r,maxValue:o,isReadOnly:l,isDisabled:c,defaultValue:a,formatOptions:s,locale:u="en-US",onChange:g}=e,[d,h]=Te(n,a&&isNaN(a)?NaN:a,g),[v,E]=i.useState(()=>isNaN(d)?"":new Q(u,s).format(d)),b=i.useMemo(()=>new se(u,s),[u,s]),k=i.useMemo(()=>b.getNumberingSystem(v),[b,v]),x=i.useMemo(()=>new Q(u,{...s,numberingSystem:k}),[u,s,k]),H=i.useMemo(()=>x.resolvedOptions(),[x]),w=i.useCallback(f=>isNaN(f)||f===null?"":x.format(f),[x]);let y=t||1;H.style==="percent"&&!t&&(y=.01);const N=i.useRef(d),V=i.useRef(u),R=i.useRef(s);(!Object.is(d,N.current)||u!==V.current||s!==R.current)&&(E(w(d)),N.current=d,V.current=u,R.current=s);const p=i.useMemo(()=>b.parse(v),[b,v]),D=i.useRef(0);D.current=p;const K=()=>{if(!v.length){h(NaN),E(n===void 0?"":w(d));return}if(isNaN(D.current)){E(w(d));return}let f;t?f=M(D.current,r,o,t):f=xe(D.current,r,o),f=b.parse(w(f)),h(f),E(w(n===void 0?f:d))},$=(f,I)=>{const C=D.current;if(isNaN(C))return M(I||0,r,o,y);{const T=M(C,r,o,y);return f==="+"&&T>C||f==="-"&&T<C?T:M(q(f,C,y),r,o,y)}},W=()=>{const f=$("+",r);f===d&&E(w(f)),h(f)},L=()=>{const f=$("-",o);f===d&&E(w(f)),h(f)},A=()=>{o!=null&&h(M(o,r,o,y))},Y=()=>{r!=null&&h(r)},j=i.useMemo(()=>!c&&!l&&(isNaN(p)||!o||M(p,r,o,y)>p||q("+",p,y)<=o),[c,l,r,o,y,p]),z=i.useMemo(()=>!c&&!l&&(isNaN(p)||!r||M(p,r,o,y)<p||q("-",p,y)>=r),[c,l,r,o,y,p]);return{inputValue:v,canIncrement:j,canDecrement:z,minValue:r??-1/0,maxValue:o??1/0,numberValue:p,commit:K,validate:f=>b.isValidPartialNumber(f,r,o),increment:W,decrement:L,setInputValue:E,incrementToMax:A,decrementToMin:Y}}function q(e,t,n){let r=e==="+"?t+n:t-n;if(t%1!==0||n%1!==0){const o=t.toString().split("."),l=n.toString().split("."),c=o[1]&&o[1].length||0,a=l[1]&&l[1].length||0,s=Math.pow(10,Math.max(c,a));t=Math.round(t*s),n=Math.round(n*s),r=e==="+"?t+n:t-n,r/=s}return r}const Be=F.forwardRef((e,t)=>{const{css:n={},isErrored:r=!1,id:o=`cdg-element-${Math.random().toString(36).substring(2)}`,onUpdate:l,...c}=e,a=ae(t),s=Fe(c),{inputProps:u,incrementButtonProps:g,decrementButtonProps:d}=Me(e,s,a);return F.useEffect(()=>{l==null||l(s.inputValue,s.numberValue)},[s.numberValue,s.inputValue]),U(ce,{css:n,isErrored:!!r,isDisabled:!!u.disabled,children:[e.label&&U("label",{htmlFor:o,children:[e.label,e.isRequired&&m("span",{children:"*"})]}),U("div",{children:[m("button",{...d,children:"-"}),m("input",{...u,id:o,ref:a}),m("button",{...g,children:"+"})]}),r&&e.errorMessage&&m(X,{error:!0,children:e.errorMessage}),e.helperText&&m(X,{children:e.helperText})]})}),P=Be;P.displayName="QuantityToggle";const Le=()=>{const[e,t]=i.useState(0);return U(oe,{children:[m("h3",{children:"Controlled"}),m(P,{placeholder:"Price",label:"Potato Price",value:e,onChange:n=>t(n),formatOptions:{style:"currency",currency:"USD"},onUpdate:(n,r)=>{console.log("onUpdate value",n),console.log("onUpdate number",r)}}),m("h3",{children:"Un-Controlled"}),m(P,{label:"Potato Price",placeholder:"Price",formatOptions:{style:"currency",currency:"USD"}}),m("h3",{children:"Step values"}),m(P,{label:"Step",step:10}),m(P,{label:"Step + minValue",minValue:2,step:3}),m(P,{label:"Step + minValue + maxValue",minValue:2,maxValue:21,step:3}),m("h3",{children:"Units"}),m(P,{label:"Package width",defaultValue:4,formatOptions:{style:"unit",unit:"inch",unitDisplay:"long"}}),m(P,{label:"Transaction amount",defaultValue:45,formatOptions:{style:"currency",currency:"EUR",currencyDisplay:"code",currencySign:"accounting"}}),m("h3",{children:"Enable Scroll"}),m(P,{label:"Potato Price",placeholder:"Price",disableScroll:!1}),m("h3",{children:"Disabled"}),m(P,{label:"Disabled",isDisabled:!0,defaultValue:25}),m("h3",{children:"Read only"}),m(P,{label:"Read only",isReadOnly:!0,defaultValue:32}),m("h3",{children:"Errored"}),m(P,{label:"Errored",defaultValue:2,isErrored:!0,helperText:"Bla Bla Bla"})]})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Le as Variants};
