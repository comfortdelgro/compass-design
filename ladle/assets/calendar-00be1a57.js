import{r as f,s as T,j as t,F as A,R as H,a as P}from"./index-b2761b56.js";import{u as E,C as z,aE as m,d as W,aF as k,ab as Z,ak as _,p as K,aG as U,x as J,aH as q,ae as Q,l as M,K as R,i as X,aI as ee,aJ as w}from"./useCalendarState-aedbdc7b.js";import"./index-2520ffe2.js";import{u as ae}from"./use-dom-ref-b82bff2a.js";import{B as N}from"./button-87b4e9e7.js";let p=new Map;function re(n){let{locale:e}=E(),l=e+(n?Object.entries(n).sort((c,r)=>c[0]<r[0]?-1:1).join():"");if(p.has(l))return p.get(l);let i=new Intl.Collator(e,n);return p.set(l,i),i}function Ce(n){let e=re({usage:"search",...n}),l=f.useCallback((r,a)=>a.length===0?!0:(r=r.normalize("NFC"),a=a.normalize("NFC"),e.compare(r.slice(0,a.length),a)===0),[e]),i=f.useCallback((r,a)=>a.length===0?!0:(r=r.normalize("NFC"),a=a.normalize("NFC"),e.compare(r.slice(-a.length),a)===0),[e]),c=f.useCallback((r,a)=>{if(a.length===0)return!0;r=r.normalize("NFC"),a=a.normalize("NFC");let o=0,s=a.length;for(;o+s<=r.length;o++){let b=r.slice(o,o+s);if(e.compare(a,b)===0)return!0}return!1},[e]);return f.useMemo(()=>({startsWith:l,endsWith:i,contains:c}),[l,i,c])}const I=T("div",{display:"grid",gridTemplateColumns:"repeat(3,1fr)",marginTop:"10px"}),V=T("button",{width:"94px",height:"47.5px",backgroundColor:"transparent",border:"none",borderRadius:"$md",cursor:"pointer",fontSize:"$link3",color:"$primaryText","&:hover, &:focus-visible":{backgroundColor:"$cdgBlue100",color:"$white",fontWeight:"normal",outline:"none"},"&:disabled, &:disabled:hover":{backgroundColor:"inherit",color:"$gray50",cursor:"not-allowed"},"&.highlighted":{color:"$cdgBlue100",fontWeight:"bold"},"&.highlighted:hover":{color:"$white"}}),le=n=>{const{state:e,monthYearState:l}=n,i=(l==null?void 0:l.months)??[],c=r=>{const a=e.focusedDate;return()=>{var o;(o=e.setFocusedDate)==null||o.call(e,new z((a==null?void 0:a.year)??new Date().getFullYear(),i.indexOf(r)+1,1)),l==null||l.setMonthYearState(m.DATE)}};return t(I,{children:i.map(r=>t(V,{type:"button","aria-label":r,onClick:c(r),children:r},r))})},ne=le,oe=n=>{const{state:e,monthYearState:l,maxValue:i}=n,c=a=>{const o=e.focusedDate;return()=>{var s;(s=e.setFocusedDate)==null||s.call(e,new z(a,(o==null?void 0:o.month)??new Date().getMonth()+1,1)),l==null||l.nextState()}},r=new Date;return t(I,{children:Array.isArray(l==null?void 0:l.renderedYears)?l==null?void 0:l.renderedYears.map(a=>{const o=(()=>{var b;return i?(i==null?void 0:i.year)<a:e.minValue?((b=e.minValue)==null?void 0:b.year)>a:!1})(),s=a===r.getFullYear();return t(V,{type:"button",className:`calendar-year-cell ${o?"disabled":""} ${s?"highlighted":""}`,"aria-label":a.toString(),onClick:c(a),disabled:o,children:a},a)}):t(A,{})})},ie=oe,de=T("div",{width:"fit-content",backgroundColor:"$background",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.08)",borderRadius:"$md",padding:"$4","& .calendar-footer":{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"$2",paddingTop:"$6",marginTop:"$6",borderTop:"1px solid $gray60"},"& .calendar-footer button":{padding:"$1 $2_5",height:"$8",fontSize:"$label2"}});function te(n,e){var C,y,D,d,u,v;const l=W(n),i=k((C=e.visibleRange)==null?void 0:C.start,e.timeZone??"UTC"),c=k((y=e.visibleRange)==null?void 0:y.end,e.timeZone??"UTC");Z.set(e,{ariaLabel:n["aria-label"]??"",ariaLabelledBy:n["aria-labelledby"]??"",errorMessageId:"",selectedDateDescription:""});const r=f.useRef(!1),a=n.isDisabled||((D=e==null?void 0:e.isNextVisibleRangeInvalid)==null?void 0:D.call(e));a&&r.current&&(r.current=!1,(d=e==null?void 0:e.setFocused)==null||d.call(e,!0));const o=f.useRef(!1),s=n.isDisabled||((u=e.isPreviousVisibleRangeInvalid)==null?void 0:u.call(e));s&&o.current&&(o.current=!1,(v=e.setFocused)==null||v.call(e,!0));const b=_({id:n.id,"aria-label":[n["aria-label"],c].filter(Boolean).join(", "),"aria-labelledby":n["aria-labelledby"]});return{title:i,calendarProps:{...l,...b,role:"group","aria-describedby":n["aria-describedby"]||void 0},nextButtonProps:{onPress:()=>{var g;return(g=e.focusNextPage)==null?void 0:g.call(e)},"aria-label":"Next",isDisabled:a,onFocus:()=>r.current=!0,onBlur:()=>r.current=!1},prevButtonProps:{onPress:()=>{var g;return(g=e.focusPreviousPage)==null?void 0:g.call(e)},"aria-label":"Previous",isDisabled:s,onFocus:()=>o.current=!0,onBlur:()=>o.current=!1}}}const ce=H.forwardRef((n,e)=>{var F;const{state:l,hasFooter:i=!1,css:c={},maxValue:r=K("2999-02-17"),isDisabled:a=!1,ctaButtonRender:o,"aria-labelledby":s,"aria-describedby":b,...C}=n,{locale:y}=E(),D=ae(e),d=U({locale:y,isDisabled:a,createCalendar:J,...C,value:n.state?(F=n.state)==null?void 0:F.value:n.value}),u=q({state:d,maxValue:r}),{calendarProps:v,prevButtonProps:g,nextButtonProps:Y}=te({isDisabled:a,...C},d),{setIsReset:$}=Q(),j=()=>{var h;$||(h=n.onChange)==null||h.call(n,null),$==null||$(!0)},G=()=>{var x,B;const h=M(R());l?l==null||l.setDateValue(h):(x=d.selectDate)==null||x.call(d,h),(B=d.setFocusedDate)==null||B.call(d,h)},L=()=>{switch(u.currentState){case m.DATE:return t(w,{state:d,maxValue:r});case m.MONTH:return t(ne,{state:d,monthYearState:u,maxValue:r});case m.YEAR:return t(ie,{state:d,monthYearState:u,maxValue:r});default:return t(w,{state:d,maxValue:r})}},O=f.useMemo(()=>{const h=M(R());return X(h,C.minValue,r)},[C.minValue,r]),S=f.useCallback(()=>o||t(N,{className:"cdg-calendar-today-btn",onPress:()=>{u.setMonthYearState(m.DATE),G()},isDisabled:O,children:"Today"}),[o]);return t(A,{children:P(de,{ref:D,css:c,role:"Calendar","aria-label":"Calendar","aria-labelledby":s,"aria-describedby":b,children:[t(ee,{state:d,calendarProps:v,prevButtonProps:g,nextButtonProps:Y,middleButtonProps:u}),L(),i&&P("div",{className:"calendar-footer",children:[t(N,{className:"cdg-calendar-clear-btn",variant:"ghost",onPress:()=>{u.setMonthYearState(m.DATE),j()},children:"Clear"}),S()]})]})})}),ge=ce;export{ge as C,Ce as a,re as u};
