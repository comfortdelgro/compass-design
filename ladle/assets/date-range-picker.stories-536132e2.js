import{r as $,s as p,R as E,a as I,j as i,F as ne}from"./index-6261c28d.js";import{C as ee}from"./index-9473740a.js";import{u as le,a as re,b as ie,c as se,d as oe,D as A,P as de,e as ce}from"./useOverlayTriggerState-7518867e.js";import{a as ue,u as _,c as be,e as fe,r as me,f as ye,b as he,i as q,g as x,d as z}from"./useCalendarState-8445388c.js";import{$ as De,a as H,b as J,c as Q}from"./import-9421462e.js";import{R as ge}from"./range-calendar-891f2156.js";import{u as Pe}from"./use-dom-ref-ae33fb80.js";import{C as Ce}from"./components-2b432f73.js";import"./index-c9af7013.js";import"./button-7f388991.js";import"./utils-8bdc36e3.js";import"./useEvent-a0a7c215.js";import"./clsx.m-30223e4c.js";import"./import-527eab3c.js";import"./import-51312196.js";import"./index-cf8b885c.js";import"./index-82cc8022.js";import"./index.es-21a0a2c6.js";function Se(e,l,c){var t,s;const{labelProps:u,fieldProps:b,descriptionProps:D,errorMessageProps:a}=le({...e,labelElementType:"span"}),o=b["aria-labelledby"]||b.id,{locale:g}=De(),f=l.formatValue(g,{month:"long"}),m=f?`selectedRangeDescription ${f.start} ${f.end}`:"",d=ue(m),r={"aria-label":"startDate","aria-labelledby":o},P={"aria-label":"endDate","aria-labelledby":o},n=_(),T=_(),F=re(l,c),C=[d["aria-describedby"],b["aria-describedby"]].filter(Boolean).join(" ")||void 0,O=$.useMemo(()=>be(c,{accept:y=>y.id!==n}),[c,n]),V={[fe]:O,[me]:"presentation","aria-describedby":C,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:l.validationState},v=ye(e),{focusWithinProps:R}=ie({...e,isDisabled:l.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...v,...F,...b,...d,...R,role:"group","aria-disabled":e.isDisabled||null,"aria-describedby":C,onKeyDown(y){l.isOpen||e.onKeyDown&&e.onKeyDown(y)},onKeyUp(y){l.isOpen||e.onKeyUp&&e.onKeyUp(y)}},labelProps:{...u,onClick:()=>{O.focusFirst()}},buttonProps:{...d,id:n,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${o} ${n}`,"aria-describedby":C,"aria-expanded":l.isOpen||void 0,onPress:()=>l.setOpen(!0)},dialogProps:{id:T,"aria-labelledby":`${o} ${n}`},startFieldProps:{...r,...V,value:(t=l.value)==null?void 0:t.start,onChange:y=>l.setDateTime("start",y),autoFocus:e.autoFocus},endFieldProps:{...P,...V,value:(s=l.value)==null?void 0:s.end,onChange:y=>l.setDateTime("end",y)},descriptionProps:D,errorMessageProps:a,calendarProps:{autoFocus:!0,value:l.dateRange,onChange:l.setDateRange,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,allowsNonContiguousRanges:e.allowsNonContiguousRanges,defaultFocusedValue:l.dateRange?void 0:e.placeholderValue,validationState:l.validationState,errorMessage:e.errorMessage}}}function Fe(e){var v,R;const l=se(e),[c,u]=he(e.value,e.defaultValue||null,e.onChange);let[b,D]=$.useState(()=>c||{start:null,end:null});c==null&&b.start&&b.end&&(b={start:null,end:null},D(b));const a=c||b,o=t=>{D(t),t!=null&&t.start&&t.end?u(t):u(null)},g=(a==null?void 0:a.start)||(a==null?void 0:a.end)||e.placeholderValue,[f]=oe(g,e.granularity),m=f==="hour"||f==="minute"||f==="second",d=e.shouldCloseOnSelect??!0;let[r,P]=$.useState(null),[n,T]=$.useState(null);a&&a.start&&a.end&&(r=a,"hour"in a.start&&(n=a));const F=(t,s)=>{o({start:"timeZone"in s.start?s.start.set(J(t.start)):Q(t.start,s.start),end:"timeZone"in s.end?s.end.set(J(t.end)):Q(t.end,s.end)}),P(null),T(null)},C=t=>{let s=typeof d=="function"?d():d;m?s||t.start&&t.end&&(n!=null&&n.start)&&(n!=null&&n.end)?F(t,{start:(n==null?void 0:n.start)||x(e.placeholderValue),end:(n==null?void 0:n.end)||x(e.placeholderValue)}):P(t):t.start&&t.end?o(t):P(t),s&&l.setOpen(!1)},O=t=>{r!=null&&r.start&&(r!=null&&r.end)&&t.start&&t.end?F(r,t):T(t)},V=e.validationState||(a!=null&&(q(a.start,e.minValue,e.maxValue)||q(a.end,e.minValue,e.maxValue)||a.end!=null&&a.start!=null&&a.end.compare(a.start)<0||a!=null&&a.start&&((v=e.isDateUnavailable)!=null&&v.call(e,a.start))||a!=null&&a.end&&((R=e.isDateUnavailable)!=null&&R.call(e,a.end)))?"invalid":null);return{value:a,setValue:o,dateRange:r,timeRange:n,granularity:f,hasTime:m,setDate(t,s){C({...r,[t]:s})},setTime(t,s){O({...n,[t]:s})},setDateTime(t,s){o({...a,[t]:s})},setDateRange:C,setTimeRange:O,...l,setOpen(t){!t&&!(a!=null&&a.start&&(a!=null&&a.end))&&(r!=null&&r.start)&&(r!=null&&r.end)&&m&&F(r,{start:(n==null?void 0:n.start)||x(e.placeholderValue),end:(n==null?void 0:n.end)||x(e.placeholderValue)}),l.setOpen(t)},validationState:V,formatValue(t,s){if(!a||!a.start||!a.end)return null;const y="timeZone"in a.start?a.start.timeZone:void 0,B=e.granularity||(a.start&&"minute"in a.start?"minute":"day"),w="timeZone"in a.end?a.end.timeZone:void 0,W=e.granularity||(a.end&&"minute"in a.end?"minute":"day"),te=z(s,{granularity:B,timeZone:y??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:a.start.calendar.identifier==="gregory"&&a.start.era==="BC"||a.end.calendar.identifier==="gregory"&&a.end.era==="BC"}),K=a.start.toDate(y||"UTC"),N=a.end.toDate(w||"UTC"),Z=new H(t,te);let k;if(y===w&&B===W&&a.start.compare(a.end)!==0){try{const S=Z.formatRangeToParts(K,N);let L=-1;for(let h=0;h<S.length;h++){const U=S[h];if(U.source==="shared"&&U.type==="literal")L=h;else if(U.source==="endRange")break}let G="",j="";for(let h=0;h<S.length;h++)h<L?G+=S[h].value:h>L&&(j+=S[h].value);return{start:G,end:j}}catch{}k=Z}else{const S=z(s,{granularity:W,timeZone:w??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24});k=new H(t,S)}return{start:Z.format(K),end:k.format(N)}}}}const Oe=p("div",{width:"fit-content"}),Ve=p("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),Te=E.forwardRef((e,l)=>{const{startDateLabel:c,endDateLabel:u,shouldCloseOnSelect:b=!1,css:D={},onApply:a,onCancel:o,errorMessage:g,helperText:f,...m}=e,d=Fe({...m,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:e.shouldCloseOnSelect??!1}),r=Pe(l),{labelProps:P,groupProps:n,startFieldProps:T,endFieldProps:F,buttonProps:C,dialogProps:O,calendarProps:V}=Se({...m,isReadOnly:e.isReadOnly?!0:!!e.isMobile,"aria-label":"date range picker","aria-describedby":""},d,r),v={necessityIndicator:e.necessityIndicator,...T},R={necessityIndicator:e.necessityIndicator,...F},t=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return V.isReadOnly=t(),I(Oe,{ref:r,css:D,children:[i(ve,{state:d,label:e.label,labelProps:P,groupProps:n,startFieldProps:v,endFieldProps:R,buttonProps:C,startDateLabel:c,endDateLabel:u,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,errorMessage:g,helperText:f}),i(Re,{state:d,onApply:a,onCancel:o,calendarRef:r,dialogProps:O,calendarProps:V,css:e.calendarCSS})]})}),ve=E.forwardRef((e,l)=>{const{label:c,labelProps:u,groupProps:b,startFieldProps:D,endFieldProps:a,buttonProps:o,startDateLabel:g,endDateLabel:f,isInvalid:m,isMobile:d,isReadOnly:r=!1,errorMessage:P,helperText:n}=e;return I(Ve,{children:[i("span",{...u,className:"date-range-label",children:c}),i("div",{...b,ref:l,className:"date-range-inputs-body",children:I("div",{className:"date-range-fields",children:[i(A,{...D,label:g,buttonProps:o,isInvalid:m,isMobile:d,isReadOnly:r,errorMessage:P,helperText:n}),i(A,{...a,label:f,buttonProps:o,isInvalid:m,isMobile:d,isReadOnly:r})]})})]})}),Re=e=>{const{state:l,calendarRef:c,dialogProps:u,calendarProps:b,css:D={},onApply:a,onCancel:o}=e,{value:g,onChange:f,...m}=b,d=r=>{f&&f(r)};return i(ne,{children:l.isOpen&&i(de,{state:l,triggerRef:c,placement:"bottom start",offset:8,children:i(ce,{...u,"aria-describedby":u["aria-describedby"]??"","aria-label":u["aria-label"]??"","aria-labelledby":u["aria-labelledby"]??"",children:i(ge,{css:D,state:l,hasFooter:!0,onApplyCallback:a,onCancelCallback:o,"aria-label":"","aria-labelledby":"",...g?{value:g}:{},onChange:d,...m})})})})},M=Te,{I18nProvider:ae,useDateFormatter:Ie}=ee.I18N,{getLocalTimeZone:X,parseDate:Y}=ee.InternationalizedDate,ze=()=>i(ae,{locale:"en-SG",children:I(Ce,{children:[i("h3",{children:"Basic"}),i(M,{startDateLabel:"Start date",endDateLabel:"End date"}),i("br",{}),i("h3",{children:"Disabled"}),i(M,{isDisabled:!0,startDateLabel:"Start date",endDateLabel:"End date"}),i("h3",{children:"Invalid"}),i(M,{isInvalid:!0,startDateLabel:"Start date",endDateLabel:"End date"})]})}),He=()=>{const[e,l]=E.useState({start:Y("2020-02-03"),end:Y("2020-02-08")}),c=Ie({dateStyle:"long"});return I(ae,{locale:"en-SG",children:[i("h3",{children:"Controlled"}),e&&c.formatRange(e.start.toDate(X()),e.end.toDate(X())),i(M,{value:e,onChange:u=>l(u)})]})},Je={decorators:[e=>I("div",{children:[i("style",{dangerouslySetInnerHTML:{__html:".ladle-main { background: #eee; }"}}),i(e,{})]})]};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{He as Controlled,ze as Variants,Je as default};
