import{s as Z,j as i,a as j,r as f,F as te,R as X}from"./index-66ea3676.js";import"./index-8280f91b.js";import{o as De,p as $e,q as Oe,r as He,s as Fe,t as Ve,u as We,v as Be,w as Ne,x as Pe}from"./index-5bcd9fe0.js";import{l as be}from"./lodash-e911ed84.js";import{B as q}from"./index-be72d793.js";import{I as we}from"./index-d0987ce1.js";import{T as je}from"./index-d98966db.js";import"./index.es-15f633db.js";import{S as Ze}from"./index-97426d94.js";import{B as S}from"./button-912db37c.js";import{u as Ke}from"./useColors-6b94a198.js";import"./use-dom-ref-dc5008e6.js";import"./keyframes-8964ea8c.js";const Te=84,p=55;var s=(e=>(e[e.zoomIn=1]="zoomIn",e[e.zoomOut=2]="zoomOut",e[e.prev=3]="prev",e[e.next=4]="next",e[e.rotateLeft=5]="rotateLeft",e[e.rotateRight=6]="rotateRight",e[e.reset=7]="reset",e[e.close=8]="close",e[e.scaleX=9]="scaleX",e[e.scaleY=10]="scaleY",e))(s||{});const Ge=Z("div",{appearance:"none",border:"none",boxSizing:"border-box",margin:"0px",zIndex:"51",backgroundColor:"rgba(0, 0, 0, 0.6)",position:"fixed",top:0,left:0,overflow:"hidden",width:"100vw",height:"100vh"}),Ue=Z("div",{zIndex:"52",position:"fixed",marginBottom:20,top:20,left:0,display:"flex",flexDirection:"row",width:"100vw",alignItems:"center",justifyContent:"center"}),_e=Z("div",{zIndex:"52",position:"fixed",bottom:60,left:0,display:"flex",width:"100vw",alignItems:"center",justifyContent:"center"}),qe=Z("div",{display:"flex",width:"100vw",alignItems:"center",justifyContent:"center"}),Ae=Z("div",{zIndex:52,position:"fixed",height:50,bottom:0,left:0,display:"flex",alignItems:"center",justifyContent:"center",width:"100vw"}),Je=Z("button",{background:"none",border:"none",cursor:"pointer",padding:0,zIndex:53,height:50,marginBottom:10,img:{width:"60px",height:"50px",opacity:.5,marginRight:2,marginLeft:2,borderRadius:4},".active":{opacity:1,border:"2px solid $cdgBlue80"}});var h=(e=>(e.setVisible="setVisible",e.setActiveIndex="setActiveIndex",e.update="update",e.clear="clear",e))(h||{});function Qe(e){return i(_e,{children:j(je.Label,{css:{textAlign:"center"},variant:"label1",children:[e.alt&&`${e.alt} `,`(${e.width} x ${e.height}) `,i("b",{children:`${e.activeIndex+1} ${e.totalName} ${e.count}`})]})})}function pe(e){const l=f.useRef(!1),m=f.useRef({x:0,y:0}),[r,d]=f.useState({x:0,y:0});f.useEffect(()=>()=>{E(!0),H(!0)},[]),f.useEffect(()=>(H(),()=>{H(!0)})),f.useEffect(()=>(e.visible&&e.drag&&E(),!e.visible&&e.drag&&O(),()=>{E(!0)}),[e.drag,e.visible]),f.useEffect(()=>{const c=r.x-m.current.x,I=r.y-m.current.y;m.current={x:r.x,y:r.y},e.onChangeImgState(e.width,e.height,e.top+I,e.left+c)},[r]);function g(){e.onResize()}function K(c){e.onCanvasMouseDown(c),$(c)}function $(c){c.button===0&&(!e.visible||!e.drag||(c.preventDefault(),c.stopPropagation(),l.current=!0,m.current={x:c.nativeEvent.clientX,y:c.nativeEvent.clientY}))}const T=c=>{l.current&&d({x:c.clientX,y:c.clientY})};function O(){l.current=!1}function H(c){let I="addEventListener";c&&(I="removeEventListener"),window[I]("resize",g,!1)}function E(c){let I="addEventListener";c&&(I="removeEventListener"),document[I]("click",O,!1),document[I]("mousemove",T,!1)}const F={width:`${e.width}px`,height:`${e.height}px`,transform:`translateX(${e.left!==null?`${e.left}px`:"aoto"}) translateY(${e.top}px)
    rotate(${e.rotate}deg) scaleX(${e.scaleX}) scaleY(${e.scaleY})`};let M=null;return e.imgSrc!==""&&(M=i("img",{src:e.imgSrc,style:F,onMouseDown:$})),e.loading&&(M=i(q,{css:{display:"flex",height:`${window.innerHeight-84}px`,justifyContent:"center",alignItems:"center"},children:i(Ze,{size:"2xl"})})),i(q,{onMouseDown:K,css:{zIndex:e.zIndex},children:M})}function et(e){const{activeIndex:l=0}=e;function m(r){l!==r&&e.onChangeImg(r)}return i(Ae,{children:e.images.map((r,d)=>i(Je,{onClick:()=>{m(d)},children:i("img",{className:d===l?"active":"",src:(r==null?void 0:r.srcPreview)??r.src,alt:r.alt})},d))})}const tt=[{key:"zoomIn",actionType:s.zoomIn,icon:De},{key:"reset",actionType:s.reset,icon:$e},{key:"zoomOut",actionType:s.zoomOut,icon:Oe},{key:"prev",actionType:s.prev,icon:He},{key:"next",actionType:s.next,icon:Fe},{key:"rotateLeft",actionType:s.rotateLeft,icon:Ve},{key:"rotateRight",actionType:s.rotateRight,icon:We},{key:"scaleX",actionType:s.scaleX,icon:Be},{key:"scaleY",actionType:s.scaleY,icon:Ne}];function ee(e,l){return e.filter(r=>l.indexOf(r.key)<0)}function at(e){function l(g){e.onAction(g)}const m=Ke();function r(g){return i(S,{variant:"ghost",onClick:()=>{l(g)},"data-key":g.key,css:{"&:hover":{background:"$cdgBlue100 !important"}},children:g.icon?i(we,{icon:g.icon,color:m.white}):i(te,{children:g.key})},g.key)}let d=e.toolbars;return e.zoomable||(d=ee(d,["zoomIn","zoomOut","reset"])),e.changeable||(d=ee(d,["prev","next"])),e.rotatable||(d=ee(d,["rotateLeft","rotateRight"])),e.scalable||(d=ee(d,["scaleX","scaleY"])),i(Ue,{children:i(qe,{children:d.map(g=>r(g))})})}function w(e,l){return{type:e,payload:l||{}}}const it=e=>{var ge;const{visible:l=!1,onClose:m=be.noop,images:r=[],activeIndex:d=0,drag:g=!0,zoomable:K=!0,rotatable:$=!0,scalable:T=!0,onMaskClick:O=be.noop,changeable:H=!0,customToolbar:E=t=>t,zoomSpeed:F=.05,disableKeyboardSupport:M=!1,noResetZoomAfterChange:c=!1,noLimitInitializationSize:I=!1,defaultScale:N=1,loop:Ie=!0,disableMouseZoom:xe=!1,isShowImageInformation:ye=!0,isShowToolbar:Se=!0,isShowPreview:Ce=!0,totalName:ke="of",minScale:A=.1}=e,ze={index:0,visible:!1,activeIndex:e.activeIndex??0,width:0,height:0,top:15,left:0,rotate:0,imageWidth:0,imageHeight:0,scaleX:N,scaleY:N,loading:!1,loadFailed:!1,startLoading:!1};function ae(){let t=window.innerWidth,o=window.innerHeight;return e.container&&(t=e.container.offsetWidth,o=e.container.offsetHeight),{width:t,height:o}}const x=f.useRef(ae()),J=Te;function Re(t,o){switch(o.type){case h.setVisible:return{...t,visible:!!o.payload.visible};case h.setActiveIndex:return{...t,activeIndex:Number(o.payload.index),startLoading:!0};case h.update:return{...t,...o.payload};case h.clear:return{...t,width:0,height:0,scaleX:N,scaleY:N,rotate:1,imageWidth:0,imageHeight:0,loadFailed:!1,top:0,left:0,loading:!1}}return t}const G=f.useRef(null),U=f.useRef(!1),se=f.useRef(0),[a,b]=f.useReducer(Re,ze);f.useEffect(()=>(U.current=!0,()=>{U.current=!1}),[]),f.useEffect(()=>{x.current=ae()},[e.container]),f.useEffect(()=>{l&&U.current&&b(w(h.setVisible,{visible:!0}))},[l]),f.useEffect(()=>(M||document.addEventListener("keydown",ue,!0),G.current&&G.current.addEventListener("wheel",he,!1),()=>{document.removeEventListener("keydown",ue,!0),G.current&&G.current.removeEventListener("wheel",he,!1)})),f.useEffect(()=>{l&&b(w(h.setActiveIndex,{index:d}))},[d,l,r]);function ie(t,o=!1){b(w(h.update,{loading:!0,loadFailed:!1}));let n={src:"",alt:""};r.length>0&&(n=r[t]);let u=!1;const v=new Image;v.onload=()=>{U.current&&(u||y(v.width,v.height,!0))},v.onerror=()=>{if(U.current)if(e.defaultImg){b(w(h.update,{loading:!1,loadFailed:!0,startLoading:!1}));const P=e.defaultImg.width||x.current.width*.5,D=e.defaultImg.height||x.current.height*.5;y(P,D,!1)}else b(w(h.update,{loading:!1,loadFailed:!1,startLoading:!1}))},v.src=n.src,v.complete&&(u=!0,y(v.width,v.height,!0));function y(P,D,_){if(t!==se.current)return;let W=P,B=D;e.defaultSize&&(W=e.defaultSize.width,B=e.defaultSize.height),n.defaultSize&&(W=n.defaultSize.width,B=n.defaultSize.height);const[C,k]=ce(W,B),z=(x.current.width-C)/2,R=(x.current.height-k-J)/2;let me=N,ve=N;c&&!o&&(me=a.scaleX,ve=a.scaleY),b(w(h.update,{width:C,height:k,left:z,top:R,imageWidth:P,imageHeight:D,loading:!1,rotate:0,scaleX:me,scaleY:ve,loadFailed:!_,startLoading:!1}))}}f.useEffect(()=>{a.startLoading&&(se.current=a.activeIndex,ie(a.activeIndex))},[a.startLoading,a.activeIndex]);function ce(t,o){let n=0,u=0;const v=x.current.width*.8,y=(x.current.height-J)*.8;return n=Math.min(v,t),u=n/t*o,u>y&&(u=y,n=u/o*t),I&&(n=t,u=o),[n,u]}function ne(t){if(!(!Ie&&(t>=r.length||t<0))&&(t>=r.length&&(t=0),t<0&&(t=r.length-1),t!==a.activeIndex)){if(e.onChange){const o=oe(t);e.onChange(o,t)}b(w(h.setActiveIndex,{index:t}))}}function oe(t){let o={src:"",alt:""},n=null;return t!==void 0?n=t:n=a.activeIndex,r.length>0&&n>=0&&(o=r[n]),o}function Xe(t){b(w(h.update,{scaleX:a.scaleX*t}))}function Ye(t){b(w(h.update,{scaleY:a.scaleY*t}))}function de(t=!1){b(w(h.update,{rotate:a.rotate+90*(t?1:-1)}))}function V(t){switch(t){case s.prev:ne(a.activeIndex-1);break;case s.next:ne(a.activeIndex+1);break;case s.zoomIn:const o=le();re(o.x,o.y,1,F);break;case s.zoomOut:const n=le();re(n.x,n.y,-1,F);break;case s.rotateLeft:de();break;case s.rotateRight:de(!0);break;case s.reset:ie(a.activeIndex,!0);break;case s.scaleX:Xe(-1);break;case s.scaleY:Ye(-1);break}}function fe(t){if(V(t.actionType),t.onClick){const o=oe();t.onClick(o)}}function Le(t,o,n,u){b(w(h.update,{width:t,height:o,top:n,left:u}))}function Ee(){if(x.current=ae(),l){const t=(x.current.width-a.width)/2,o=(x.current.height-a.height-J)/2;b(w(h.update,{left:t,top:o}))}}function Me(t){O(t)}function ue(t){const o=t.keyCode||t.which||t.charCode;let n=!1;switch(o){case 27:m(),n=!0;break;case 37:t.ctrlKey?V(s.rotateLeft):V(s.prev),n=!0;break;case 39:t.ctrlKey?V(s.rotateRight):V(s.next),n=!0;break;case 38:V(s.zoomIn),n=!0;break;case 40:V(s.zoomOut),n=!0;break;case 49:t.ctrlKey&&(ie(a.activeIndex),n=!0);break}n&&(t.preventDefault(),t.stopPropagation())}function he(t){if(xe||a.loading)return;t.preventDefault();let o=0;const n=t.deltaY;if(n===0?o=0:o=n>0?-1:1,o!==0){let u=t.clientX,v=t.clientY;if(e.container){const y=e.container.getBoundingClientRect();u-=y.left,v-=y.top}re(u,v,o,F)}}function le(){return{x:a.left+a.width/2,y:a.top+a.height/2}}function re(t,o,n,u){const v=le(),y=t-v.x,P=o-v.y;let D=0,_=0,W=0,B=0,C=0,k=0;if(a.width===0){const[z,R]=ce(a.imageWidth,a.imageHeight);_=(x.current.width-z)/2,D=(x.current.height-J-R)/2,W=a.width+z,B=a.height+R,C=k=1}else{const z=a.scaleX>0?1:-1,R=a.scaleY>0?1:-1;C=a.scaleX+u*n*z,k=a.scaleY+u*n*R,typeof e.maxScale<"u"&&(Math.abs(C)>e.maxScale&&(C=e.maxScale*z),Math.abs(k)>e.maxScale&&(k=e.maxScale*R)),Math.abs(C)<A&&(C=A*z),Math.abs(k)<A&&(k=A*R),D=a.top+-n*P/a.scaleX*u*z,_=a.left+-n*y/a.scaleY*u*R,W=a.width,B=a.height}b(w(h.update,{width:W,scaleX:C,scaleY:k,height:B,top:D,left:_,loading:!1}))}let Q={src:"",alt:""};return l&&a.visible&&!a.loading&&a.activeIndex!==null&&!a.startLoading&&(Q=oe()),i(te,{children:l&&j(Ge,{children:[e.noClose||i(S,{variant:"primary",css:{right:15,top:10,width:32,display:"flex",padding:"5px 0",borderRadius:16,position:"absolute",zIndex:p+5},onClick:m,children:i(we,{icon:Pe,color:"white"})}),j(q,{onTransitionEnd:()=>{l||b(w(h.setVisible,{visible:!1}))},ref:G,children:[i(q,{css:{zIndex:p}}),i(pe,{imgSrc:a.loadFailed&&((ge=e==null?void 0:e.defaultImg)==null?void 0:ge.src)||Q.src,visible:l,width:a.width,height:a.height,top:a.top,left:a.left,rotate:a.rotate,onChangeImgState:Le,onResize:Ee,zIndex:p+5,scaleX:a.scaleX,scaleY:a.scaleY,loading:a.loading,drag:g,container:e.container,onCanvasMouseDown:Me}),j(q,{css:{zIndex:p+5},children:[Se&&i(at,{onAction:fe,zoomable:K,rotatable:$,scalable:T,changeable:H,toolbars:E(tt)}),ye&&i(Qe,{onAction:fe,alt:Q.alt??"",width:a.imageWidth,height:a.imageHeight,activeIndex:a.activeIndex,count:r.length,totalName:ke}),Ce&&i(et,{images:e.images,activeIndex:a.activeIndex,onChangeImg:ne})]})]})]})})},Y=e=>{const[l,m]=f.useState(!1);return f.useEffect(()=>{e.visible&&!l&&m(!0)},[e.visible,l]),l?i(it,{...e}):null},L=Array.from(Array(8).keys()).map(e=>({src:`https://picsum.photos/id/${e+1}/5000/3333`,alt:`Image ${e+1}`,srcPreview:`https://picsum.photos/id/${e+1}/60/50`})),bt=()=>{const[e,l]=X.useState(!1);return j(te,{children:[i("h3",{children:"Default "}),i(S,{onClick:()=>l(!0),children:"Open image viewer"}),i(Y,{visible:e,onClose:()=>{l(!1)},images:L,onMaskClick:()=>{l(!1)}})]})},wt=()=>{const[e,l]=X.useState(!1),[m,r]=X.useState(!1),[d,g]=X.useState(!1),[K,$]=X.useState(!1),[T,O]=X.useState(!1),[H,E]=X.useState(!1),[F,M]=X.useState(!1),[c,I]=X.useState(!1);return j(te,{children:[i("h3",{children:"Active index"}),i(S,{onClick:()=>l(!0),children:"Open image viewer"}),i(Y,{visible:e,activeIndex:1,onClose:()=>{l(!1)},images:L}),i("h3",{children:"Disable drag"}),i(S,{onClick:()=>r(!0),children:"Open image viewer"}),i(Y,{visible:m,drag:!1,onClose:()=>{r(!1)},images:L}),i("h3",{children:"Disable zoomable"}),i(S,{onClick:()=>g(!0),children:"Open image viewer"}),i(Y,{visible:d,zoomable:!1,onClose:()=>{g(!1)},images:L}),i("h3",{children:"Disable rotatable"}),i(S,{onClick:()=>$(!0),children:"Open image viewer"}),i(Y,{visible:K,zoomable:!1,disableMouseZoom:!0,onClose:()=>{$(!1)},images:L}),i("h3",{children:"Disable scalable"}),i(S,{onClick:()=>O(!0),children:"Open image viewer"}),i(Y,{visible:T,scalable:!1,onClose:()=>{O(!1)},images:L}),i("h3",{children:"Hidden image information"}),i(S,{onClick:()=>E(!0),children:"Open image viewer"}),i(Y,{visible:H,isShowImageInformation:!1,onClose:()=>{E(!1)},images:L}),i("h3",{children:"Hidden preview"}),i(S,{onClick:()=>M(!0),children:"Open image viewer"}),i(Y,{visible:F,isShowPreview:!1,onClose:()=>{M(!1)},images:L}),i("h3",{children:"Hidden toolbar"}),i(S,{onClick:()=>I(!0),children:"Open image viewer"}),i(Y,{visible:c,isShowToolbar:!1,onClose:()=>{I(!1)},images:L})]})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{bt as Default,wt as Variants};
