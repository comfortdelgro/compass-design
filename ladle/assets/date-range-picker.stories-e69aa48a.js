import{r as I,s as p,R as E,j as r,a as x,F as ne}from"./index-6668e921.js";import{C as ee}from"./index-475ed52b.js";import{$ as le,a as _,b as q,c as z,d as re}from"./import-a63e98a2.js";import{u as ie,a as se,b as de,c as oe,d as ce,D as A,P as ue,e as be}from"./useOverlayTriggerState-ee6a69fa.js";import{u as fe,a as H,c as me,f as ye,r as he,b as De,d as ge,i as J,g as $,e as Q,D as Pe}from"./useCalendarState-b290a66b.js";import{R as Ce}from"./range-calendar-f07bdec3.js";import{u as ve}from"./use-dom-ref-8557f905.js";import{C as Se}from"./components-e6188d90.js";import"./index-48e7f10a.js";import"./button-1ed1cc71.js";import"./clsx.m-30223e4c.js";import"./utils-fbf423a9.js";import"./isTypedArray-f1ce1748.js";import"./isArray-f575a7ef.js";import"./useEvent-91490201.js";import"./import-897563d4.js";import"./import-304c5527.js";import"./index-c774b727.js";import"./index-dfdc573b.js";import"./index.es-1b5ffb91.js";function Fe(e,n,b){var t,i;const{labelProps:o,fieldProps:c,descriptionProps:D,errorMessageProps:a}=ie({...e,labelElementType:"span"}),d=c["aria-labelledby"]||c.id,{locale:g}=le(),f=n.formatValue(g,{month:"long"}),m=f?`selectedRangeDescription ${f.start} ${f.end}`:"",u=fe(m),s={"aria-label":"startDate","aria-labelledby":d},P={"aria-label":"endDate","aria-labelledby":d},l=H(),V=H(),F=se(n,b),C=[u["aria-describedby"],c["aria-describedby"]].filter(Boolean).join(" ")||void 0,v=I.useMemo(()=>me(b,{accept:y=>y.id!==l}),[b,l]),O={[ye]:v,[he]:"presentation","aria-describedby":C,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:n.validationState},R=De(e),{focusWithinProps:T}=de({...e,isDisabled:n.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...R,...F,...c,...u,...T,role:"group","aria-disabled":e.isDisabled||null,"aria-describedby":C,onKeyDown(y){n.isOpen||e.onKeyDown&&e.onKeyDown(y)},onKeyUp(y){n.isOpen||e.onKeyUp&&e.onKeyUp(y)}},labelProps:{...o,onClick:()=>{v.focusFirst()}},buttonProps:{...u,id:l,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${d} ${l}`,"aria-describedby":C,"aria-expanded":n.isOpen||void 0,onPress:()=>n.setOpen(!0)},dialogProps:{id:V,"aria-labelledby":`${d} ${l}`},startFieldProps:{...s,...O,value:(t=n.value)==null?void 0:t.start,onChange:y=>n.setDateTime("start",y),autoFocus:e.autoFocus},endFieldProps:{...P,...O,value:(i=n.value)==null?void 0:i.end,onChange:y=>n.setDateTime("end",y)},descriptionProps:D,errorMessageProps:a,calendarProps:{autoFocus:!0,value:n.dateRange,onChange:n.setDateRange,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,allowsNonContiguousRanges:e.allowsNonContiguousRanges,defaultFocusedValue:n.dateRange?void 0:e.placeholderValue,validationState:n.validationState,errorMessage:e.errorMessage}}}function Ve(e){var R,T;const n=oe(e),[b,o]=ge(e.value,e.defaultValue||null,e.onChange);let[c,D]=I.useState(()=>b||{start:null,end:null});b==null&&c.start&&c.end&&(c={start:null,end:null},D(c));const a=b||c,d=t=>{D(t),t.start&&t.end?o(t):o(null)},g=a.start||a.end||e.placeholderValue,[f]=ce(g,e.granularity),m=f==="hour"||f==="minute"||f==="second",u=e.shouldCloseOnSelect??!0;let[s,P]=I.useState(null),[l,V]=I.useState(null);a&&a.start&&a.end&&(s=a,"hour"in a.start&&(l=a));const F=(t,i)=>{d({start:"timeZone"in i.start?i.start.set(q(t.start)):z(t.start,i.start),end:"timeZone"in i.end?i.end.set(q(t.end)):z(t.end,i.end)}),P(null),V(null)},C=t=>{let i=typeof u=="function"?u():u;m?i||t.start&&t.end&&(l!=null&&l.start)&&l.end?F(t,{start:(l==null?void 0:l.start)||$(e.placeholderValue),end:(l==null?void 0:l.end)||$(e.placeholderValue)}):P(t):t.start&&t.end?d(t):!t.start||!t.end?(o(null),P(null)):P(t),i&&n.setOpen(!1)},v=t=>{s!=null&&s.start&&s.end&&t.start&&t.end?F(s,t):V(t)},O=e.validationState||(a!=null&&(J(a.start,e.minValue,e.maxValue)||J(a.end,e.minValue,e.maxValue)||a.end!=null&&a.start!=null&&a.end.compare(a.start)<0||a.start&&((R=e.isDateUnavailable)!=null&&R.call(e,a.start))||a.end&&((T=e.isDateUnavailable)!=null&&T.call(e,a.end)))?"invalid":null);return{value:a,setValue:d,dateRange:s,timeRange:l,granularity:f,hasTime:m,setDate(t,i){C({...s,[t]:i})},setTime(t,i){v({...l,[t]:i})},setDateTime(t,i){d({...a,[t]:i})},setDateRange:C,setTimeRange:v,...n,setOpen(t){!t&&!(a.start&&a.end)&&(s!=null&&s.start)&&s.end&&m&&F(s,{start:(l==null?void 0:l.start)||$(e.placeholderValue),end:(l==null?void 0:l.end)||$(e.placeholderValue)}),n.setOpen(t)},validationState:O,formatValue(t,i){if(!a||!a.start||!a.end)return null;const y="timeZone"in a.start?a.start.timeZone:void 0,B=e.granularity||(a.start&&"minute"in a.start?"minute":"day"),w="timeZone"in a.end?a.end.timeZone:void 0,W=e.granularity||(a.end&&"minute"in a.end?"minute":"day"),te=Q(i,{granularity:B,timeZone:y??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:a.start.calendar.identifier==="gregory"&&a.start.era==="BC"||a.end.calendar.identifier==="gregory"&&a.end.era==="BC"}),K=a.start.toDate(y||"UTC"),N=a.end.toDate(w||"UTC"),Z=new _(t,te);let k;if(y===w&&B===W&&a.start.compare(a.end)!==0){try{const S=Z.formatRangeToParts(K,N);let L=-1;for(let h=0;h<S.length;h++){const U=S[h];if(U.source==="shared"&&U.type==="literal")L=h;else if(U.source==="endRange")break}let G="",j="";for(let h=0;h<S.length;h++)h<L?G+=S[h].value:h>L&&(j+=S[h].value);return{start:G,end:j}}catch{}k=Z}else{const S=Q(i,{granularity:W,timeZone:w??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24});k=new _(t,S)}return{start:Z.format(K),end:k.format(N)}}}}const Oe=p("div",{width:"fit-content"}),Re=p("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),Te=E.forwardRef((e,n)=>{const{startDateLabel:b,endDateLabel:o,shouldCloseOnSelect:c=!1,css:D={},errorMessage:a,helperText:d,maxValue:g,...f}=e,m=Ve({...f,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:c??!1}),u=ve(n),{labelProps:s,groupProps:P,startFieldProps:l,endFieldProps:V,buttonProps:F,dialogProps:C,calendarProps:v}=Fe({...f,isReadOnly:e.isReadOnly?!0:!!e.isMobile,"aria-label":"date range picker","aria-describedby":""},m,u),O={necessityIndicator:e.necessityIndicator,...l},R={necessityIndicator:e.necessityIndicator,...V},T=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return v.isReadOnly=T(),r(Oe,{ref:u,css:D,children:x(Pe,{children:[r(xe,{state:m,label:e.label,labelProps:s,groupProps:P,startFieldProps:O,endFieldProps:R,buttonProps:F,startDateLabel:b,endDateLabel:o,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,errorMessage:a,helperText:d}),r($e,{maxValue:g,state:m,calendarRef:u,dialogProps:C,calendarProps:v,css:e.calendarCSS})]})})}),xe=E.forwardRef((e,n)=>{const{label:b,labelProps:o,groupProps:c,startFieldProps:D,endFieldProps:a,buttonProps:d,startDateLabel:g,endDateLabel:f,isInvalid:m,isMobile:u,isReadOnly:s=!1,errorMessage:P,helperText:l}=e;return x(Re,{children:[r("span",{...o,className:"date-range-label",children:b}),r("div",{...c,ref:n,className:"date-range-inputs-body",children:x("div",{className:"date-range-fields",children:[r(A,{...D,label:g,buttonProps:d,isInvalid:m,isMobile:u,isReadOnly:s,errorMessage:P,helperText:l}),r(A,{...a,label:f,buttonProps:d,isInvalid:m,isMobile:u,isReadOnly:s})]})})]})}),$e=e=>{const{state:n,calendarRef:b,dialogProps:o,calendarProps:c,css:D={},maxValue:a=re("2999-03-10")}=e,{value:d,onChange:g,...f}=c,m=u=>{g&&g(u)};return r(ne,{children:n.isOpen&&r(ue,{state:n,triggerRef:b,placement:"bottom start",offset:8,children:r(be,{...o,"aria-describedby":o["aria-describedby"]??"","aria-label":o["aria-label"]??"","aria-labelledby":o["aria-labelledby"]??"",children:r(Ce,{css:D,state:n,hasFooter:!0,"aria-label":"","aria-labelledby":"",...d?{value:d}:{},onChange:m,...f,maxValue:a})})})})},M=Te,{I18nProvider:ae,useDateFormatter:Ie}=ee.I18N,{getLocalTimeZone:X,parseDate:Y}=ee.InternationalizedDate,Xe=()=>r(ae,{locale:"en-SG",children:x(Se,{children:[r("h3",{children:"Basic"}),r(M,{startDateLabel:"Start date",endDateLabel:"End date"}),r("br",{}),r("h3",{children:"Disabled"}),r(M,{isDisabled:!0,startDateLabel:"Start date",endDateLabel:"End date"}),r("h3",{children:"Invalid"}),r(M,{isInvalid:!0,startDateLabel:"Start date",endDateLabel:"End date"})]})}),Ye=()=>{const[e,n]=E.useState({start:Y("2020-02-03"),end:Y("2020-02-08")}),b=Ie({dateStyle:"long"});return x(ae,{locale:"en-SG",children:[r("h3",{children:"Controlled"}),e?b.formatRange(e.start.toDate(X()),e.end.toDate(X())):"Invalid range of dates",r(M,{value:e,onChange:o=>n(o)})]})},pe={decorators:[e=>x("div",{children:[r("style",{dangerouslySetInnerHTML:{__html:".ladle-main { background: #eee; }"}}),r(e,{})]})]};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Ye as Controlled,Xe as Variants,pe as default};
