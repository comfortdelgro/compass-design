import{$ as M,a as T,b as k,c as I,d as C}from"./import-a63e98a2.js";import{r as O,s as $,R as x,j as y,a as W,F as w}from"./index-6668e921.js";import{C as U}from"./index-475ed52b.js";import{u as Z,a as B,b as K,c as E,d as j,D as q,P as G,e as N}from"./useOverlayTriggerState-ee6a69fa.js";import{a as R,u as z,b as A,c as H,r as J,d as L,i as Q,g as S,e as X,D as Y}from"./useCalendarState-b290a66b.js";import{u as _}from"./use-dom-ref-8557f905.js";function p(e,a,i){const l=R(),s=R(),t=R(),{labelProps:c,fieldProps:r,descriptionProps:u,errorMessageProps:f}=Z({...e,labelElementType:"span"}),o=B(a,i),b=r["aria-labelledby"]||r.id,{locale:m}=M(),h=a.formatValue(m,{month:"long"}),g=h?`selectedDateDescription ${h}`:"",P=z(g),D=[P["aria-describedby"],r["aria-describedby"]].filter(Boolean).join(" ")||void 0,V=A(e),v=O.useMemo(()=>H(i),[i]),{focusWithinProps:n}=K({...e,isDisabled:a.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...V,...o,...r,...P,...n,role:"group","aria-disabled":e.isDisabled||null,"aria-labelledby":b,"aria-describedby":D,onKeyDown(d){a.isOpen||e.onKeyDown&&e.onKeyDown(d)},onKeyUp(d){a.isOpen||e.onKeyUp&&e.onKeyUp(d)}},labelProps:{...c,onClick:()=>{v.focusFirst()}},fieldProps:{...r,id:t,[J]:"presentation","aria-describedby":D,value:a.value,onChange:a.setValue,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:a.validationState,autoFocus:e.autoFocus},descriptionProps:u,errorMessageProps:f,buttonProps:{...P,id:l,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${b} ${l}`,"aria-describedby":D,"aria-expanded":a.isOpen||void 0,onPress:()=>a.setOpen(!0)},dialogProps:{id:s,"aria-labelledby":`${b} ${l}`},calendarProps:{autoFocus:!0,value:a.dateValue,onChange:a.setDateValue,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,defaultFocusedValue:a.dateValue?void 0:e.placeholderValue,validationState:a.validationState,errorMessage:e.errorMessage}}}function ee(e){var v;const a=E(e),[i,l]=L(e.value,e.defaultValue,e.onChange),s=i||e.placeholderValue,[t,c]=j(s,e.granularity),r=i!=null?i.toDate(c??"UTC"):null,u=t==="hour"||t==="minute"||t==="second",f=e.shouldCloseOnSelect??!0,[o,b]=O.useState(),[m,h]=O.useState();if(O.useEffect(()=>{i&&(b(i),"hour"in i&&h(i))},[i]),s&&!(t in s))throw new Error("Invalid granularity "+t+" for value "+s.toString());const g=(n,d)=>{l("timeZone"in d?d.set(k(n)):I(n,d)),b(void 0),h(void 0)},P=n=>{const d=typeof f=="function"?f():f;u?m||d?g(n,m||S(e.placeholderValue)):b(n):l(n),d&&setTimeout(()=>{a.setOpen(!1)},0)},D=n=>{o?g(o,n):h(n)},V=e.validationState||(Q(i,e.minValue,e.maxValue)?"invalid":null)||(i&&((v=e.isDateUnavailable)!=null&&v.call(e,i))?"invalid":null);return{value:i,setValue:l,dateValue:o,timeValue:m,setDateValue:P,setTimeValue:D,granularity:t,hasTime:u,...a,setOpen(n){!n&&!i&&o&&u&&g(o,m||S(e.placeholderValue)),a.setOpen(n)},validationState:V,formatValue(n,d){if(!r)return"";const F=X(d,{granularity:t,timeZone:c,hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:i.calendar.identifier==="gregory"&&i.era==="BC"});return new T(n,F).format(r)}}}const ae=$("div",{width:"fit-content"}),ie=$("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),le=x.forwardRef((e,a)=>{const{css:i={},maxValue:l=C("2999-03-10")}=e,s=ee({...e,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:e.shouldCloseOnSelect??!1}),t=_(a),{groupProps:c,fieldProps:r,buttonProps:u,dialogProps:f,calendarProps:o}=p({...e,isReadOnly:e.isReadOnly?!0:!!e.isMobile},s,t),b={necessityIndicator:e.necessityIndicator,...r},m=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return o.isReadOnly=m(),y(ae,{css:i,children:W(Y,{children:[y(te,{ref:t,groupProps:c,fieldProps:b,buttonProps:u,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,label:e.label,errorMessage:e.errorMessage,helperText:e.helperText}),y(ne,{maxValue:l,state:s,calendarProps:o,calendarRef:t,dialogProps:f,css:e.calendarCSS})]})})}),te=x.forwardRef((e,a)=>{const{groupProps:i,fieldProps:l,buttonProps:s,label:t,isInvalid:c,isMobile:r,isReadOnly:u=!1,errorMessage:f,helperText:o}=e;return y(ie,{...i,ref:a,children:y(q,{...l,"aria-describedby":l["aria-describedby"]??"",buttonProps:s,label:t,isInvalid:c,isMobile:r,isReadOnly:u,errorMessage:f,helperText:o})})}),ne=e=>{const{state:a,calendarRef:i,dialogProps:l,calendarProps:s,maxValue:t=C("2999-03-10"),css:c={}}=e;return y(w,{children:a.isOpen&&y(G,{state:a,triggerRef:i,offset:8,placement:"bottom start",children:y(N,{...l,"aria-describedby":l["aria-describedby"]??"","aria-label":l["aria-label"]??"","aria-labelledby":l["aria-labelledby"]??"",children:y(U,{state:a,hasFooter:!0,...s,maxValue:t,css:c})})})})},se=le;se.displayName="DatePicker";export{se as D};
