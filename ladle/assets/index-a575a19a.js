import{l as yt}from"./lodash-ca47723a.js";import{R as w,r,a as $,j as t,F as Ct}from"./index-d6bb7a09.js";import{P as Dt}from"./index-741c3c2b.js";import{u as Z}from"./use-dom-ref-3f2db4fc.js";import{D as he,t as K,a as rt,g as gt,b as Je,c as Qe,d as Xe,e as kt,f as xt}from"./utils-cc5126da.js";import{a as Et,b as Oe,c as Lt,d as It,e as Mt,f as Rt,g as Nt,h as Pt,i as et,j as Ft,k as Kt,l as $t,m as Bt,n as Tt,o as Vt,S as tt,p as At}from"./dropdown.styles-41530bf2.js";import{p as Ht}from"./pick-child-06dc9e57.js";const Ut=()=>t("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:t("path",{d:"M9.39158 1.86239C9.64736 2.12284 9.64736 2.54372 9.39158 2.80416L4.15319 8.13808C3.89741 8.39853 3.48407 8.39853 3.22829 8.13808L0.608522 5.47112C0.352823 5.21068 0.352823 4.7898 0.608522 4.52935C0.864262 4.26891 1.27883 4.26891 1.53461 4.52935L3.67232 6.72334L8.46668 1.86239C8.72246 1.60153 9.1358 1.60153 9.39158 1.86239Z",fill:"currentColor"})}),Wt=()=>t("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",children:t("path",{d:"M15.0265 3.47966C15.4357 3.89637 15.4357 4.56978 15.0265 4.98649L6.64506 13.5208C6.23581 13.9375 5.57446 13.9375 5.16521 13.5208L0.973587 9.25363C0.564469 8.83691 0.564469 8.16351 0.973587 7.74679C1.38277 7.33008 2.04608 7.33008 2.45533 7.74679L5.87567 11.2572L13.5466 3.47966C13.9559 3.06228 14.6172 3.06228 15.0265 3.47966Z",fill:"currentColor"})}),jt=w.forwardRef((b,S)=>{const{children:f,value:i="",flagName:v,type:g,rightIcon:c,leftIcon:k,rightColor:x,css:y={},checkmark:E="none",...P}=b,{textValue:H,...F}=P,{isPositioned:L,open:I,selectedItem:B,disabledKeys:te=[],searchValue:z,focusKey:G,selectedKey:Y,setSelectedItem:ce,setDropdownItemKeys:re,onItemClick:oe}=r.useContext(he),m=Z(S),p=r.useMemo(()=>(B==null?void 0:B.value.toString())===i.toString(),[B,i]),M=r.useMemo(()=>(G==null?void 0:G.toString())===i.toString(),[G,i]),J=r.useMemo(()=>te.findIndex(T=>T.toString()===i.toString())!==-1,[te,i]),Q=r.useMemo(()=>!z||K(f).toLocaleLowerCase().includes(z.toLocaleLowerCase()),[z,f]);return r.useEffect(()=>{J||re==null||re(T=>{const a=T.findIndex(u=>u.value.toString()===i.toString());return a===-1?T.push({value:i,visibility:!0}):T[a]={value:i,visibility:Q},T})},[i,J,Q]),r.useEffect(()=>{Y&&Y.toString()===i.toString()&&ce({value:i.toString(),displayValue:H||f})},[Y,i]),r.useEffect(()=>{L&&(M||p&&M)&&m.current&&m.current.scrollIntoView({block:"nearest"})},[L,M,p]),r.useEffect(()=>{p&&L&&m.current&&m.current.scrollIntoView({block:"nearest"})},[L,I,p]),Q?$(Et,{css:y,isFocused:M&&!p,isSelected:p&&!M,isSelectedFocused:p&&M,isDisabled:J,onClick:()=>{J||oe({value:i.toString(),displayValue:H||f,flagName:v??""})},ref:m,role:"option","aria-selected":p,...F,children:[k&&t(Oe,{children:k}),t(Lt,{children:f}),g==="icon"&&c&&t(Oe,{children:c}),g==="color"&&x&&t(It,{css:{$$bg:x}}),E!=="none"&&t(Mt,{isSelected:p,checkmark:E,children:E==="checkbox"?t("div",{children:t(Ut,{})}):E==="tick"?t(Wt,{}):null})]}):null}),ot=jt;function qt(){return t(Rt,{children:$("div",{className:"spinner",children:[t("div",{className:"spinner-1"}),t("div",{className:"spinner-2"}),t("div",{className:"spinner-3"}),t("div",{})]})})}function Zt(b){const[S,f]=r.useState(!1),i=r.useMemo(()=>new IntersectionObserver(([v])=>f(!!(v!=null&&v.isIntersecting))),[b.current]);return r.useEffect(()=>(b.current&&i.observe(b.current),()=>{i.disconnect()}),[b,i]),S}const _t=b=>{const{children:S,isLoading:f,css:i={},noDataMessage:v,onLoadMore:g}=b,c=Z(null),k=Z(null),x=Zt(c),{searchValue:y,labelId:E,isLoadingMore:P}=r.useContext(he),{child:H,rest:F}=Ht(S,rt),L=r.useMemo(()=>{let I=0;return w.Children.map(F,B=>{K(B).toLocaleLowerCase().includes(y.toLocaleLowerCase())&&I++}),I},[F,y]);return r.useEffect(()=>{if(c.current&&k.current){const I=gt(c.current,k.current);x&&I>=0&&I<4&&!P&&(g==null||g())}},[x]),r.useMemo(()=>$(Ct,{children:[H&&H,$(Nt,{css:i,role:"listbox","aria-labelledby":E,children:[f?t(qt,{}):L===0?t(Pt,{children:v||"No data"}):F,w.Children.toArray(F).length>0&&t(et,{ref:c}),t(et,{ref:k})]})]}),[i,f,L,S])},zt=_t,Gt=w.forwardRef((b,S)=>t(_,{...b,ref:S,type:"combobox"})),Yt=Gt,Jt=w.forwardRef((b,S)=>{const{children:f,title:i,isClickable:v,css:g={},onClick:c,...k}=b,x=Z(S);return $(Ft,{css:g,ref:x,...k,children:[i&&t(Kt,{isClickable:!!v,onClick:()=>{v&&(c==null||c())},children:i}),f]})}),Qt=Jt,Xt=w.forwardRef((b,S)=>t(_,{...b,ref:S,type:"select"})),Ot=Xt,er=()=>t(At,{width:"16",height:"16",viewBox:"0 0 16 16",className:"cdg-dropdown-button-icon",children:t("path",{d:"M8.33276 12.3334C8.02004 12.3334 7.70717 12.2125 7.46885 11.9707L1.35805 5.78022C0.880649 5.29658 0.880649 4.5131 1.35805 4.02947C1.83546 3.54584 2.60886 3.54584 3.08626 4.02947L8.33276 9.34651L13.5804 4.03044C14.0578 3.54681 14.8312 3.54681 15.3086 4.03044C15.786 4.51407 15.786 5.29755 15.3086 5.78118L9.19782 11.9717C8.95912 12.2135 8.64594 12.3334 8.33276 12.3334Z",fill:"currentColor"})}),tr=37,q=()=>{},rr=w.forwardRef((b,S)=>{const{id:f=`cdg-element-${Math.random().toString(36).substring(2)}`,css:i={},popoverCSS:v={},children:g,type:c="select",icon:k=t(er,{}),placeholder:x,isErrored:y=!1,isRequired:E=!1,isReadOnly:P=!1,isLoading:H=!1,helperText:F,errorMessage:L,numberOfRows:I,disabledKeys:B=[],selectedKey:te="",defaultSelectedKey:z="",disabledValues:G,value:Y="",defaultValue:ce="",defaultOpen:re=!1,shouldDeselect:oe=!1,allowsCustomValue:m=!1,disableClearable:p=!1,prefix:M=null,noDataMessage:J="",label:Q,isCloseOnSelect:se=!0,isLoadingMore:T=!1,onValueChange:a=q,onSelectionChange:u=q,onLoadMore:st=q,onOpenChange:d=q,isDisabled:X=!1,inputRef:lt,buttonRef:nt,autoFocus:pe,autoCapitalize:ve,onCut:ye,onCopy:Ce,onBlur:le=q,onFocus:be=q,onPaste:De,onInput:ge,onKeyUp:ke,onSelect:xe,onKeyDown:ue=q,onBeforeInput:Ee,onCompositionEnd:Le,onCompositionStart:Ie,onCompositionUpdate:Me,...it}=b,at={...it},U=r.useMemo(()=>ce||z,[ce,z]),O=r.useMemo(()=>Y||te,[Y,te]),[ct,ut]=w.useState(!1),[h,W]=w.useState(re),[o,ne]=w.useState(null),[me,R]=w.useState(null),[Re,j]=r.useState(""),[V,dt]=r.useState([]),[C,ft]=r.useState(null),pt=Z(S),ie=Z(nt),n=Z(lt),Ne=r.useRef(!1),de=r.useMemo(()=>!!U||!U&&!O,[U,O]),bt=r.useMemo(()=>{var e,s;switch(c){case"select":return((e=ie.current)==null?void 0:e.clientWidth)??"100%";case"combobox":return((s=n.current)==null?void 0:s.clientWidth)??"100%";default:return"100%"}},[c,h]);r.useEffect(()=>{Ne.current?h||R(null):Ne.current=!0},[h,m]);const Pe=e=>typeof e=="string"?e:w.Children.map(e,s=>{if(!s)return s;if(w.isValidElement(s)){if(s.type===ot){const N=s;if(!("value"in N.props))return w.cloneElement(N,{value:`${s.key}`||""})}const D=s;if(D.props.children)return w.cloneElement(D,{children:Pe(D.props.children)})}return s});r.useEffect(()=>{ft(Pe(g))},[g]);const A=r.useCallback(e=>{de&&(ne(e),R((e==null?void 0:e.value)??null))},[de]),mt=r.useCallback(e=>{var s,D,N,ae,Be,Te,Ve,Ae,He,Ue,We,je,qe,Ze,_e,ze,Ge,Ye;if(ue(e),h){const ee=me??(o==null?void 0:o.value.toString())??null;switch(e.key){case"ArrowUp":case"ArrowLeft":if(e.preventDefault(),ee!==null){const l=xt(ee??"",C,V),Se=(l==null?void 0:l.props.value)??((s=l==null?void 0:l.key)==null?void 0:s.toString().replace(".$",""))??null;R(Se)}else R(((ae=(N=(D=Je(C,V))==null?void 0:D.props)==null?void 0:N.value)==null?void 0:ae.toString())??null);break;case"ArrowDown":case"ArrowRight":if(e.preventDefault(),ee!==null){const l=kt(ee??"",C,V),Se=(l==null?void 0:l.props.value)??((Be=l==null?void 0:l.key)==null?void 0:Be.toString().replace(".$",""))??null;R(Se)}else R(((Ae=(Ve=(Te=Qe(C,V))==null?void 0:Te.props)==null?void 0:Ve.value)==null?void 0:Ae.toString())??null);break;case"Enter":if(e.preventDefault(),ee!==null){j("");const l=Xe(ee??"",C);if(l){if(W(!se),d==null||d(!1),!p&&oe&&(o==null?void 0:o.value)===l.props.value){A(null),u==null||u(""),a==null||a(""),n.current&&(n.current.value="");return}A({value:((Ue=(He=l==null?void 0:l.props)==null?void 0:He.value)==null?void 0:Ue.toString())??"",displayValue:l.props.textValue||l.props.children,flagName:l.props.flagName??""}),n.current&&(n.current.value=K(l.props.children)),u==null||u((We=l==null?void 0:l.props)==null?void 0:We.value),a==null||a((je=l==null?void 0:l.props)==null?void 0:je.value)}}break;case"Escape":case"Tab":W(!1),d==null||d(!1);break;case"Home":e.preventDefault(),R(((_e=(Ze=(qe=Qe(C,V))==null?void 0:qe.props)==null?void 0:Ze.value)==null?void 0:_e.toString())??null);break;case"End":e.preventDefault(),R(((Ye=(Ge=(ze=Je(C,V))==null?void 0:ze.props)==null?void 0:Ge.value)==null?void 0:Ye.toString())??null);break}}else switch(e.key){case"ArrowUp":case"ArrowDown":e.preventDefault(),W(!0),d==null||d(!0);break}},[se,h,p,oe,me,C,o,V,a,u,d,ue,A]),fe=r.useCallback(()=>{var e;j(""),W(s=>!s),d==null||d(!h),(e=n.current)==null||e.focus()},[d,h]),Fe=r.useCallback(e=>{W(!0),d==null||d(!0),j(e.target.value??""),c==="combobox"&&(m?(A(null),u==null||u(""),a==null||a("")):(e.target.value===""||yt.isEmpty(e.target.value.replaceAll(" ","")))&&!P&&!p&&(ne(null),R(null),u==null||u(""),a==null||a("")))},[P,p,de,c,o,m,d,a,u,A]),Ke=r.useCallback(()=>{["combobox"].includes(c)&&n.current&&setTimeout(()=>{document.activeElement!==n.current&&n.current&&(m||(o?n.current.value=K(o==null?void 0:o.displayValue):n.current.value=""),j(""))})},[c,o,m,de]);r.useEffect(()=>{!h&&["combobox"].includes(c)&&n.current&&Ke()},[h,c,Ke]),r.useEffect(()=>{var D;if(!C||!O&&!U){ne(null),j(""),!m&&n.current&&(n.current.value=""),R(N=>N??null);return}const e=O||U,s=Xe(e,C);s&&(ne({value:e.toString(),displayValue:s,flagName:((D=s==null?void 0:s.props)==null?void 0:D.flagName)??""}),n.current&&(n.current.value=K(s)))},[C,O,U,m]);const we=r.useCallback(e=>{le==null||le(e),c==="combobox"&&n.current&&n.current&&(!m||!p)&&(o?n.current.value=K(o==null?void 0:o.displayValue):n.current.value="")},[le,o,c,m]),wt=r.useMemo(()=>{switch(c){case"select":return t(Bt,{isEmpty:!o,className:"cdg-dropdown-input",role:"button",isErrored:!!y,isDisabled:X,"aria-required":E,children:$("button",{id:f,type:"button",ref:ie,disabled:X,onClick:fe,onBlur:we,onFocus:be,className:"cdg-dropdown-button",autoFocus:pe,children:[M,t("span",{children:o?K(o==null?void 0:o.displayValue):x}),k]})});case"combobox":return $($t,{isEmpty:!o,className:"cdg-dropdown-input",role:"button",isErrored:!!y,isDisabled:X,"aria-required":E,children:[M,t("input",{id:f,ref:n,readOnly:P,disabled:X,placeholder:x,required:E,autoFocus:pe,autoCapitalize:ve,"aria-autocomplete":"list",role:"combobox","aria-invalid":y,"aria-expanded":h,onClick:fe,onChange:Fe,onBlur:we,onFocus:be,onCut:ye,onCopy:Ce,onPaste:De,onInput:ge,onKeyUp:ke,onSelect:xe,onKeyDown:ue,onBeforeInput:Ee,onCompositionEnd:Le,onCompositionStart:Ie,onCompositionUpdate:Me}),t("button",{type:"button",tabIndex:-1,disabled:X,onClick:fe,className:"cdg-dropdown-button",children:k})]});default:return null}},[M,h,c,f,x,o,y,X,P,pe,ve,le,be,fe,Fe,we,ye,Ce,De,ge,ke,xe,ue,Ee,Le,Ie,Me]),St=e=>{var s,D;if(!P){if(se&&(W(!1),j(""),d==null||d(!1)),setTimeout(()=>{var N,ae;(N=n.current)==null||N.focus(),(ae=ie.current)==null||ae.focus()},0),!p&&!e.value){A(null),u==null||u(""),a==null||a("");return}if(!p&&oe&&(o==null?void 0:o.value)===e.value){A(null),u==null||u(""),a==null||a("");return}(o==null?void 0:o.value)!==e.value&&(u==null||u(e.value),a==null||a(e.value)),A(e),["combobox"].includes(c)?n.current&&(n.current.value=K(e.displayValue),se?(j(K(e.displayValue)),n.current.blur()):(s=n.current)==null||s.focus()):(D=ie.current)==null||D.focus()}},$e=()=>{setTimeout(()=>{var e,s;(e=n.current)==null||e.focus(),(s=ie.current)==null||s.focus()},0)},ht=r.useCallback(()=>{W(!1),d==null||d(!1)},[d]),vt=r.useCallback(e=>{ut(e)},[]);return $(Tt,{className:`${h?"cdg-dropdown-opening":""}`,css:i,ref:pt,onKeyDown:mt,...at,children:[Q&&$("label",{htmlFor:f,id:`${f}-label`,children:[Q,E&&t("span",{children:"*"})]}),t(he.Provider,{value:{isLoadingMore:T,isPositioned:ct,open:h,focusKey:me,selectedKey:O,defaultSelectedKey:U,disabledKeys:G??B??[],searchValue:Re,labelId:`${f}-label`,selectedItem:o,setSelectedItem:ne,dropdownItemKeys:V,setDropdownItemKeys:dt,onItemClick:St,onHeaderClick:$e},children:t(Dt,{isOpen:h,anchor:wt,css:{width:"100%"},direction:"bottom-left",onClose:ht,onPositionedChange:vt,children:t(Vt,{onClick:$e,css:{...v,width:v.width??bt},children:t(zt,{searchValue:Re,isLoading:H,css:{maxHeight:I?`${I*tr}px`:"16rem"},onLoadMore:st,noDataMessage:J,children:C})})})}),y&&L&&t(tt,{error:!!y,children:L}),F&&t(tt,{children:F})]})}),_=rr;_.Item=ot;_.Select=Ot;_.ComboBox=Yt;_.Section=Qt;_.Header=rt;export{_ as D};
