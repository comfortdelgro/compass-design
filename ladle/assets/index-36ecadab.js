import{$ as M,a as T,b as k,c as I,d as S}from"./import-0e52c6a7.js";import{r as O,s as $,R as x,a as W,j as m,F as w}from"./index-e285302b.js";import{C as U}from"./index-56f0f8ff.js";import{u as Z,a as B,b as K,c as E,d as j,D as q,P as G,e as N}from"./useOverlayTriggerState-c47fddad.js";import{a as C,u as z,b as A,c as H,r as J,d as L,i as Q,g as R,e as X}from"./useCalendarState-72159f9a.js";import{u as Y}from"./use-dom-ref-58648911.js";function _(e,a,l){const i=C(),r=C(),t=C(),{labelProps:c,fieldProps:s,descriptionProps:u,errorMessageProps:f}=Z({...e,labelElementType:"span"}),o=B(a,l),b=s["aria-labelledby"]||s.id,{locale:y}=M(),h=a.formatValue(y,{month:"long"}),g=h?`selectedDateDescription ${h}`:"",P=z(g),D=[P["aria-describedby"],s["aria-describedby"]].filter(Boolean).join(" ")||void 0,V=A(e),v=O.useMemo(()=>H(l),[l]),{focusWithinProps:n}=K({...e,isDisabled:a.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...V,...o,...s,...P,...n,role:"group","aria-disabled":e.isDisabled||null,"aria-labelledby":b,"aria-describedby":D,onKeyDown(d){a.isOpen||e.onKeyDown&&e.onKeyDown(d)},onKeyUp(d){a.isOpen||e.onKeyUp&&e.onKeyUp(d)}},labelProps:{...c,onClick:()=>{v.focusFirst()}},fieldProps:{...s,id:t,[J]:"presentation","aria-describedby":D,value:a.value,onChange:a.setValue,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:a.validationState,autoFocus:e.autoFocus},descriptionProps:u,errorMessageProps:f,buttonProps:{...P,id:i,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${b} ${i}`,"aria-describedby":D,"aria-expanded":a.isOpen||void 0,onPress:()=>a.setOpen(!0)},dialogProps:{id:r,"aria-labelledby":`${b} ${i}`},calendarProps:{autoFocus:!0,value:a.dateValue,onChange:a.setDateValue,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,defaultFocusedValue:a.dateValue?void 0:e.placeholderValue,validationState:a.validationState,errorMessage:e.errorMessage}}}function p(e){var v;const a=E(e),[l,i]=L(e.value,e.defaultValue,e.onChange),r=l||e.placeholderValue,[t,c]=j(r,e.granularity),s=l!=null?l.toDate(c??"UTC"):null,u=t==="hour"||t==="minute"||t==="second",f=e.shouldCloseOnSelect??!0,[o,b]=O.useState(),[y,h]=O.useState();if(O.useEffect(()=>{l&&(b(l),"hour"in l&&h(l))},[l]),r&&!(t in r))throw new Error("Invalid granularity "+t+" for value "+r.toString());const g=(n,d)=>{i("timeZone"in d?d.set(k(n)):I(n,d)),b(void 0),h(void 0)},P=n=>{const d=typeof f=="function"?f():f;u?y||d?g(n,y||R(e.placeholderValue)):b(n):i(n),d&&setTimeout(()=>{a.setOpen(!1)},0)},D=n=>{o?g(o,n):h(n)},V=e.validationState||(Q(l,e.minValue,e.maxValue)?"invalid":null)||(l&&((v=e.isDateUnavailable)!=null&&v.call(e,l))?"invalid":null);return{value:l,setValue:i,dateValue:o,timeValue:y,setDateValue:P,setTimeValue:D,granularity:t,hasTime:u,...a,setOpen(n){!n&&!l&&o&&u&&g(o,y||R(e.placeholderValue)),a.setOpen(n)},validationState:V,formatValue(n,d){if(!s)return"";const F=X(d,{granularity:t,timeZone:c,hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:l.calendar.identifier==="gregory"&&l.era==="BC"});return new T(n,F).format(s)}}}const ee=$("div",{width:"fit-content"}),ae=$("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),le=x.forwardRef((e,a)=>{const{css:l={},maxValue:i=S("2999-03-10")}=e,r=p({...e,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:e.shouldCloseOnSelect??!1}),t=Y(a),{groupProps:c,fieldProps:s,buttonProps:u,dialogProps:f,calendarProps:o}=_({...e,isReadOnly:e.isReadOnly?!0:!!e.isMobile},r,t),b={necessityIndicator:e.necessityIndicator,...s},y=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return o.isReadOnly=y(),W(ee,{css:l,children:[m(ie,{ref:t,groupProps:c,fieldProps:b,buttonProps:u,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,label:e.label,errorMessage:e.errorMessage,helperText:e.helperText}),m(te,{maxValue:i,state:r,onCancel:e.onCancel,calendarProps:o,calendarRef:t,dialogProps:f,css:e.calendarCSS})]})}),ie=x.forwardRef((e,a)=>{const{groupProps:l,fieldProps:i,buttonProps:r,label:t,isInvalid:c,isMobile:s,isReadOnly:u=!1,errorMessage:f,helperText:o}=e;return m(ae,{...l,ref:a,children:m(q,{...i,"aria-describedby":i["aria-describedby"]??"",buttonProps:r,label:t,isInvalid:c,isMobile:s,isReadOnly:u,errorMessage:f,helperText:o})})}),te=e=>{const{state:a,calendarRef:l,dialogProps:i,calendarProps:r,onCancel:t,maxValue:c=S("2999-03-10"),css:s={}}=e;return m(w,{children:a.isOpen&&m(G,{state:a,triggerRef:l,offset:8,placement:"bottom start",children:m(N,{...i,"aria-describedby":i["aria-describedby"]??"","aria-label":i["aria-label"]??"","aria-labelledby":i["aria-labelledby"]??"",children:m(U,{state:a,hasFooter:!0,onCancelCallback:t,...r,maxValue:c,css:s})})})})},ne=le;ne.displayName="DatePicker";export{ne as D};
