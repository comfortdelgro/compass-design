import{$ as le,a as z,b as A,c as H,d as re,e as J}from"./import-f833c833.js";import{r as w,s as ee,R as W,j as n,a as M,F as se}from"./index-4c46b99a.js";import"./index-b53f8881.js";import"./index-45cc1b5f.js";import{u as ie,a as de,b as oe,c as ce,d as ue,D as Q,P as be,e as he}from"./useOverlayTriggerState-9f1e9ae3.js";import{u as fe,a as X,c as me,f as ye,r as De,b as ge,d as Pe,i as Y,g as L,e as _,D as Se}from"./useCalendarState-3d5ed476.js";import{R as Ce}from"./range-calendar-98e2c6ce.js";import{u as ve}from"./use-dom-ref-6bf95fd0.js";import{C as ae}from"./calendar-0d6edf04.js";import{C as Ve}from"./components-343e0105.js";import{B as Fe}from"./button-31ab96fd.js";import"./clsx.m-30223e4c.js";import"./utils-491c98e6.js";import"./isArray-74001636.js";import"./useEvent-f91964a5.js";import"./import-d931ccd0.js";import"./index-551c38ab.js";function Oe(e,r,d){var t,s;const{labelProps:o,fieldProps:c,descriptionProps:P,errorMessageProps:a}=ie({...e,labelElementType:"span"}),u=c["aria-labelledby"]||c.id,{locale:C}=le(),f=r.formatValue(C,{month:"long"}),y=f?`selectedRangeDescription ${f.start} ${f.end}`:"",b=fe(y),i={"aria-label":"startDate","aria-labelledby":u},m={"aria-label":"endDate","aria-labelledby":u},l=X(),S=X(),F=de(r,d),v=[b["aria-describedby"],c["aria-describedby"]].filter(Boolean).join(" ")||void 0,O=w.useMemo(()=>me(d,{accept:h=>h.id!==l}),[d,l]),R={[ye]:O,[De]:"presentation","aria-describedby":v,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:r.validationState},x=ge(e),{focusWithinProps:$}=oe({...e,isDisabled:r.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...x,...F,...c,...b,...$,role:"group","aria-disabled":e.isDisabled||null,"aria-describedby":v,onKeyDown(h){r.isOpen||e.onKeyDown&&e.onKeyDown(h)},onKeyUp(h){r.isOpen||e.onKeyUp&&e.onKeyUp(h)}},labelProps:{...o,onClick:()=>{O.focusFirst()}},buttonProps:{...b,id:l,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${u} ${l}`,"aria-describedby":v,"aria-expanded":r.isOpen||void 0,onPress:()=>r.setOpen(!0)},dialogProps:{id:S,"aria-labelledby":`${u} ${l}`},startFieldProps:{...i,...R,value:(t=r.value)==null?void 0:t.start,onChange:h=>r.setDateTime("start",h),autoFocus:e.autoFocus},endFieldProps:{...m,...R,value:(s=r.value)==null?void 0:s.end,onChange:h=>r.setDateTime("end",h)},descriptionProps:P,errorMessageProps:a,calendarProps:{autoFocus:!0,value:r.dateRange,onChange:r.setDateRange,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,allowsNonContiguousRanges:e.allowsNonContiguousRanges,defaultFocusedValue:r.dateRange?void 0:e.placeholderValue,validationState:r.validationState,errorMessage:e.errorMessage}}}function Re(e){var x,$;const r=ce(e),[d,o]=Pe(e.value,e.defaultValue||null,e.onChange);let[c,P]=w.useState(()=>d||{start:null,end:null});d==null&&c.start&&c.end&&(c={start:null,end:null},P(c));const a=d||c,u=t=>{P(t),t.start||t.end?o(t):o(null)},C=a.start||a.end||e.placeholderValue,[f]=ue(C,e.granularity),y=f==="hour"||f==="minute"||f==="second",b=e.shouldCloseOnSelect??!0;let[i,m]=w.useState(null),[l,S]=w.useState(null);a&&a.start&&a.end&&(i=a,"hour"in a.start&&(l=a));const F=(t,s)=>{t.end&&t.start&&s.end&&s.start&&(u({start:"timeZone"in s.start?s.start.set(A(t.start)):H(t.start,s.start),end:"timeZone"in s.end?s.end.set(A(t.end)):H(t.end,s.end)}),m(null),S(null))},v=t=>{let s=typeof b=="function"?b():b;y?s||t.start&&t.end&&(l!=null&&l.start)&&l.end?F(t,{start:(l==null?void 0:l.start)||L(e.placeholderValue),end:(l==null?void 0:l.end)||L(e.placeholderValue)}):m(t):t.start||t.end?u(t):!t.start||!t.end?(o({start:null,end:null}),m(null)):m(t),s&&t.start&&t.end&&r.setOpen(!1)},O=t=>{i!=null&&i.start&&i.end&&t.start&&t.end?F(i,t):S(t)},R=e.validationState||(a!=null&&(Y(a.start,e.minValue,e.maxValue)||Y(a.end,e.minValue,e.maxValue)||a.end!=null&&a.start!=null&&a.end.compare(a.start)<0||a.start&&((x=e.isDateUnavailable)!=null&&x.call(e,a.start))||a.end&&(($=e.isDateUnavailable)!=null&&$.call(e,a.end)))?"invalid":null);return{value:a,setValue:u,dateRange:i,timeRange:l,granularity:f,hasTime:y,setDate(t,s){v({...i,[t]:s})},setTime(t,s){O({...l,[t]:s})},setDateTime(t,s){u({...a,[t]:s})},setDateRange:v,setTimeRange:O,...r,setOpen(t){!t&&!(a.start&&a.end)&&(i!=null&&i.start)&&i.end&&y&&F(i,{start:(l==null?void 0:l.start)||L(e.placeholderValue),end:(l==null?void 0:l.end)||L(e.placeholderValue)}),r.setOpen(t)},validationState:R,formatValue(t,s){if(!a||!a.start||!a.end)return null;const h="timeZone"in a.start?a.start.timeZone:void 0,I=e.granularity||(a.start&&"minute"in a.start?"minute":"day"),Z="timeZone"in a.end?a.end.timeZone:void 0,K=e.granularity||(a.end&&"minute"in a.end?"minute":"day"),ne=_(s,{granularity:I,timeZone:h??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:a.start.calendar.identifier==="gregory"&&a.start.era==="BC"||a.end.calendar.identifier==="gregory"&&a.end.era==="BC"}),N=a.start.toDate(h||"UTC"),G=a.end.toDate(Z||"UTC"),k=new z(t,ne);let B;if(h===Z&&I===K&&a.start.compare(a.end)!==0){try{const V=k.formatRangeToParts(N,G);let E=-1;for(let D=0;D<V.length;D++){const U=V[D];if(U.source==="shared"&&U.type==="literal")E=D;else if(U.source==="endRange")break}let j="",q="";for(let D=0;D<V.length;D++)D<E?j+=V[D].value:D>E&&(q+=V[D].value);return{start:j,end:q}}catch{}B=k}else{const V=_(s,{granularity:K,timeZone:Z??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24});B=new z(t,V)}return{start:k.format(N),end:B.format(G)}}}}const xe=ee("div",{width:"fit-content"}),$e=ee("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),Te=W.forwardRef((e,r)=>{const{startDateLabel:d,endDateLabel:o,shouldCloseOnSelect:c=!1,css:P={},errorMessage:a,helperText:u,maxValue:C,hasShortcuts:f,ctaButtonRender:y,onSearchButtonClick:b,customShortcuts:i,...m}=e,l=Re({...m,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:c??!1}),S=ve(r),{labelProps:F,groupProps:v,startFieldProps:O,endFieldProps:R,buttonProps:x,dialogProps:$,calendarProps:t}=Oe({...m,isReadOnly:e.isReadOnly?!0:!!e.isMobile,"aria-label":"date range picker","aria-describedby":""},l,S),s={necessityIndicator:e.necessityIndicator,...O},h={necessityIndicator:e.necessityIndicator,...R},I=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return t.isReadOnly=I(),n(xe,{ref:S,css:P,children:M(Se,{children:[n(Me,{state:l,label:e.label,labelProps:F,groupProps:v,startFieldProps:s,endFieldProps:h,buttonProps:x,startDateLabel:d,endDateLabel:o,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,errorMessage:a,helperText:u}),n(Ie,{maxValue:C,state:l,calendarRef:S,dialogProps:$,calendarProps:t,hasShortcuts:f,ctaButtonRender:y,onSearchButtonClick:b,customShortcuts:i,css:e.calendarCSS})]})})}),Me=W.forwardRef((e,r)=>{const{label:d,labelProps:o,groupProps:c,startFieldProps:P,endFieldProps:a,buttonProps:u,startDateLabel:C,endDateLabel:f,isInvalid:y,isMobile:b,isReadOnly:i=!1,errorMessage:m,helperText:l}=e;return M($e,{children:[n("span",{...o,className:"date-range-label",children:d}),n("div",{...c,ref:r,className:"date-range-inputs-body",children:M("div",{className:"date-range-fields",children:[n(Q,{...P,label:C,buttonProps:u,isInvalid:y,isMobile:b,isReadOnly:i,errorMessage:m,helperText:l}),n(Q,{...a,label:f,buttonProps:u,isInvalid:y,isMobile:b,isReadOnly:i})]})})]})}),Ie=e=>{const{state:r,calendarRef:d,dialogProps:o,calendarProps:c,css:P={},hasShortcuts:a=!1,maxValue:u=re("2999-03-10"),ctaButtonRender:C,onSearchButtonClick:f,customShortcuts:y}=e,{value:b,onChange:i,...m}=c,l=S=>{i&&i(S)};return n(se,{children:r.isOpen&&n(be,{state:r,triggerRef:d,placement:"bottom start",offset:8,children:n(he,{...o,"aria-describedby":o["aria-describedby"]??"","aria-label":o["aria-label"]??"","aria-labelledby":o["aria-labelledby"]??"",children:n(Ce,{css:P,state:r,hasFooter:!0,"aria-label":"","aria-labelledby":"",...b?{value:b}:{},onChange:l,...m,maxValue:u,hasShortcuts:a,ctaButtonRender:C,onSearchButtonClick:f,customShortcuts:y})})})})},g=Te,{I18nProvider:te,useDateFormatter:Le}=ae.I18N,{getLocalTimeZone:T,parseDate:p}=ae.InternationalizedDate,Xe=()=>n(te,{locale:"en-SG",children:M(Ve,{children:[n("h3",{children:"Basic"}),n(g,{startDateLabel:"Start date",endDateLabel:"End date"}),n("br",{}),n("h3",{children:"Disabled"}),n(g,{isDisabled:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Read only"}),n(g,{isReadOnly:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Invalid"}),n(g,{isInvalid:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Min & Max"}),n(g,{startDateLabel:"Start date",endDateLabel:"End date",minValue:J(T()),maxValue:J(T()).add({days:7})}),n("h3",{children:"Is Mobile"}),n(g,{startDateLabel:"Start date",endDateLabel:"End date",isMobile:!0}),n("h3",{children:"Helper texts"}),n(g,{isInvalid:!0,isRequired:!0,helperText:"Weekend is excluded",errorMessage:"Must not include weekend",startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Shortcuts"}),n(g,{startDateLabel:"Start date",endDateLabel:"End date",hasShortcuts:!0}),n("h3",{children:"Custom Shortcuts Range Calendar"}),n(g,{startDateLabel:"Start date",endDateLabel:"End date",hasShortcuts:!0,customShortcuts:e=>{const r=[{label:"Custom Shortcut",getValue:()=>({start:null,end:null})}];return[...e,...r]},ctaButtonRender:n(Fe,{onPress:()=>{alert("Custom callback")},children:"Custom Button"})})]})}),Ye=()=>{const[e,r]=W.useState({start:p("2020-02-03"),end:p("2020-02-08")}),d=Le({dateStyle:"long"});return M(te,{locale:"en-SG",children:[n("h3",{children:"Controlled"}),e.start&&e.end?d.formatRange(e.start.toDate(T()),e.end.toDate(T())):`${e.start&&d.format(e.start.toDate(T()))} - ${e.end&&d.format(e.end.toDate(T()))}`,n(g,{value:e,shouldCloseOnSelect:!0,onChange:o=>r(o)})]})},_e=()=>n(g,{});typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Ye as Controlled,_e as Default,Xe as Variants};
