"use client";import{j as S}from"./jsx-runtime-ea7736fc.js";import{c as P}from"./cloneDeep-c22ea01b.js";import{R as te,r as d}from"./index-6c164b11.js";import{P as we}from"./index-f318de67.js";import{T as be}from"./index-898776bc.js";import{C as ke}from"./objectToCSS-aff350d4.js";import{u as ye}from"./use-dom-ref-7c72e1a5.js";import"./index-7972436d.js";import{B as Ie}from"./button-be34d763.js";const H={start:0,end:0,format:"",max:0,min:0},U={hour:null,minute:null,second:null,session:null},ie=["hours24","minutes","sessions"],Te=4,oe="AM",De="PM",Se=[oe,De],Pe="_timePickerInput_zopan_6",Ce="_timePickerInputIcon_zopan_10",xe="_timePickerDropdownItem_zopan_28",ve="_active_zopan_47",_e="_timePickerDropdownWrapper_zopan_51",Ne="_timePickerDropdownContent_zopan_57",Ae="_timePickerDropdownControl_zopan_64",Re="_timePickerDropdownFooter_zopan_78",j={timePickerInput:Pe,timePickerInputIcon:Ce,timePickerDropdownItem:xe,active:ve,timePickerDropdownWrapper:_e,timePickerDropdownContent:Ne,timePickerDropdownControl:Ae,timePickerDropdownFooter:Re};function ae(r){const{selectedTime:c,time:h,onClickItem:f,displayDataType:T,isOpen:R,itemId:C,focusingItemId:N,minTime:p=""}=r,M=d.useRef(null);d.useEffect(()=>{var b;C===N&&((b=M.current)==null||b.focus())},[N,C]),d.useEffect(()=>{R&&c===h&&setTimeout(()=>{O("auto")},0)},[R]),d.useEffect(()=>{c===h&&M.current&&O("smooth")},[c,h]);const O=b=>{var K;M.current&&((K=M.current.parentElement)==null||K.scroll({top:M.current.offsetTop-Te,behavior:b}))};return S.jsx("button",{ref:M,id:C,className:`cdg-timepicker-dropdown-item cdg-timepicker-dropdown-item__${C} ${c===h?j.active:""} ${j.timePickerDropdownItem}`,onClick:f(h,T),tabIndex:-1,disabled:T!=="session"&&p==="-"||T==="session"&&p==="PM"&&h==="AM"||Number(p)>Number(h),children:h})}const Me=te.memo(ae);ae.__docgenInfo={description:"",methods:[],displayName:"TimePickerDropdownItem",props:{itemId:{required:!0,tsType:{name:"string"},description:""},focusingItemId:{required:!0,tsType:{name:"string"},description:""},selectedDisplayList:{required:!0,tsType:{name:"Record",elements:[{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:`Record<
  SelectedKey,
  string | number | null
>`},description:""},selectedTime:{required:!0,tsType:{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]},description:""},minTime:{required:!0,tsType:{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]},description:""},time:{required:!0,tsType:{name:"string"},description:""},isOpen:{required:!1,tsType:{name:"boolean"},description:""},displayDataType:{required:!0,tsType:{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},description:""},onClickItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(time: string, type: SelectedKey) => () => void",signature:{arguments:[{type:{name:"string"},name:"time"},{type:{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},name:"type"}],return:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}}}},description:""}}};function ue(r){const c={hour:P(H),minute:P(H),second:P(H),session:P(H)};return r.includes("HH")?c.hour={start:r.indexOf("HH"),end:r.indexOf("HH")+2,format:"HH",min:0,max:23}:r.includes("hh")&&(c.hour={start:r.indexOf("hh"),end:r.indexOf("hh")+2,format:"hh",min:1,max:12}),r.includes("mm")&&(c.minute={start:r.indexOf("mm"),end:r.indexOf("mm")+2,format:"mm",min:0,max:59}),r.includes("ss")&&(c.second={start:r.indexOf("ss"),end:r.indexOf("ss")+2,format:"ss",min:0,max:59}),r.includes("AA"),r.includes("AA")&&(c.session={...P(H),start:r.indexOf("AA"),end:r.indexOf("AA")+2,format:"AA"}),c}function G(r,c){const h=ue(r),f=P(H);for(const T in h){const{start:R,end:C,format:N,max:p,min:M}=h[T];if(c>=R&&c<=C){f.start=R,f.end=C,f.format=N,f.min=M,f.max=p;break}}return f}function Ee(r,c,h,f){return r.substring(0,h)+c+r.substring(f)}const ee=(r,c,h=1)=>{const f=[];for(;r<=c;)f.push(r),r=r+h;return f},J=(r,c,h)=>{const f=r[h],T=f==null?void 0:f.type,R=T?f==null?void 0:f.items.findIndex(C=>{var N;return C.toString().padStart(2,"0")===((N=c[T])==null?void 0:N.toString())}):"0";return`${h}-${R}`},Oe=50;function ce(r){const{isOpen:c=!0,hourStep:h=1,minuteStep:f=1,value:T=U,hasFooter:R=!0,isUncontrolledComponent:C=!0,views:N=ie,isReadOnly:p,minTimeDropdownValue:M=U,onItemClick:O,onOkClick:b,onEscapeKeyDown:K}=r,x=d.useRef(null),v=d.useRef(null),[g,B]=d.useState([]),[L,n]=d.useState(""),[y,E]=d.useState(U);d.useEffect(()=>{const a=[],w=N.findIndex(u=>u==="sessions")!==-1;N.forEach(u=>{switch(u){case"hours24":a.push({default:"00",items:ee(0,23,h),type:"hour"});break;case"hours12":a.push({default:"01",items:ee(1,w?11:12,h),type:"hour"});break;case"minutes":a.push({default:"00",items:ee(0,59,f),type:"minute"});break;case"seconds":a.push({default:"00",items:ee(0,59,1),type:"second"});break;case"sessions":a.push({default:oe,items:Se,type:"session"});break}}),B(a)},[N,h,f]),d.useEffect(()=>{E(T||U)},[T]),d.useEffect(()=>{c?(n(a=>{const[w]=a.split("-");return J(g,y,w?Number(w):0)}),x.current&&(x.current.style.minWidth=`${g.length*Oe}px`)):n("")},[c,y,g]);const V=d.useCallback((a,w)=>()=>{if(p)return;const u=P(y);u[w]=a,Object.keys(y).map(I=>{if(I!==w&&!y[I]){const $=g.find(ne=>ne.type===I);$&&(u[I]=$.default)}}),C&&E(u),O(u)},[p,y,C,g,O]),_=()=>{b&&b()},Q=(a,w)=>{var D;const[u]=L.split("-");if(!L)n(J(g,y,a));else{const I=g[Number(u)],$=(D=x.current)==null?void 0:D.querySelector(`.cdg-timepicker-dropdown-item__${u}-${w}`);I&&!($!=null&&$.disabled)&&n(`${u}-${w}`)}},q=(a=!1)=>{var D;const[w]=L.split("-"),u=a?g.length-1:0;if(document.activeElement===v.current){n(J(g,y,u));return}if(L){const I=a?Number(w)-1:Number(w)+1;g[I]?n(J(g,y,I)):R?((D=v.current)==null||D.focus(),n("")):n(J(g,y,u))}},o=a=>{if(!c)return;const[w,u]=L.split("-"),D=g[Number(w)],I=(D==null?void 0:D.items.length)||0;switch(a.code){case"ArrowUp":if(a.stopPropagation(),a.preventDefault(),D){const $=Number(u)-1>=0?(Number(u)-1)%I:I-1;Q(0,$)}break;case"ArrowDown":a.stopPropagation(),a.preventDefault(),D&&Q(0,(Number(u)+1)%I);break;case"Tab":a.stopPropagation(),a.preventDefault(),q(a.shiftKey);break;case"Escape":K==null||K();break}};return S.jsxs("div",{onKeyDown:o,ref:x,className:`cdg-time-picker-dropdown-wrapper ${j.timePickerDropdownWrapper}`,children:[S.jsx("div",{className:`cdg-time-picker-dropdown-wrapper ${j.timePickerDropdownContent}`,children:g.map((a,w)=>S.jsx("div",{className:`${j.timePickerDropdownControl} cdg-time-picker-dropdown-control`,children:a.items.map((u,D)=>S.jsx(Me,{itemId:`${w}-${D}`,focusingItemId:L,isOpen:c,selectedDisplayList:y,time:u.toString().padStart(2,"0"),selectedTime:y[a.type],minTime:M[a.type],displayDataType:a.type,onClickItem:V},u))},w))}),R&&S.jsx("div",{className:`${j.timePickerDropdownFooter}`,children:S.jsx(Ie,{variant:"ghost",onClick:_,tabIndex:-1,ref:v,children:"OK"})})]})}const $e=te.memo(ce);ce.__docgenInfo={description:"",methods:[],displayName:"TimePickerDropdown",props:{isOpen:{required:!1,tsType:{name:"boolean"},description:""},value:{required:!1,tsType:{name:"Record",elements:[{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:`Record<
  SelectedKey,
  string | number | null
>`},description:""},hourStep:{required:!1,tsType:{name:"number"},description:""},minuteStep:{required:!1,tsType:{name:"number"},description:""},hasFooter:{required:!1,tsType:{name:"boolean"},description:""},isReadOnly:{required:!1,tsType:{name:"boolean"},description:""},views:{required:!1,tsType:{name:"Array",elements:[{name:"union",raw:`| 'hours12'
| 'hours24'
| 'minutes'
| 'seconds'
| 'sessions'`,elements:[{name:"literal",value:"'hours12'"},{name:"literal",value:"'hours24'"},{name:"literal",value:"'minutes'"},{name:"literal",value:"'seconds'"},{name:"literal",value:"'sessions'"}]}],raw:"ViewType[]"},description:""},isUncontrolledComponent:{required:!0,tsType:{name:"boolean"},description:""},minTimeDropdownValue:{required:!1,tsType:{name:"Record",elements:[{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:`Record<
  SelectedKey,
  string | number | null
>`},description:""},onItemClick:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: TimePickerDropdownSelectedDisplayList) => void",signature:{arguments:[{type:{name:"Record",elements:[{name:"union",raw:"'hour' | 'minute' | 'second' | 'session'",elements:[{name:"literal",value:"'hour'"},{name:"literal",value:"'minute'"},{name:"literal",value:"'second'"},{name:"literal",value:"'session'"}]},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:`Record<
  SelectedKey,
  string | number | null
>`},name:"value"}],return:{name:"void"}}},description:""},onOkClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEscapeKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const le=te.forwardRef((r,c)=>{const{css:h={},className:f,value:T,hourStep:R=1,minuteStep:C=1,hasFooter:N=!0,formatTime:p="hh:mm AA",views:M=ie,defaultValue:O,minTime:b="",isFloatingPortal:K=!0,onTimeChange:x,onOpenChange:v,...g}=r,[B,L]=d.useState(!1),[n,y]=d.useState(P(H)),[E,V]=d.useState(P(U)),[_,Q]=d.useState(P(U)),q=d.useMemo(()=>!!O||!O&&!T,[O,T]),o=d.useRef(null),a=d.useRef(null),w=ye(c),u=d.useMemo(()=>ue(p),[p]);d.useEffect(()=>{if(b&&E){const{hour:e,minute:s,second:l,session:m}=u,t={hour:b.substring(e.start,e.end),minute:b.substring(s.start,s.end),second:b.substring(l.start,l.end),session:b.substring(m.start,m.end)};t.session&&t.session===E.session||!t.session?Number(E.hour)>Number(t.hour)?(t.minute="0",t.second="0",t.session=""):Number(E.minute)>Number(t.minute)&&(t.second="0",t.session=""):t.session==="PM"&&E.session==="AM"?(t.hour="-",t.minute="-",t.second="-",t.session="PM"):(t.hour="0",t.minute="0",t.second="0",t.session=""),Q(t)}},[b,E,u]),d.useEffect(()=>{const e=T??O;if(o.current&&(o.current.value=e??""),e){const{hour:s,minute:l,second:m,session:t}=u;V({hour:e.substring(s.start,s.end),minute:e.substring(l.start,l.end),second:e.substring(m.start,m.end),session:e.substring(t.start,t.end)})}else V(P(U))},[T,O,u]);const D=d.useCallback(e=>{if(q&&V(e),o.current){const s=p.replace("hh",String(e.hour).padStart(2,"0")).replace("HH",String(e.hour).padStart(2,"0")).replace("mm",String(e.minute).padStart(2,"0")).replace("ss",String(e.second).padStart(2,"0")).replace("AA",String(e.session));q&&(o.current.value=s),x&&x(s)}},[p,q,x]),I=d.useCallback(()=>{const{hour:e,minute:s,second:l,session:m}=u,t={hour:b.substring(e.start,e.end),minute:b.substring(s.start,s.end),second:b.substring(l.start,l.end),session:b.substring(m.start,m.end)};let k=!1;const i={...E};(Number(i.hour)<Number(_.hour)||_.hour==="-")&&(k=!0,i.hour=t.hour),(Number(i.minute)<Number(_.minute)||_.minute==="-")&&(k=!0,i.minute=t.minute),(Number(i.second)<Number(_.second)||_.second==="-")&&(k=!0,i.second=t.second),i.session==="AM"&&_.session==="PM"&&(k=!0,i.session="PM");const F=p.replace("hh",String(i.hour).padStart(2,"0")).replace("HH",String(i.hour).padStart(2,"0")).replace("mm",String(i.minute).padStart(2,"0")).replace("ss",String(i.second).padStart(2,"0")).replace("AA",String(i.session));k&&q&&o.current&&(o.current.value=F),k&&(V(i),x&&x(F))},[p,q,b,_.hour,_.minute,_.second,_.session,x,E,u]),$=d.useCallback((e=!1)=>s=>{var l,m;!B&&e||(s==null||s.preventDefault(),s==null||s.stopPropagation(),!((l=o.current)!=null&&l.value)||((m=o.current)==null?void 0:m.value)===p?(o.current&&(o.current.value=""),V(P(U))):I(),e&&(L(!1),v==null||v(!1)),y(P(H)))},[p,B,v,I]),ne=e=>{e.preventDefault(),se()},me=e=>{e.preventDefault(),se()},se=()=>{g.isReadOnly||g.isDisabled||setTimeout(()=>{if(o.current){o.current.value||(o.current.value=p);const e=o.current.selectionStart??0,s=G(p,e);y(s),o.current.setSelectionRange(s.start,s.end)}})},de=e=>{var W,Z;if(!o.current||e.code==="Tab"||g.isReadOnly||g.isDisabled||(e.preventDefault(),e.stopPropagation(),!q&&!x))return;let l=!1;const m=o.current.value,t=m.split(""),k=+`${t[n.start]}${t[n.end-1]}`,i=p.substring(n.start,n.end),F=m.substring(n.start,n.end),Y=n.end-3,A=n.end+2;switch(e.code){case"Backspace":X(m,i,{start:n.start,end:n.end},n);break;case"Space":break;case"ArrowLeft":if(Y<=0)return;{const z=G(p,Y);y(z),(W=o.current)==null||W.setSelectionRange(z.start,z.end)}break;case"ArrowRight":if(A>p.length)return;{const z=G(p,A);y(z),(Z=o.current)==null||Z.setSelectionRange(z.start,z.end)}break;case"ArrowUp":re("up",n.format,k,m,F,"AM");break;case"ArrowDown":re("down",n.format,k,m,F,"PM");break;default:n.format==="AA"?(e.key.toLowerCase()==="a"||e.key.toLowerCase()==="p")&&X(m,`${e.key.toUpperCase()}M`,{start:n.start,end:n.end},n):(l=/\d/.test(e.key),l&&pe(m,t,e.key,A));break}},pe=(e="",s=[],l,m=0)=>{let t="";const k=P(n);let i=P(k);+`${s[n.start]}${s[n.end-1]}${l}`<=n.max?(t=`${s[n.end-1]??"0"}${l}`,i=G(p,m)):(t=`0${l}`,+`${s[n.end-1]}0`>=n.max&&(i=G(p,m))),i.format?y(i):i=k,X(e,t,{start:k.start,end:k.end},i)},re=(e,s,l,m,t,k)=>{if(!o.current)return;let i="";const F=e==="up";if(s==="AA")["pm","am"].includes(t.toLowerCase())?i=t.toUpperCase()==="PM"?"AM":"PM":i=k.toUpperCase();else{const Y=F?n.min:n.max;if(isNaN(l))i=Y.toString().padStart(2,"0")??"00";else if(F){const A=l+1>n.max?n.min:l+1;i=(A==null?void 0:A.toString().padStart(2,"0"))??"00"}else{const A=l-1<n.min?n.max:l-1;i=(A==null?void 0:A.toString().padStart(2,"0"))??"00"}}X(m,i,{start:n.start,end:n.end},n)},X=(e,s,l,m)=>{if(!o.current)return;o.current.value=Ee(e,s,l.start,l.end);const{hour:t,minute:k,second:i,session:F}=u;V({hour:o.current.value.substring(t.start,t.end),minute:o.current.value.substring(k.start,k.end),second:o.current.value.substring(i.start,i.end),session:o.current.value.substring(F.start,F.end)}),Object.keys(u).some(A=>{var Z;const W=u[A];return W.format&&W.format===((Z=o.current)==null?void 0:Z.value.substring(W.start,W.end))})||x&&x(o.current.value||""),o.current.setSelectionRange(m.start,m.end)},fe=e=>{e.stopPropagation(),e.preventDefault(),!g.isDisabled&&L(s=>(v==null||v(!s),!s))},he=()=>{I(),L(!1),v==null||v(!1)},ge=d.useCallback(()=>{var e;(e=a.current)==null||e.focus()},[]);return S.jsx(ke,{css:h,childrenRef:w,children:S.jsx("div",{ref:w,className:`${f} ${j.timePickerContainer} cdg-time-picker-container`,children:S.jsx(we,{anchor:S.jsx(be,{inputRef:o,onFocus:ne,onBlur:$(),onClick:me,onKeyDown:de,placeholder:p,className:`${j.timePickerInput} cdg-time-picker-input`,rightIcon:S.jsx("button",{onClick:fe,className:`${j.timePickerInputIcon} cdg-time-picker-input-icon`,disabled:g.isDisabled,ref:a,children:S.jsx("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:S.jsx("path",{d:"M7.34375 4.28125C7.34375 3.91758 7.63633 3.625 8 3.625C8.36367 3.625 8.65625 3.91758 8.65625 4.28125V7.65L10.9887 9.20312C11.2895 9.40547 11.3715 9.81289 11.1473 10.1137C10.9695 10.4145 10.5621 10.4965 10.2613 10.2723L7.63633 8.52227C7.45312 8.42383 7.34375 8.21875 7.34375 7.97539V4.28125ZM8 1C11.8664 1 15 4.13359 15 8C15 11.8664 11.8664 15 8 15C4.13359 15 1 11.8664 1 8C1 4.13359 4.13359 1 8 1ZM2.3125 8C2.3125 11.1418 4.8582 13.6875 8 13.6875C11.1418 13.6875 13.6875 11.1418 13.6875 8C13.6875 4.8582 11.1418 2.3125 8 2.3125C4.8582 2.3125 2.3125 4.8582 2.3125 8Z"})})}),...g}),attachToElement:w.current&&w.current.parentElement,direction:"bottom-left",offset:8,isOpen:B,onOutsidePress:$(!0),isFloatingPortal:K,children:S.jsx($e,{isUncontrolledComponent:q,views:M,isOpen:B,value:E,onItemClick:D,onOkClick:he,hourStep:R,minuteStep:C,hasFooter:N,isReadOnly:!!g.isReadOnly,onEscapeKeyDown:ge,minTimeDropdownValue:_})})})})});le.__docgenInfo={description:"",methods:[],displayName:"TimePicker"};le.displayName="TimePicker";export{le as T};
