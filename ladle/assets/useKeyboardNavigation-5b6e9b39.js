import{r as d,R as v,j as b}from"./index-a83a88d1.js";function T(s,e){return`${s} returned \`undefined\`. Seems you forgot to wrap component within ${e}`}function _(s={}){const{name:e,strict:t=!0,hookName:n="useContext",providerName:r="Provider",errorMessage:i,defaultValue:a}=s,u=d.createContext(a);u.displayName=e;function h(){const l=d.useContext(u);if(!l&&t){const f=new Error(i??T(n,r));throw f.name="ContextError",Error.captureStackTrace(f,h),f}return l}return[u.Provider,h,u]}function C(s){return s.sort((e,t)=>{const n=e.compareDocumentPosition(t);if(n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(n&Node.DOCUMENT_POSITION_DISCONNECTED||n&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}const M=s=>typeof s=="object"&&"nodeType"in s&&s.nodeType===Node.ELEMENT_NODE;function E(s,e,t){let n=s+1;return t&&n>=e&&(n=0),n}function m(s,e,t){let n=s-1;return t&&n<0&&(n=e),n}const I=typeof window<"u"?d.useLayoutEffect:d.useEffect,x=s=>s;class S{constructor(){this.descendants=new Map,this.register=e=>{if(e!=null)return M(e)?this.registerNode(e):t=>{this.registerNode(t,e)}},this.unregister=e=>{this.descendants.delete(e);const t=C(Array.from(this.descendants.keys()));this.assignIndex(t)},this.destroy=()=>{this.descendants.clear()},this.assignIndex=e=>{this.descendants.forEach(t=>{const n=e.indexOf(t.node);t.index=n,t.node.dataset.index=t.index.toString()})},this.count=()=>this.descendants.size,this.enabledCount=()=>this.enabledValues().length,this.values=()=>Array.from(this.descendants.values()).sort((t,n)=>t.index-n.index),this.enabledValues=()=>this.values().filter(e=>!e.disabled),this.item=e=>{if(this.count()!==0)return this.values()[e]},this.enabledItem=e=>{if(this.enabledCount()!==0)return this.enabledValues()[e]},this.first=()=>this.item(0),this.firstEnabled=()=>this.enabledItem(0),this.last=()=>this.item(this.descendants.size-1),this.lastEnabled=()=>{const e=this.enabledValues().length-1;return this.enabledItem(e)},this.indexOf=e=>{var t;return e?((t=this.descendants.get(e))==null?void 0:t.index)??-1:-1},this.enabledIndexOf=e=>e==null?-1:this.enabledValues().findIndex(t=>t.node.isSameNode(e)),this.next=(e,t=!0)=>{const n=E(e,this.count(),t);return this.item(n)},this.nextEnabled=(e,t=!0)=>{const n=this.item(e);if(!n)return;const r=this.enabledIndexOf(n.node),i=E(r,this.enabledCount(),t);return this.enabledItem(i)},this.prev=(e,t=!0)=>{const n=m(e,this.count()-1,t);return this.item(n)},this.prevEnabled=(e,t=!0)=>{const n=this.item(e);if(!n)return;const r=this.enabledIndexOf(n.node),i=m(r,this.enabledCount()-1,t);return this.enabledItem(i)},this.registerNode=(e,t)=>{if(!e||this.descendants.has(e))return;const n=Array.from(this.descendants.keys()).concat(e),r=C(n);t!=null&&t.disabled&&(t.disabled=!!t.disabled);const i={node:e,index:-1,...t};this.descendants.set(e,i),this.assignIndex(r)}}}function p(s,e){if(s!=null){if(typeof s=="function"){s(e);return}try{s.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${s}'`)}}}function w(...s){return e=>{s.forEach(t=>{p(t,e)})}}function R(){const s=d.useRef(new S);return I(()=>()=>s.current.destroy()),s.current}const[k,g]=_({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function A(s){const e=g(),[t,n]=d.useState(-1),r=d.useRef(null);I(()=>()=>{r.current&&e.unregister(r.current)},[]),I(()=>{if(!r.current)return;const a=Number(r.current.dataset.index);t!=a&&!Number.isNaN(a)&&n(a)});const i=x(s?e.register(s):e.register);return{descendants:e,index:t,enabledIndex:e.enabledIndexOf(r.current),register:w(i,r)}}function F(){return[x(k),()=>x(g()),()=>R(),r=>A(r)]}const K=()=>{const[s,e]=v.useState(0),[t,n,r,i]=d.useMemo(()=>F(),[]);return{provider:{descendants:r(),selected:s,setSelected:e},selected:s,setSelected:e,DescendantsProvider:t,useDescendantsContext:n,useDescendants:r,useDescendant:i}},D=v.createContext({}),U=s=>{const{children:e,descendants:t,selected:n,setSelected:r}=s,{DescendantsProvider:i}=K(),a=()=>{const o=t.nextEnabled(n);o&&(o.node.focus(),r(o.index))},u=()=>{const o=t.prevEnabled(n);o&&(o.node.focus(),r(o.index))},h=o=>{var c;return(c=t.item(o))==null?void 0:c.node},l=()=>{r(0)},f=o=>c=>{const P=c.key;if(o){const N=o[P];N==null||N(c)}},y=o=>()=>{var c;r==null||r(o),(c=h(o))==null||c.focus()},O=o=>()=>{r==null||r(o)};return b(i,{value:t,children:b(D.Provider,{value:{selected:n,descendants:t,setSelected:r,nextFocus:a,prevFocus:u,getNode:h,resetFocus:l,onKeyDown:f,onMouseMove:y,onFocus:O},children:e})})},V=()=>d.useContext(D);export{U as K,V as a,K as u};
