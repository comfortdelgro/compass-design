import{r as h,s as ne,R as q,j as m,a as _}from"./index.e3899799.js";import{C as de,R as X}from"./components.4c1d79c8.js";import{f as ie,$ as j,c as fe}from"./module.b1a9d0e8.js";import{i as oe,j as be,e as me}from"./module.28cfaed6.js";import{a as le}from"./module.815400b7.js";import{$ as he}from"./module.db58b5a1.js";import{a as O,b as G,$ as ge}from"./module.cf5939ca.js";import{e as ae,H as pe}from"./real-module.7a6cb59a.js";import{u as ue}from"./use-dom-ref.6cfb0b91.js";const W=new WeakMap;function H(n,t){let e=W.get(n);if(!e)throw new Error("Unknown slider state");return`${e}-${t}`}function $e(n,t,e){let{labelProps:a,fieldProps:D}=le(n),l=n.orientation==="vertical";var w;W.set(t,(w=a.id)!==null&&w!==void 0?w:D.id);let{direction:V}=ae(),{addGlobalListener:d,removeGlobalListener:g}=ie();const s=h.exports.useRef(null),P=h.exports.useRef(null);P.current=t;const R=V==="rtl",u=h.exports.useRef(null),{moveProps:C}=oe({onMoveStart(){u.current=null},onMove({deltaX:i,deltaY:T}){let{height:f,width:v}=e.current.getBoundingClientRect(),x=l?f:v;u.current==null&&(u.current=P.current.getThumbPercent(s.current)*x);let M=l?T:i;if((l||R)&&(M=-M),u.current+=M,s.current!=null&&e.current){const L=O(u.current/x,0,1);P.current.setThumbPercent(s.current,L)}},onMoveEnd(){s.current!=null&&(P.current.setThumbDragging(s.current,!1),s.current=null)}});let p=h.exports.useRef(void 0),y=(i,T,f,v)=>{if(e.current&&!n.isDisabled&&t.values.every((x,M)=>!t.isThumbDragging(M))){let{height:x,width:M,top:L,left:A}=e.current.getBoundingClientRect(),B=l?x:M,K=((l?v:f)-(l?L:A))/B;(V==="rtl"||l)&&(K=1-K);let o=t.getPercentValue(K),c,$=t.values.findIndex(E=>o-E<0);if($===0)c=$;else if($===-1)c=t.values.length-1;else{let E=t.values[$-1],r=t.values[$];Math.abs(E-o)<Math.abs(r-o)?c=$-1:c=$}c>=0&&t.isThumbEditable(c)?(i.preventDefault(),s.current=c,t.setFocusedThumb(c),p.current=T,t.setThumbDragging(s.current,!0),t.setThumbValue(c,o),d(window,"mouseup",S,!1),d(window,"touchend",S,!1),d(window,"pointerup",S,!1)):s.current=null}},S=i=>{var T,f;((f=i.pointerId)!==null&&f!==void 0?f:(T=i.changedTouches)===null||T===void 0?void 0:T[0].identifier)===p.current&&(s.current!=null&&(t.setThumbDragging(s.current,!1),s.current=null),g(window,"mouseup",S,!1),g(window,"touchend",S,!1),g(window,"pointerup",S,!1))};return"htmlFor"in a&&a.htmlFor&&(delete a.htmlFor,a.onClick=()=>{var i;(i=document.getElementById(H(t,0)))===null||i===void 0||i.focus(),be("keyboard")}),{labelProps:a,groupProps:{role:"group",...D},trackProps:j({onMouseDown(i){i.button!==0||i.altKey||i.ctrlKey||i.metaKey||y(i,void 0,i.clientX,i.clientY)},onPointerDown(i){i.pointerType==="mouse"&&(i.button!==0||i.altKey||i.ctrlKey||i.metaKey)||y(i,i.pointerId,i.clientX,i.clientY)},onTouchStart(i){y(i,i.changedTouches[0].identifier,i.changedTouches[0].clientX,i.changedTouches[0].clientY)},style:{position:"relative",touchAction:"none"}},C),outputProps:{htmlFor:t.values.map((i,T)=>H(t,T)).join(" "),"aria-live":"off"}}}function Te(n,t){let{index:e,isRequired:a,validationState:D,trackRef:l,inputRef:w,orientation:V=t.orientation}=n,d=n.isDisabled||t.isDisabled,g=V==="vertical",{direction:s}=ae(),{addGlobalListener:P,removeGlobalListener:R}=ie(),u=W.get(t);var C;const{labelProps:p,fieldProps:y}=le({...n,id:H(t,e),"aria-labelledby":`${u} ${(C=n["aria-labelledby"])!==null&&C!==void 0?C:""}`.trim()}),S=t.values[e],i=h.exports.useCallback(()=>{w.current&&fe(w.current)},[w]),T=t.focusedThumb===e;h.exports.useEffect(()=>{T&&i()},[T,i]);const f=h.exports.useRef(null);f.current=t;let v=s==="rtl",x=h.exports.useRef(null),{keyboardProps:M}=me({onKeyDown(o){let{getThumbMaxValue:c,getThumbMinValue:$,decrementThumb:E,incrementThumb:r,setThumbValue:b,setThumbDragging:k,pageSize:U}=f.current;if(!/^(PageUp|PageDown|Home|End)$/.test(o.key)){o.continuePropagation();return}switch(o.preventDefault(),k(e,!0),o.key){case"PageUp":r(e,U);break;case"PageDown":E(e,U);break;case"Home":b(e,$(e));break;case"End":b(e,c(e));break}k(e,!1)}}),{moveProps:L}=oe({onMoveStart(){x.current=null,f.current.setThumbDragging(e,!0)},onMove({deltaX:o,deltaY:c,pointerType:$,shiftKey:E}){const{getThumbPercent:r,setThumbPercent:b,decrementThumb:k,incrementThumb:U,step:J,pageSize:Q}=f.current;let{width:se,height:ce}=l.current.getBoundingClientRect(),Z=g?ce:se;if(x.current==null&&(x.current=r(e)*Z),$==="keyboard")o>0&&v||o<0&&!v||c>0?k(e,E?Q:J):U(e,E?Q:J);else{let N=g?c:o;(g||v)&&(N=-N),x.current+=N,b(e,O(x.current/Z,0,1))}},onMoveEnd(){f.current.setThumbDragging(e,!1)}});t.setThumbEditable(e,!d);const{focusableProps:A}=he(j(n,{onFocus:()=>t.setFocusedThumb(e),onBlur:()=>t.setFocusedThumb(void 0)}),w);let B=h.exports.useRef(void 0),F=o=>{i(),B.current=o,t.setThumbDragging(e,!0),P(window,"mouseup",I,!1),P(window,"touchend",I,!1),P(window,"pointerup",I,!1)},I=o=>{var c,$;(($=o.pointerId)!==null&&$!==void 0?$:(c=o.changedTouches)===null||c===void 0?void 0:c[0].identifier)===B.current&&(i(),t.setThumbDragging(e,!1),R(window,"mouseup",I,!1),R(window,"touchend",I,!1),R(window,"pointerup",I,!1))},z=t.getThumbPercent(e);(g||s==="rtl")&&(z=1-z);let K=d?{}:j(M,L,{onMouseDown:o=>{o.button!==0||o.altKey||o.ctrlKey||o.metaKey||F()},onPointerDown:o=>{o.button!==0||o.altKey||o.ctrlKey||o.metaKey||F(o.pointerId)},onTouchStart:o=>{F(o.changedTouches[0].identifier)}});return{inputProps:j(A,y,{type:"range",tabIndex:d?void 0:0,min:t.getThumbMinValue(e),max:t.getThumbMaxValue(e),step:t.step,value:S,disabled:d,"aria-orientation":V,"aria-valuetext":t.getThumbValueLabel(e),"aria-required":a||void 0,"aria-invalid":D==="invalid"||void 0,"aria-errormessage":n["aria-errormessage"],onChange:o=>{f.current.setThumbValue(e,parseFloat(o.target.value))}}),thumbProps:{...K,style:{position:"absolute",[g?"top":"left"]:`${z*100}%`,transform:"translate(-50%, -50%)",touchAction:"none"}},labelProps:p,isDragging:t.isThumbDragging(e),isDisabled:d,isFocused:T}}const ve=0,we=100,Pe=1;function xe(n){const{isDisabled:t=!1,minValue:e=ve,maxValue:a=we,numberFormatter:D,step:l=Pe,orientation:w="horizontal"}=n;let V=h.exports.useMemo(()=>{let r=(a-e)/10;return r=G(r,0,r+l,l),Math.max(r,l)},[l,a,e]),d=h.exports.useMemo(()=>te(n.value),[n.value]);var g;let s=h.exports.useMemo(()=>(g=te(n.defaultValue))!==null&&g!==void 0?g:[e],[n.defaultValue,e]),P=re(n.value,n.defaultValue,n.onChange),R=re(n.value,n.defaultValue,n.onChangeEnd);const[u,C]=ge(d,s,P),[p,y]=h.exports.useState(new Array(u.length).fill(!1)),S=h.exports.useRef(new Array(u.length).fill(!0)),[i,T]=h.exports.useState(void 0),f=h.exports.useRef(null);f.current=u;const v=h.exports.useRef(null);v.current=p;function x(r){return(r-e)/(a-e)}function M(r){return r===0?e:u[r-1]}function L(r){return r===u.length-1?a:u[r+1]}function A(r){return S.current[r]}function B(r,b){S.current[r]=b}function F(r,b){if(t||!A(r))return;const k=M(r),U=L(r);b=G(b,k,U,l),f.current=ee(f.current,r,b),C(f.current)}function I(r,b){if(t||!A(r))return;const k=v.current[r];v.current=ee(v.current,r,b),y(v.current),R&&k&&!v.current.some(Boolean)&&R(f.current)}function z(r){return D.format(r)}function K(r,b){F(r,c(b))}function o(r){return Math.round((r-e)/l)*l+e}function c(r){const b=r*(a-e)+e;return O(o(b),e,a)}function $(r,b=1){let k=Math.max(b,l);F(r,G(u[r]+k,e,a,l))}function E(r,b=1){let k=Math.max(b,l);F(r,G(u[r]-k,e,a,l))}return{values:u,getThumbValue:r=>u[r],setThumbValue:F,setThumbPercent:K,isThumbDragging:r=>p[r],setThumbDragging:I,focusedThumb:i,setFocusedThumb:T,getThumbPercent:r=>x(u[r]),getValuePercent:x,getThumbValueLabel:r=>z(u[r]),getFormattedValue:z,getThumbMinValue:M,getThumbMaxValue:L,getPercentValue:c,isThumbEditable:A,setThumbEditable:B,incrementThumb:$,decrementThumb:E,step:l,pageSize:V,orientation:w,isDisabled:t}}function ee(n,t,e){return n[t]===e?n:[...n.slice(0,t),e,...n.slice(t+1)]}function te(n){if(n!=null)return Array.isArray(n)?n:[n]}function re(n,t,e){return a=>{typeof n=="number"||typeof t=="number"?e==null||e(a[0]):e==null||e(a)}}const ye=ne("div",{position:"relative",touchAction:"none",".slider-track-wrapper":{position:"relative",width:"100%",".slider-rail":{position:"absolute",backgroundColor:"$cdgBlue10",borderRadius:"$full",height:"$1",width:"100%"},".slider-filled-rail":{position:"absolute",backgroundColor:"$cdgBlue100",height:"$1",borderRadius:"$full",left:"0"},".slider-track":{position:"relative",height:"$1",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"}}}),De=ne("div",{display:"flex",position:"absolute",alignItems:"center",flexDirection:"column",transform:"translateX(-50%)",zIndex:1,".slider-thumb-handle":{width:"$4",height:"$4",cursor:"pointer",borderRadius:"50%",boxSizing:"border-box",border:"2px solid $cdgBlue10",backgroundColor:"$background",boxShadow:"0 0 4px rgba(0, 0, 0, 0.16)"},".slider-value":{position:"absolute",width:"$16",height:"$16",color:"$whiteText",borderRadius:"$md",backgroundColor:"$gray110",fontSize:"$header4",fontWeight:"$bold",display:"flex",justifyContent:"center",alignItems:"center",bottom:"$6","&:after":{content:"",position:"absolute",width:"$4",height:"$4",transform:"rotate(45deg)",borderRadius:"$md 0",backgroundColor:"$gray110",bottom:"-$2"}}}),Ve=q.forwardRef((n,t)=>{var u,C;const{css:e={},...a}=n,D=q.useRef(null),l=ue(t),w=pe(n.formatOptions),V={...a,onChangeEnd:p=>{var y;return(y=n.onChangeEnd)==null?void 0:y.call(n,typeof p=="number"?p:p[0]?p[0]:0)},onChange:p=>{var y;return(y=n.onChange)==null?void 0:y.call(n,typeof p=="number"?p:p[0]?p[0]:0)}},d=xe({...V,numberFormatter:w}),{groupProps:g,trackProps:s}=$e(V,d,D),P=(u=d.values[0])!=null?u:0,R=(C=n.minValue)!=null?C:0;return m(ye,{...g,ref:l,css:e,children:_("div",{className:"slider-track-wrapper",children:[m("div",{className:"slider-rail"}),m("div",{className:"slider-filled-rail",style:{left:`${d.getValuePercent(Math.min(P,R))*100}%`,width:`${(d.getValuePercent(Math.max(P,R))-d.getValuePercent(Math.min(P,R)))*100}%`}}),m("div",{...s,ref:D,className:"slider-track",children:m(Re,{state:d,trackRef:D})})]})})}),Re=q.forwardRef((n,t)=>{var s;const{state:e,trackRef:a}=n,D=(s=e.values[0])!=null?s:0,l=ue(t),w={index:0,trackRef:a,inputRef:l},{thumbProps:V,inputProps:d,isDragging:g}=Te(w,e);return _(De,{style:{left:`${e.getThumbPercent(0)*100}%`},children:[m("div",{...V,className:"slider-thumb-handle",children:m("input",{ref:l,...d,style:{display:"none"}})}),g&&m("div",{className:"slider-value",children:D})]})}),Y=Ve,ze=()=>{const[n,t]=h.exports.useState(20);return _(de,{children:[m("h1",{children:"Slider"}),m(X,{children:_("div",{style:{width:"100%",marginBottom:"2rem"},children:[m("h3",{children:"Uncontrolled slider"}),m(Y,{})]})}),m(X,{children:_("div",{style:{width:"100%",marginBottom:"2rem"},children:[m("h3",{children:"Controlled slider"}),m(Y,{value:n,onChange:e=>t(e)})]})}),m(X,{children:_("div",{style:{width:"100%",marginBottom:"2rem"},children:[m("h3",{children:"Disabled slider"}),m(Y,{isDisabled:!0})]})})]})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{ze as Sliders};
