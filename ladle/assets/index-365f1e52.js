import{S as Be,a as Me,B as ne,b as oe,c as Ie,P as Ee,D as We}from"./index.styles-145fe16b.js";import{I as Ke,p as Oe,a as Ne,t as je,L as ze,D as ie,b as Ae}from"./utils-3f82ed7c.js";import{u as He,a as Te,b as Pe,D as _e,c as Ze,z as Ue}from"./floating-ui.react.esm-7cc589ff.js";import{s as E,R as o,a as m,j as e,F as Y}from"./index-2a259d11.js";import{S as ee}from"./dropdown.styles-8f282b3c.js";import{u as N}from"./use-dom-ref-c21a8ae3.js";const Ve=E("div",{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:"$6",height:"$6",variants:{isSelected:{true:{div:{border:0,background:"$cdgBlue100",svg:{display:"block"}}},false:{svg:{display:"none"}}},checkmark:{checkbox:{div:{border:"1px solid #323130",borderRadius:"3px",width:"$4",height:"$4",display:"flex",alignItems:"center",justifyContent:"center",background:"#FFFFFF"}},none:{},tick:{}}}});function re({item:i,currentKeys:a,focusKey:h,disabledKeys:l,onSelect:c}){const u=o.useRef(null),{checkmark:f="checkbox"}=i.props,s=o.useMemo(()=>i.key?a.some(d=>d==i.key):!1,[a]),g=o.useMemo(()=>h==i.key,[h]),w=o.useMemo(()=>i.key?l.includes(i.key):!1,[l]),b=()=>{i.key&&!w&&c(i.key)};return o.useEffect(()=>{var d;g&&((d=u.current)==null||d.scrollIntoView({block:"nearest"}))},[g]),m(Be,{ref:u,isFocused:g,isSelected:s,onClick:b,isDisabled:w,children:[e(Me,{children:i.props.children}),e(Ve,{isSelected:s,checkmark:f,children:f==="checkbox"?e("div",{children:e(Xe,{})}):f==="tick"?e(qe,{}):null})]})}const Xe=()=>e("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:e("path",{d:"M9.39158 1.86239C9.64736 2.12284 9.64736 2.54372 9.39158 2.80416L4.15319 8.13808C3.89741 8.39853 3.48407 8.39853 3.22829 8.13808L0.608522 5.47112C0.352823 5.21068 0.352823 4.7898 0.608522 4.52935C0.864262 4.26891 1.27883 4.26891 1.53461 4.52935L3.67232 6.72334L8.46668 1.86239C8.72246 1.60153 9.1358 1.60153 9.39158 1.86239Z",fill:"white"})}),qe=()=>e("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M15.0265 3.47966C15.4357 3.89637 15.4357 4.56978 15.0265 4.98649L6.64506 13.5208C6.23581 13.9375 5.57446 13.9375 5.16521 13.5208L0.973587 9.25363C0.564469 8.83691 0.564469 8.16351 0.973587 7.74679C1.38277 7.33008 2.04608 7.33008 2.45533 7.74679L5.87567 11.2572L13.5466 3.47966C13.9559 3.06228 14.6172 3.06228 15.0265 3.47966Z",fill:"#0142AF"})});function Ge(i){const a=o.useRef(null),{focusKey:h,isLoading:l,collection:c,currentKeys:u,disabledKeys:f,rootChildren:s,listBoxRef:g=a,sectionCollection:w,onSelect:b,onLoadMore:d}=i;return e(ne,{isLoading:l,listBoxRef:g,collection:c,sectionCollection:w,rootChildren:s,onLoadMore:d,renderOptions:v=>v.map(C=>m("div",{children:[C.title&&e(oe,{children:C.title}),C.children.map(R=>R?e(re,{item:R,focusKey:h,currentKeys:u,disabledKeys:f,onSelect:b},R.key):null)]},C.id))})}const se=E("div",{maxWidth:"100%",minHeight:"$11",borderRadius:"$md",cursor:"text",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"$1_5 $4",gap:"$1",backgroundColor:"#FFFFFF",transition:"$default",borderWidth:"1px",borderStyle:"solid",borderColor:"#E6E6E6",".dropdown-icon":{cursor:"pointer",flexShrink:0,display:"flex",justifyContent:"center",alignItems:"center",padding:0,border:"none",background:"transparent",svg:{width:"$4",height:"$4"}},"&:focus-within":{borderColor:"$cdgBlue"},input:{height:"$6_5",width:4,padding:0,margin:0,border:"none","&:focus":{outline:"none"},"&:focus-visible":{outline:"none"}},variants:{isEmpty:{true:{button:{p:{color:"#B4B4B4"}}}},isDisabled:{true:{backgroundColor:"$gray20","*":{color:"$disabledText",cursor:"not-allowed !important"}}},isErrored:{true:{borderColor:"$danger","&:focus-within":{borderColor:"$danger"}}}}}),le=E("div",{flexGrow:1,alignItems:"center",minHeight:"$7",display:"flex",gap:"$2_5",flexWrap:"wrap",".placeholder":{color:"#B4B4B4",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:"$label1",fontWeight:"$semibold",maxWidth:"100%",height:"fit-content",lineHeight:"1em",border:"none",textAlign:"left",padding:0,margin:0}}),Je=E("div",{border:"1px solid #E6E6E6",borderRadius:"$full",padding:"$1 $3",fontSize:"$label1",cursor:"default",fontWeight:"$semibold",display:"flex",justifyContent:"center",alignItems:"center",gap:"$2",div:{width:"fit-content",height:"fit-content"}}),Qe=E("div",{width:"100%",label:{fontSize:"$label1",fontWeight:"$semibold",marginBottom:"$2",display:"inline-block",width:"100%",span:{marginLeft:"$1",color:"$danger"}},variants:{displayedValue:{chip:{},string:{[`${le}`]:{flexWrap:"nowrap",justifyContent:"flex-start",maxWidth:"calc(100% - 1rem - 1rem)",".itemListString":{maxWidth:"100%",height:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}}},variant:{combobox:{},select:{[`${se}`]:{cursor:"pointer"}}}}}),Ye=o.forwardRef((i,a)=>{const{collection:h,rootChildren:l,sectionCollection:c,listBoxRef:u,isLoading:f,numberOfRows:s,onLoadMore:g}=i,w=N(a);return s&&s>=0?e(Ie,{ref:w,children:e(ne,{isLoading:f,collection:h,listBoxRef:u,rootChildren:l,sectionCollection:c,renderOptions:b=>b.slice(0,Math.min(s,h.length)).map(d=>m("div",{children:[d.title&&e(oe,{children:d.title}),d.children.map(v=>v?e(re,{item:v,focusKey:void 0,currentKeys:[],disabledKeys:[],onSelect:()=>{}},v.key):null)]},d.id)),onLoadMore:g})}):null}),et=Ye,tt=()=>m("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:[e("g",{clipPath:"url(#clip0_5299_13653)",children:e("path",{d:"M9.11731 7.88215C9.45908 8.22392 9.45908 8.77759 9.11731 9.11936C8.94779 9.29024 8.72359 9.375 8.49938 9.375C8.27518 9.375 8.05153 9.28956 7.88092 9.11867L4.99966 6.23892L2.11867 9.11799C1.94779 9.29024 1.72386 9.375 1.49993 9.375C1.276 9.375 1.05235 9.29024 0.881328 9.11799C0.539557 8.77622 0.539557 8.22255 0.881328 7.88078L3.76313 4.99897L0.881328 2.11854C0.539557 1.77677 0.539557 1.2231 0.881328 0.881328C1.2231 0.539557 1.77677 0.539557 2.11854 0.881328L4.99966 3.7645L7.88146 0.882695C8.22323 0.540925 8.7769 0.540925 9.11867 0.882695C9.46044 1.22446 9.46044 1.77813 9.11867 2.1199L6.23687 5.00171L9.11731 7.88215Z",fill:"#3B3A39"})}),e("defs",{children:e("clipPath",{id:"clip0_5299_13653",children:e("rect",{width:"10",height:"10",fill:"white"})})})]});function te(i,a,h){if(a!=null&&a.length>=0){const l=[];for(const c of a)l.push(c);return l}else if(i!=null&&i.length>0&&h){const l=[];for(const c of i)l.push(c);return l}return[]}const nt=o.forwardRef((i,a)=>{const{id:h=`cdg-element-${Math.random().toString(36).substring(2)}`,css:l={},isOpen:c,children:u,isErrored:f,isDisabled:s,isRequired:g,isReadOnly:w,helperText:b,defaultOpen:d,errorMessage:v,selectedKeys:C,numberOfRows:R,displayedValue:W="chip",icon:ce=e(Ke,{}),disabledKeys:D=[],isLoading:z=!1,variant:Z="combobox",customDisplayValue:A,defaultSelectedKeys:U=[],label:de,placeholder:ae,onLoadMore:ue=()=>{},onBlur:he=()=>{},onFocus:fe=()=>{},onSelectionChange:H=()=>{},onOpenChange:T=()=>{},...pe}=i,[$,k]=o.useState(!1),[ge,V]=o.useState(!1),[F,ye]=o.useState(""),[y,X]=o.useState(te(U,C)),[p,B]=o.useState(),me=N(a),K=N(null),M=N(null),we=o.useRef(null),be=o.useRef(null),q=o.useRef(null),{refs:G,floatingStyles:ve,context:Ce}=He({open:$,onOpenChange:k,middleware:[_e(8),Ze()],whileElementsMounted:Ue}),xe=Te(Ce),{getReferenceProps:ke,getFloatingProps:Se}=Pe([xe]),x=o.useMemo(()=>Oe(u,ie),[u]),J=o.useMemo(()=>Ne(u),[u]),I=o.useMemo(()=>F===""?x:x.filter(t=>{const n=je(t);return n==null?void 0:n.toLowerCase().includes(F.toLowerCase())}),[x,F]),O=o.useMemo(()=>new ze(I,D),[I,D]),L=o.useMemo(()=>{const t=[];return x.length>0&&y&&y.length>0&&y.forEach(n=>{const r=x.find(S=>S.key==n);r&&t.push({key:n,rendered:r==null?void 0:r.props.children})}),t},[y,x,y.length]);o.useEffect(()=>{X(te(U,C,!0))},[JSON.stringify(C),x]),o.useEffect(()=>{!c&&d&&k(d),c&&k(c)},[c]),o.useEffect(()=>{var t,n;B([...y].pop()),T==null||T($),$?(t=M.current)==null||t.focus():(n=M.current)==null||n.blur()},[$]);const $e=t=>{if(K.current){const n=t.target.value;if(ye(n),k(!0),n!==""){const r=document.createElement("div");r.style.position="absolute",r.style.top="0",r.style.left="-9999px",r.style.overflow="hidden",r.style.visibility="hidden",r.style.whiteSpace="nowrap",r.style.height="0",r.style.width="fit-content",r.style.maxWidth=`${K.current.clientWidth-62}px`,r.innerHTML=n.replace(/\s/g,"&nbsp;"),document.body.appendChild(r),t.target.focus(),t.target.style.width=`${r.clientWidth+4}px`,r.remove()}else t.target.style.width="4px"}},Le=t=>{switch(t.key){case"ArrowUp":case"ArrowLeft":{t.preventDefault();const n=p!=null&&p!=-1?O.getKeyAbove(p):O.getFirstKey();n&&B(n);break}case"ArrowDown":case"ArrowRight":{t.preventDefault();const n=p!=null&&p!=-1?O.getKeyBelow(p):O.getFirstKey();n&&B(n);break}case"Enter":{t.preventDefault(),p&&P(p);break}case"Escape":{t.preventDefault(),k(!1);break}case"Tab":{k(!1);break}}},P=(t,n=!1)=>{var r;if(!w){const S=new Set(y),_=y.find(Fe=>Fe==t);_?(S.delete(_),_==p&&B(Array.from(S).pop()??void 0)):n||(S.add(t),B(t)),X([...S]),H==null||H([...S]),(r=M.current)==null||r.focus()}},Re=t=>{P(t,!0)},Q=()=>{var t;s||(k(!0),(t=M.current)==null||t.focus())},De=()=>{const t=L.map(n=>n.rendered);return t.length>0?e(Y,{children:t.join(", ")}):""};return m(Qe,{css:l,ref:me,...pe,displayedValue:W,variant:Z,children:[de&&m("label",{onClick:Q,htmlFor:h,children:[i.label,g&&e("span",{children:"*"})]}),e("div",{ref:G.setReference,...ke,children:m(se,{className:"dropdownContainer",ref:K,isErrored:!!f,isDisabled:!!s,onClick:Q,children:[m(le,{className:"selectedItemWrapper",children:[L.length===0&&F===""&&!$&&!ge&&e("p",{className:"placeholder",children:ae}),W=="chip"&&L.length>0&&L.map(t=>{const n=s||D.includes(t.key);return m(Je,{style:{cursor:s?"not-allowed":"pointer"},className:"multiple-dropdown-chip",children:[e("div",{children:t.rendered}),n?e(Y,{}):e("div",{className:"multiple-dropdown-chip-icon",onClick:()=>{!s&&![...D].includes(t.key)&&Re(t.key)},children:e(tt,{})})]},t.key)}),W=="string"&&A&&L.length>0?e("div",{className:"itemListString",children:A}):W=="string"&&!A&&L.length>0?e("div",{className:"itemListString",children:De()}):null,!s&&Z=="combobox"&&e("input",{id:h,type:"text",ref:M,value:F,onChange:$e,onBlur:()=>V(!1),onFocus:()=>V(!0)})]}),e("div",{className:"dropdown-icon",children:ce})]})}),I&&$&&e("div",{className:"Popover",ref:G.setFloating,style:{...ve,zIndex:60},...Se,children:e(Ee,{isEmpty:z?!1:I.length===0,visualizeRef:q,triggerRef:K,onBlur:he,onFocus:fe,handleKeyDown:Le,children:e(Ge,{focusKey:p,isLoading:z,collection:I,rootChildren:u,listBoxRef:we,currentKeys:y,disabledKeys:D,sectionCollection:J,onSelect:P,onLoadMore:ue})})}),e(et,{ref:be,isLoading:z,collection:x,listBoxRef:q,rootChildren:u,numberOfRows:R,sectionCollection:J,onLoadMore:()=>{}}),f&&v&&e(ee,{error:!!f,children:v}),b&&e(ee,{children:b})]})}),j=nt;j.Item=ie;j.Header=We;j.Section=Ae;j.displayName="MultipleDropdown";export{j as M};
