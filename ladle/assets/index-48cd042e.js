import{R as m,r as t,a as $,j as r,F as ot}from"./index-cd7bbbbd.js";import{P as lt}from"./index-d9823114.js";import{u as Z}from"./use-dom-ref-5e3906fd.js";import{D as he,t as P,a as qe,g as nt,b as Ke,c as Ae,d as He,e as ct,f as it}from"./utils-16d0028b.js";import{S as at,a as We,b as ut,c as dt,d as ft,e as pt,f as bt,g as mt,h as je,i as wt,j as vt,k as ht,l as St,m as yt,n as gt,o as Ue,p as Ct}from"./dropdown.styles-2e0323d1.js";import{p as Dt}from"./pick-child-9cd21fb6.js";const kt=()=>r("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:r("path",{d:"M9.39158 1.86239C9.64736 2.12284 9.64736 2.54372 9.39158 2.80416L4.15319 8.13808C3.89741 8.39853 3.48407 8.39853 3.22829 8.13808L0.608522 5.47112C0.352823 5.21068 0.352823 4.7898 0.608522 4.52935C0.864262 4.26891 1.27883 4.26891 1.53461 4.52935L3.67232 6.72334L8.46668 1.86239C8.72246 1.60153 9.1358 1.60153 9.39158 1.86239Z",fill:"currentColor"})}),xt=()=>r("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",children:r("path",{d:"M15.0265 3.47966C15.4357 3.89637 15.4357 4.56978 15.0265 4.98649L6.64506 13.5208C6.23581 13.9375 5.57446 13.9375 5.16521 13.5208L0.973587 9.25363C0.564469 8.83691 0.564469 8.16351 0.973587 7.74679C1.38277 7.33008 2.04608 7.33008 2.45533 7.74679L5.87567 11.2572L13.5466 3.47966C13.9559 3.06228 14.6172 3.06228 15.0265 3.47966Z",fill:"currentColor"})}),Et=m.forwardRef((b,w)=>{const{children:f,value:n="",flagName:h,type:C,rightIcon:c,leftIcon:D,rightColor:k,css:S={},checkmark:R="none",...H}=b,{textValue:W,...N}=H,{isPositioned:L,open:I,selectedItem:T,disabledKeys:O=[],searchValue:G,focusKey:Y,selectedKey:z,setSelectedItem:ce,setDropdownItemKeys:ee,onItemClick:B}=t.useContext(he),V=Z(w),p=t.useMemo(()=>(T==null?void 0:T.value.toString())===n.toString(),[T,n]),x=t.useMemo(()=>(Y==null?void 0:Y.toString())===n.toString(),[Y,n]),J=t.useMemo(()=>O.findIndex(E=>E.toString()===n.toString())!==-1,[O,n]),te=t.useMemo(()=>!G||P(f).toLocaleLowerCase().includes(G.toLocaleLowerCase()),[G,f]);return t.useEffect(()=>{J||ee==null||ee(E=>{const ie=E.findIndex(u=>u.value.toString()===n.toString());return ie===-1?E.push({value:n,visibility:!0}):E[ie]={value:n,visibility:te},E})},[n,J,te]),t.useEffect(()=>{z&&z.toString()===n.toString()&&ce({value:n.toString(),displayValue:W||f})},[z,n]),t.useEffect(()=>{L&&(x||p&&x)&&V.current&&V.current.scrollIntoView({block:"nearest"})},[L,x,p]),t.useEffect(()=>{p&&L&&V.current&&V.current.scrollIntoView({block:"nearest"})},[L,I,p]),te?$(at,{css:S,isFocused:x&&!p,isSelected:p&&!x,isSelectedFocused:p&&x,isDisabled:J,onClick:()=>{J||B({value:n.toString(),displayValue:W||f,flagName:h??""})},ref:V,role:"option","aria-selected":p,...N,children:[D&&r(We,{children:D}),r(ut,{children:f}),C==="icon"&&c&&r(We,{children:c}),C==="color"&&k&&r(dt,{css:{$$bg:k}}),r(ft,{isSelected:p,checkmark:R,children:R==="checkbox"?r("div",{children:r(kt,{})}):R==="tick"?r(xt,{}):null})]}):null}),Ze=Et;function Lt(){return r(pt,{children:$("div",{className:"spinner",children:[r("div",{className:"spinner-1"}),r("div",{className:"spinner-2"}),r("div",{className:"spinner-3"}),r("div",{})]})})}function It(b){const[w,f]=t.useState(!1),n=t.useMemo(()=>new IntersectionObserver(([h])=>f(!!(h!=null&&h.isIntersecting))),[b.current]);return t.useEffect(()=>(b.current&&n.observe(b.current),()=>{n.disconnect()}),[b,n]),w}const Mt=b=>{const{children:w,isLoading:f,css:n={},noDataMessage:h,onLoadMore:C}=b,c=Z(null),D=Z(null),k=It(c),{searchValue:S,labelId:R,isLoadingMore:H}=t.useContext(he),{child:W,rest:N}=Dt(w,qe),L=t.useMemo(()=>{let I=0;return m.Children.map(N,T=>{P(T).toLocaleLowerCase().includes(S.toLocaleLowerCase())&&I++}),I},[N,S]);return t.useEffect(()=>{if(c.current&&D.current){const I=nt(c.current,D.current);k&&I>=0&&I<4&&!H&&(C==null||C())}},[k]),t.useMemo(()=>$(ot,{children:[W&&W,$(bt,{css:n,role:"listbox","aria-labelledby":R,children:[f?r(Lt,{}):L===0?r(mt,{children:h||"No data"}):N,m.Children.toArray(N).length>0&&r(je,{ref:c}),r(je,{ref:D})]})]}),[n,f,L,w])},Rt=Mt,Nt=m.forwardRef((b,w)=>r(_,{...b,ref:w,type:"combobox"})),Vt=Nt,Ft=m.forwardRef((b,w)=>{const{children:f,title:n,isClickable:h,css:C={},onClick:c,...D}=b,k=Z(w);return $(wt,{css:C,ref:k,...D,children:[n&&r(vt,{isClickable:!!h,onClick:()=>{h&&(c==null||c())},children:n}),f]})}),Pt=Ft,$t=m.forwardRef((b,w)=>r(_,{...b,ref:w,type:"select"})),Tt=$t,Bt=()=>r(Ct,{width:"16",height:"16",viewBox:"0 0 16 16",className:"cdg-dropdown-button-icon",children:r("path",{d:"M8.33276 12.3334C8.02004 12.3334 7.70717 12.2125 7.46885 11.9707L1.35805 5.78022C0.880649 5.29658 0.880649 4.5131 1.35805 4.02947C1.83546 3.54584 2.60886 3.54584 3.08626 4.02947L8.33276 9.34651L13.5804 4.03044C14.0578 3.54681 14.8312 3.54681 15.3086 4.03044C15.786 4.51407 15.786 5.29755 15.3086 5.78118L9.19782 11.9717C8.95912 12.2135 8.64594 12.3334 8.33276 12.3334Z",fill:"currentColor"})}),Kt=32,X=()=>{},At=m.forwardRef((b,w)=>{const{id:f=`cdg-element-${Math.random().toString(36).substring(2)}`,css:n={},popoverCSS:h={},children:C,type:c="select",icon:D=r(Bt,{}),placeholder:k,isErrored:S=!1,isRequired:R=!1,isReadOnly:H=!1,isLoading:W=!1,helperText:N,errorMessage:L,numberOfRows:I,disabledKeys:T=[],selectedKey:O="",defaultSelectedKey:G="",disabledValues:Y,value:z="",defaultValue:ce="",defaultOpen:ee=!1,isDisabled:B=!1,shouldDeselect:V=!1,allowsCustomValue:p=!1,disableClearable:x=!1,prefix:J=null,noDataMessage:te="",label:fe,isCloseOnSelect:E=!0,isLoadingMore:ie=!1,onValueChange:u=X,onSelectionChange:d=X,onFocus:pe=X,onBlur:re=X,onLoadMore:_e=X,onOpenChange:i=X,...Ge}=b,j=t.useMemo(()=>ce||G,[ce,G]),se=t.useMemo(()=>z||O,[z,O]),[Ye,ze]=m.useState(!1),[v,U]=m.useState(ee),[s,ae]=m.useState(null),[be,F]=m.useState(null),[Se,q]=t.useState(""),[K,Je]=t.useState([]),[y,Qe]=t.useState(null),oe=Z(w),le=Z(null),a=Z(null),ye=t.useRef(!1),ue=t.useMemo(()=>!!j||!j&&!se,[j]),Xe=t.useMemo(()=>{var e,o;switch(c){case"select":return((e=le.current)==null?void 0:e.clientWidth)??"100%";case"combobox":return((o=a.current)==null?void 0:o.clientWidth)??"100%";default:return"100%"}},[c,v]);t.useEffect(()=>{ye.current?v||F(null):ye.current=!0},[v,p]);const ge=e=>typeof e=="string"?e:m.Children.map(e,o=>{if(!o)return o;if(m.isValidElement(o)){if(o.type===Ze){const M=o;if(!("value"in M.props))return m.cloneElement(M,{value:`${o.key}`||""})}const g=o;if(g.props.children)return m.cloneElement(g,{children:ge(g.props.children)})}return o});t.useEffect(()=>{Qe(ge(C))},[C]);const A=t.useCallback(e=>{ue&&(ae(e),F((e==null?void 0:e.value)??null))},[ue]),me=t.useCallback(e=>{var o,g,M,ne,ke,xe,Ee,Le,Ie,Me,Re,Ne,Ve,Fe,Pe,$e,Te,Be;if(v){const Q=be??(s==null?void 0:s.value.toString())??null;switch(e.key){case"ArrowUp":case"ArrowLeft":if(e.preventDefault(),Q!==null){const l=it(Q??"",y,K),ve=(l==null?void 0:l.props.value)??((o=l==null?void 0:l.key)==null?void 0:o.toString().replace(".$",""))??null;F(ve)}else F(((ne=(M=(g=Ke(y,K))==null?void 0:g.props)==null?void 0:M.value)==null?void 0:ne.toString())??null);break;case"ArrowDown":case"ArrowRight":if(e.preventDefault(),Q!==null){const l=ct(Q??"",y,K),ve=(l==null?void 0:l.props.value)??((ke=l==null?void 0:l.key)==null?void 0:ke.toString().replace(".$",""))??null;F(ve)}else F(((Le=(Ee=(xe=Ae(y,K))==null?void 0:xe.props)==null?void 0:Ee.value)==null?void 0:Le.toString())??null);break;case"Enter":if(e.preventDefault(),Q!==null){q("");const l=He(Q??"",y);if(l){if(E&&U(!1),i==null||i(!1),!x&&V&&(s==null?void 0:s.value)===l.props.value){A(null),d==null||d(""),u==null||u("");return}A({value:((Me=(Ie=l==null?void 0:l.props)==null?void 0:Ie.value)==null?void 0:Me.toString())??"",displayValue:l.props.textValue||l.props.children,flagName:l.props.flagName??""}),a.current&&(a.current.value=P(l.props.children)),d==null||d((Re=l==null?void 0:l.props)==null?void 0:Re.value),u==null||u((Ne=l==null?void 0:l.props)==null?void 0:Ne.value)}}break;case"Escape":case"Tab":U(!1),i==null||i(!1);break;case"Home":e.preventDefault(),F(((Pe=(Fe=(Ve=Ae(y,K))==null?void 0:Ve.props)==null?void 0:Fe.value)==null?void 0:Pe.toString())??null);break;case"End":e.preventDefault(),F(((Be=(Te=($e=Ke(y,K))==null?void 0:$e.props)==null?void 0:Te.value)==null?void 0:Be.toString())??null);break}}else switch(e.key){case"ArrowUp":case"ArrowDown":e.preventDefault(),U(!0),i==null||i(!0);break}},[E,v,x,V,be,y,s,K,u,d,i,A]);t.useEffect(()=>(oe.current&&oe.current.addEventListener("keydown",me),()=>{oe.current&&oe.current.removeEventListener("keydown",me)}),[me]);const de=t.useCallback(()=>{var e;U(o=>!o),i==null||i(!v),(e=a.current)==null||e.focus()},[i,v]),Ce=t.useCallback(e=>{U(!0),i==null||i(!0),q(e.target.value??""),c==="combobox"&&p&&(A(null),d==null||d(""),u==null||u(""))},[ue,c,s,p,i,u,d,A]),De=t.useCallback(()=>{["combobox"].includes(c)&&a.current&&setTimeout(()=>{document.activeElement!==a.current&&a.current&&(p||(s?a.current.value=P(s==null?void 0:s.displayValue):a.current.value=""),q(""))})},[c,s,p,ue]);t.useEffect(()=>{!v&&["combobox"].includes(c)&&a.current&&De()},[v,c,De]),t.useEffect(()=>{var g;if(!y||!se&&!j){ae(null),q(""),!p&&a.current&&(a.current.value=""),F(M=>M??null);return}const e=se||j,o=He(e,y);o&&(ae({value:e.toString(),displayValue:o,flagName:((g=o==null?void 0:o.props)==null?void 0:g.flagName)??""}),a.current&&(a.current.value=P(o)))},[y,se,j,p]);const we=t.useCallback(e=>{re==null||re(e),["combobox"].includes(c)&&a.current&&a.current&&(p||(s?a.current.value=P(s==null?void 0:s.displayValue):a.current.value=""),q(""))},[re,s,c,p]),Oe=t.useMemo(()=>{switch(c){case"select":return r(St,{isEmpty:!s,className:"cdg-dropdown-input",role:"button",isErrored:!!S,isDisabled:B,"aria-required":R,children:$("button",{id:f,type:"button",ref:le,disabled:B,onClick:de,onBlur:we,onFocus:pe,className:"cdg-dropdown-button",children:[J,r("span",{children:s?P(s==null?void 0:s.displayValue):k}),D]})});case"combobox":return $(ht,{isEmpty:!s,className:"cdg-dropdown-input",role:"button",isErrored:!!S,isDisabled:B,"aria-required":R,children:[r("input",{id:f,ref:a,readOnly:H,disabled:B,placeholder:k,onChange:Ce,onBlur:we,onFocus:pe,onClick:de,"aria-autocomplete":"list",role:"combobox","aria-invalid":S,"aria-expanded":v}),r("button",{type:"button",tabIndex:-1,disabled:B,onClick:de,className:"cdg-dropdown-button",children:D})]});default:return null}},[v,c,f,k,s,S,B,H,re,pe,de,Ce,we]),et=e=>{var o,g;if(!H){if(E&&U(!1),i==null||i(!1),q(""),setTimeout(()=>{var M,ne;(M=a.current)==null||M.focus(),(ne=le.current)==null||ne.focus()},0),!x&&!e.value){A(null),d==null||d(""),u==null||u("");return}if(!x&&V&&(s==null?void 0:s.value)===e.value){A(null),d==null||d(""),u==null||u("");return}(s==null?void 0:s.value)!==e.value&&(d==null||d(e.value),u==null||u(e.value)),A(e),["combobox"].includes(c)?(a.current&&(a.current.value=P(e.displayValue),E?a.current.blur():(o=a.current)==null||o.focus()),q(P(e.displayValue))):(g=le.current)==null||g.focus()}},tt=()=>{setTimeout(()=>{var e,o;(e=a.current)==null||e.focus(),(o=le.current)==null||o.focus()},0)},rt=t.useCallback(()=>{U(!1),i==null||i(!1)},[i]),st=t.useCallback(e=>{ze(e)},[]);return $(yt,{className:`${v?"cdg-dropdown-opening":""}`,css:n,ref:oe,...Ge,children:[fe&&$("label",{htmlFor:f,id:`${f}-label`,children:[fe,R&&r("span",{children:"*"})]}),r(he.Provider,{value:{isLoadingMore:ie,isPositioned:Ye,open:v,focusKey:be,selectedKey:se,defaultSelectedKey:j,disabledKeys:Y??T??[],searchValue:Se,labelId:`${f}-label`,selectedItem:s,setSelectedItem:ae,dropdownItemKeys:K,setDropdownItemKeys:Je,onItemClick:et,onHeaderClick:tt},children:r(lt,{isOpen:v,anchor:Oe,css:{width:"100%"},direction:"bottom-left",onClose:rt,onPositionedChange:st,children:r(gt,{css:{...h,width:h.width??Xe},children:r(Rt,{searchValue:Se,isLoading:W,css:{maxHeight:I?`${I*Kt}px`:"16rem"},onLoadMore:_e,noDataMessage:te,children:y})})})}),S&&L&&r(Ue,{error:!!S,children:L}),N&&r(Ue,{children:N})]})}),_=At;_.Item=Ze;_.Select=Tt;_.ComboBox=Vt;_.Section=Pt;_.Header=qe;export{_ as D};
