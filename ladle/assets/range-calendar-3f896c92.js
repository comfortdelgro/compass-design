import{$ as le,e as j,N as J,_ as K,M as X,X as Q,L as ie,a0 as oe,b as z,O as ce,P as ue,T as ee,m as de,q as fe,d as be,s as ge,h as me,K as M}from"./import-1ca76cd5.js";import{s as E,r as v,j as p,R as ve,a as L,F as ae}from"./index-5f8fa73a.js";import{B as $e}from"./index-dd38a980.js";import"./index-cebd16dc.js";import{i as m,b as xe,A as te,l as he,v as pe,d as De,G as Re,B as Ve,H as ne,I as ye,J as Ce,o as Se,E as Fe,F as re}from"./useCalendarState-8c42177e.js";import{u as we,a as U}from"./useEvent-199493c6.js";import{u as Pe}from"./use-dom-ref-86ceca89.js";import{B as Y}from"./button-7df0a78f.js";const ke=E("div",{padding:"$3 $4 $3 $4",display:"flex",flexDirection:"column",maxWidth:"193px",width:"100%",borderRight:"1px solid #F5F5F5"}),Te=E("button",{margin:0,padding:"$3 $4",width:"100%",maxWidth:"160px",fontSize:"$label1",textAlign:"left",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"$button","&:hover":{borderRadius:"6px",backgroundColor:"$gray20",fontWeight:"bold"},"&:focus-visible":{outline:"none",borderRadius:"6px",boxShadow:"0px 0px 0px 4px #F2F4F7"},"&:disabled":{backgroundColor:"transparent",fontWeight:"$normal",cursor:"not-allowed"},variants:{variants:{active:{backgroundColor:"$cdgBlue10",borderRadius:"6px","&:focus-visible":{backgroundColor:"$cdgBlue10",boxShadow:"0px 0px 0px 4px #F2F4F7"}},inactive:{}}},defaultVariants:{variants:"inactive"}}),Be=n=>{const[e,d]=v.useState(null),[u,$]=v.useState(null),{state:t,customShortcuts:b=y=>y}=n,{locale:l}=le();v.useEffect(()=>{var y,B;!(u!=null&&u.start)||!u.end||e&&((y=t.value.end)==null?void 0:y.compare(u.end))!==0&&((B=t.value.start)==null?void 0:B.compare(u.start))!==0&&d(null)},[t.value]);const s=new Intl.DateTimeFormat(l).resolvedOptions().timeZone,i=j(s),a=i.subtract({days:1}),D=i.subtract({weeks:1}),f=i.subtract({months:1}),r=J(i,l),R=K(i,l),g=J(D,l),x=K(D,l),k=X(i),S=Q(i),F=X(f),c=Q(f),w=ie(i),C=oe(i),V=[{label:"Today",isDisable:(()=>m(i,t.minValue,t.maxValue))(),getValue:()=>({end:i,start:i})},{label:"Yesterday",isDisable:(()=>m(a,t.minValue,t.maxValue))(),getValue:()=>({end:a,start:a})},{label:"This Week",isDisable:(()=>m(r,t.minValue,t.maxValue)||m(R,t.minValue,t.maxValue))(),getValue:()=>({start:r,end:R})},{label:"Last Week",isDisable:(()=>m(g,t.minValue,t.maxValue)||m(x,t.minValue,t.maxValue))(),getValue:()=>({start:g,end:x})},{label:"This Month",isDisable:(()=>m(k,t.minValue,t.maxValue)||m(S,t.minValue,t.maxValue))(),getValue:()=>({start:k,end:S})},{label:"Last Month",isDisable:(()=>m(F,t.minValue,t.maxValue)||m(c,t.minValue,t.maxValue))(),getValue:()=>({start:F,end:c})},{label:"This Year",isDisable:(()=>m(w,t.minValue,t.maxValue)||m(C,t.minValue,t.maxValue))(),getValue:()=>({start:w,end:C})}];return{shorcuts:b(V,y=>m(y,t.minValue,t.maxValue)),selectedItem:e,setSelectedItem:d,setCurrentRangeDate:$}},Ie=n=>{const{state:e,pickerState:d}=n,{shorcuts:u,selectedItem:$,setSelectedItem:t,setCurrentRangeDate:b}=Be(n),l=s=>{var a;const i=s.getValue();d?d.setDateRange(i):e.setValue(i),i.end&&((a=e.setFocusedDate)==null||a.call(e,i.end)),t(s.label),b(i),e.setAnchorDate(null)};return p(ke,{children:u&&u.map(s=>p(Te,{"aria-disabled":s.isDisable,type:"button",variants:$===s.label?"active":"inactive",disabled:s.isDisable,onClick:()=>l(s),children:s.label},s.label))})},Me=Ie;function Oe(n,e){var D,f,r,R;const d=xe(n);if(e.visibleRange==null)return{};const u=te(e.visibleRange.start,e.timeZone??"UTC"),$=te(e.visibleRange.start,e.timeZone??"UTC"),t=we([!!n.errorMessage,n.validationState]);he.set(e,{ariaLabel:n["aria-label"]??"",ariaLabelledBy:n["aria-labelledby"],errorMessageId:t});const b=v.useRef(!1),l=n.isDisabled||((D=e.isNextVisibleRangeInvalid)==null?void 0:D.call(e));l&&b.current&&(b.current=!1,(f=e.setFocused)==null||f.call(e,!0));const s=v.useRef(!1),i=n.isDisabled||((r=e.isPreviousVisibleRangeInvalid)==null?void 0:r.call(e));i&&s.current&&(s.current=!1,(R=e.setFocused)==null||R.call(e,!0));const a=pe({id:n.id,"aria-label":[n["aria-label"],$].filter(Boolean).join(", "),"aria-labelledby":n["aria-labelledby"]});return{calendarProps:{...d,...a,role:"group","aria-describedby":n["aria-describedby"]||void 0},nextButtonProps:{onPress:()=>{var g;return(g=e.focusNextPage)==null?void 0:g.call(e)},"aria-label":"next",isDisabled:l,onFocus:()=>b.current=!0,onBlur:()=>b.current=!1},prevButtonProps:{onPress:()=>{var g;return(g=e.focusPreviousPage)==null?void 0:g.call(e)},"aria-label":"previous",isDisabled:i,onFocus:()=>s.current=!0,onBlur:()=>s.current=!1},title:u}}function Ae(n,e,d){const u=Oe(n,e),$=v.useRef(!1),t=v.useRef(typeof window<"u"?window:null);U(t,"pointerdown",l=>{$.current=l.width===0&&l.height===0});const b=l=>{var a;if($.current){$.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;const s=l.target,i=document.getElementById(u.calendarProps.id);i&&i.contains(document.activeElement)&&(!i.contains(s)||!s.closest('button, [role="button"]'))&&((a=e.selectFocusedDate)==null||a.call(e))};return U(t,"pointerup",b),U(t,"pointercancel",b),u.calendarProps.onBlur=l=>{var s;(!l.relatedTarget||!d.current.contains(l.relatedTarget))&&e.anchorDate&&((s=e.selectFocusedDate)==null||s.call(e))},U(d,"touchmove",l=>{e.isDragging&&l.preventDefault()},{passive:!1,capture:!0}),u}function We(n){var W,G,H,_;const{value:e,defaultValue:d,onChange:u,createCalendar:$,locale:t,visibleDuration:b={months:1},minValue:l,maxValue:s,...i}=n,[a,D]=De(e,d||null,u),[f,r]=v.useState(a!=null&&a.start&&!a.end?a==null?void 0:a.start:null);let R="center";if(a&&a.start&&a.end){const h=Re(z(a.start),b,t,l,s).add(b).subtract({days:1});a.end.compare(h)>0&&(R="start")}const g=v.useRef(null),[x,k]=v.useState(),S=v.useMemo(()=>ce(l,x==null?void 0:x.start),[l,x]),F=v.useMemo(()=>ue(s,x==null?void 0:x.end),[s,x]),c=Ve({...i,value:a&&a.start,createCalendar:$,locale:t,visibleDuration:b,minValue:S,maxValue:F,selectionAlignment:R}),w=o=>{o&&n.isDateUnavailable&&!n.allowsNonContiguousRanges?(g.current={start:ne(o,c,-1),end:ne(o,c,1)},k(g.current)):(g.current=null,k(void 0))},C=v.useRef(c.visibleRange);(!ee((W=c.visibleRange)==null?void 0:W.start,(G=C.current)==null?void 0:G.start)||!ee((H=c.visibleRange)==null?void 0:H.end,(_=C.current)==null?void 0:_.end))&&(w(f),C.current=c.visibleRange);const V=o=>{o?(r(o),w(o)):(r(null),w(null))},T=f?Z(f,c.focusedDate):a&&Z(a.start,a.end),O=o=>{var h;if(!n.isReadOnly&&(o=ye(o,S,F),o=Ce(o,(h=c.visibleRange)==null?void 0:h.start,n.isDateUnavailable),!!o))if(!f)V(o),u==null||u({start:o,end:null});else if(f.compare(o)>0)V(o),u==null||u({start:o,end:null});else{const P=Z(f,o);D({start:se(P.start,a==null?void 0:a.start),end:se(P.end,a==null?void 0:a.end)}),V(null)}},[y,B]=v.useState(!1),{isDateUnavailable:I}=n,N=v.useMemo(()=>!a||f?!1:I&&(I(a.start)||I(a.end))?!0:m(a.start,l,s)||m(a.end,l,s),[I,a,f,l,s]),A=n.validationState||(N?"invalid":null);return{...c,value:a,setValue:D,anchorDate:f,setAnchorDate:V,highlightedRange:T,validationState:A,selectFocusedDate(){O(c.focusedDate)},selectDate:O,highlightDate(o){var h;f&&((h=c.setFocusedDate)==null||h.call(c,o))},isSelected(o){var h,P;return T&&o.compare(T.start)>=0&&o.compare(T.end)<=0&&!((h=c.isCellDisabled)!=null&&h.call(c,o))&&!((P=c.isCellUnavailable)!=null&&P.call(c,o))},isInvalid(o){var h,P,q;return((h=c.isInvalid)==null?void 0:h.call(c,o))||m(o,(P=g.current)==null?void 0:P.start,(q=g.current)==null?void 0:q.end)},isDragging:y,setDragging:B}}function Z(n,e){return!n||!e?null:(e.compare(n)<0&&([n,e]=[e,n]),{start:z(n),end:z(e)})}function se(n,e){return n=de(n,(e==null?void 0:e.calendar)||new fe),e&&"hour"in e?e.set(n):n}const Le=E("div",{width:"fit-content",backgroundColor:"$background",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.08)",borderRadius:"$md",padding:"$4","& .calendar-body":{display:"flex",justifyContent:"space-between",gap:"$2"},"& .calendar-footer":{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"$6",paddingTop:"$6",borderTop:"1px solid $gray40",color:"$primaryText"},"& .calendar-footer .calendar-footer-right-side":{display:"flex",alignItems:"center",gap:"$4"},"& .calendar-footer .preview-date":{margin:0,fontSize:"$body3"},"& .calendar-footer button":{padding:"$1 $2_5",height:"$8",fontSize:"$label2"},variants:{variants:{extend:{display:"flex",flexDirection:"row",padding:0,"& > div:nth-child(2)":{padding:"$4"}},basic:{}}},defaultVariants:{variants:"basic"}});E("div",{display:"flex",flexDirection:"row"});const Ne=ve.forwardRef((n,e)=>{var O,y,B,I,N;const{state:d,hasFooter:u,css:$={},maxValue:t=be("2999-02-17"),hasShortcuts:b=!1,ctaButtonRender:l,visibleMonths:s=2,onSearchButtonClick:i,customShortcuts:a,...D}=n,{locale:f}=le(),r=We({...D,value:n.state?(O=n.state)==null?void 0:O.value:n.value,visibleDuration:{months:s},locale:f,createCalendar:ge}),R=Pe(e),{calendarProps:g,prevButtonProps:x,nextButtonProps:k}=Ae(D,r,R),S=me({}),{setIsReset:F}=Se(),c=()=>{r.setValue({start:null,end:null}),r.setAnchorDate(null),F==null||F(!0)},w=()=>{var W;const A={start:j(M()),end:j(M())};d?d==null||d.setDateRange(A):r.setValue(A),r.setAnchorDate(null),(W=r.setFocusedDate)==null||W.call(r,j(M()))},C=s!==1,V=!!(C&&b),T=v.useCallback(()=>l||(V?p(Y,{variant:"primary",onPress:A=>i==null?void 0:i(A),children:"Search"}):p(Y,{variant:"primary",onPress:w,children:"Today"})),[l,V]);return L(Le,{ref:R,css:$,variants:V?"extend":"basic",children:[V?p(Me,{state:r,pickerState:d,customShortcuts:a}):p(ae,{}),L($e,{children:[p(Fe,{state:r,variant:C?"range":"default",calendarProps:g,prevButtonProps:x,nextButtonProps:k}),L("div",{className:"calendar-body",children:[p(re,{state:r,maxValue:t}),C?p(re,{state:r,offset:{months:1},maxValue:t}):p(ae,{})]}),u&&L("div",{className:"calendar-footer",children:[p(Y,{variant:"ghost",onPress:c,children:"Clear"}),L("div",{className:"calendar-footer-right-side",children:[p("p",{className:"preview-date",children:(y=r==null?void 0:r.value)!=null&&y.start&&((B=r==null?void 0:r.value)!=null&&B.end)?S.formatRange(r.value.start.toDate(M()),r.value.end.toDate(M())):`${(I=r==null?void 0:r.value)!=null&&I.start?S.format(r.value.start.toDate(M())):""} - ${(N=r==null?void 0:r.value)!=null&&N.end?S.format(r.value.end.toDate(M())):""}`}),T()]})]})]})]})}),_e=Ne;export{_e as R};
