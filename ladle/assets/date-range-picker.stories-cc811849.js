import{r as L,s as ee,R as N,j as n,a as w,F as le}from"./index-bac5e390.js";import"./index-8f02f36d.js";import"./index-4293f143.js";import{u as re,a as se,b as ie,c as de,d as oe,D as z,P as ue,e as ce}from"./useOverlayTriggerState-458e4572.js";import{u as he,a as be,b as A,c as me,f as fe,r as De,d as ye,e as ge,i as H,g as B,h as Q,D as _,t as J,j as X,k as Ce,p as Se,l as Y}from"./useCalendarState-46760d69.js";import{u as Pe,R as Oe}from"./range-calendar-4c876098.js";import{u as Ve}from"./use-dom-ref-c2dd4c70.js";import{C as ae}from"./calendar-e190267a.js";import{B as ve}from"./button-4f431114.js";import{C as Fe}from"./components-f6bdc2da.js";import"./useEvent-fa6332d8.js";import"./import-103c32e0.js";import"./arrow-right-c6e15097.js";import"./index-e2938966.js";function Me(e,l,d){var t,s;const{labelProps:o,fieldProps:c,descriptionProps:u,errorMessageProps:a}=re({...e,labelElementType:"span"}),h=c["aria-labelledby"]||c.id,{locale:O}=he(),m=l.formatValue(O,{month:"long"}),y=m?`selectedRangeDescription ${m.start} ${m.end}`:"",f=be(y),i={"aria-label":"startDate","aria-labelledby":h},D={"aria-label":"endDate","aria-labelledby":h},r=A(),V=A(),S=se(l,d),g=[f["aria-describedby"],c["aria-describedby"]].filter(Boolean).join(" ")||void 0,v=L.useMemo(()=>me(d,{accept:b=>b.id!==r}),[d,r]),M={[fe]:v,[De]:"presentation","aria-describedby":g,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:l.validationState},R=ye(e),{focusWithinProps:x}=ie({...e,isDisabled:l.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...R,...S,...c,...f,...x,role:"group","aria-disabled":e.isDisabled||null,"aria-describedby":g,onKeyDown(b){l.isOpen||e.onKeyDown&&e.onKeyDown(b)},onKeyUp(b){l.isOpen||e.onKeyUp&&e.onKeyUp(b)}},labelProps:{...o,onClick:()=>{v.focusFirst()}},buttonProps:{...f,id:r,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${h} ${r}`,"aria-describedby":g,"aria-expanded":l.isOpen||void 0,onPress:()=>l.setOpen(!0)},dialogProps:{id:V,"aria-labelledby":`${h} ${r}`},startFieldProps:{...i,...M,value:(t=l.value)==null?void 0:t.start,onChange:b=>l.setDateTime("start",b),autoFocus:e.autoFocus},endFieldProps:{...D,...M,value:(s=l.value)==null?void 0:s.end,onChange:b=>l.setDateTime("end",b)},descriptionProps:u,errorMessageProps:a,calendarProps:{autoFocus:!0,value:l.dateRange,onChange:l.setDateRange,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,allowsNonContiguousRanges:e.allowsNonContiguousRanges,defaultFocusedValue:l.dateRange?void 0:e.placeholderValue,validationState:l.validationState,errorMessage:e.errorMessage}}}function Re(e){var R,x;const l=de(e),[d,o]=ge(e.value,e.defaultValue||null,e.onChange);let[c,u]=L.useState(()=>d||{start:null,end:null});d==null&&c.start&&c.end&&(c={start:null,end:null},u(c));const a=d||c,h=t=>{u(t),t.start||t.end?o(t):o(null)},O=a.start||a.end||e.placeholderValue,[m]=oe(O,e.granularity),y=m==="hour"||m==="minute"||m==="second",f=e.shouldCloseOnSelect??!0;let[i,D]=L.useState(null),[r,V]=L.useState(null);a&&a.start&&a.end&&(i=a,"hour"in a.start&&(r=a));const S=(t,s)=>{t.end&&t.start&&s.end&&s.start&&(h({start:"timeZone"in s.start?s.start.set(J(t.start)):X(t.start,s.start),end:"timeZone"in s.end?s.end.set(J(t.end)):X(t.end,s.end)}),D(null),V(null))},g=t=>{let s=typeof f=="function"?f():f;y?s||t.start&&t.end&&(r!=null&&r.start)&&r.end?S(t,{start:(r==null?void 0:r.start)||B(e.placeholderValue),end:(r==null?void 0:r.end)||B(e.placeholderValue)}):D(t):t.start||t.end?h(t):!t.start||!t.end?(o({start:null,end:null}),D(null)):D(t),s&&t.start&&t.end&&l.setOpen(!1)},v=t=>{i!=null&&i.start&&i.end&&t.start&&t.end?S(i,t):V(t)},M=e.validationState||(a!=null&&(H(a.start,e.minValue,e.maxValue)||H(a.end,e.minValue,e.maxValue)||a.end!=null&&a.start!=null&&a.end.compare(a.start)<0||a.start&&((R=e.isDateUnavailable)!=null&&R.call(e,a.start))||a.end&&((x=e.isDateUnavailable)!=null&&x.call(e,a.end)))?"invalid":null);return{value:a,setValue:h,dateRange:i,timeRange:r,granularity:m,hasTime:y,setDate(t,s){g({...i,[t]:s})},setTime(t,s){v({...r,[t]:s})},setDateTime(t,s){h({...a,[t]:s})},setDateRange:g,setTimeRange:v,...l,setOpen(t){!t&&!(a.start&&a.end)&&(i!=null&&i.start)&&i.end&&y&&S(i,{start:(r==null?void 0:r.start)||B(e.placeholderValue),end:(r==null?void 0:r.end)||B(e.placeholderValue)}),l.setOpen(t)},validationState:M,formatValue(t,s){if(!a||!a.start||!a.end)return null;const b="timeZone"in a.start?a.start.timeZone:void 0,k=e.granularity||(a.start&&"minute"in a.start?"minute":"day"),I="timeZone"in a.end?a.end.timeZone:void 0,Z=e.granularity||(a.end&&"minute"in a.end?"minute":"day"),ne=Q(s,{granularity:k,timeZone:b??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:a.start.calendar.identifier==="gregory"&&a.start.era==="BC"||a.end.calendar.identifier==="gregory"&&a.end.era==="BC"}),K=a.start.toDate(b||"UTC"),j=a.end.toDate(I||"UTC"),E=new _(t,ne);let $;if(b===I&&k===Z&&a.start.compare(a.end)!==0){try{const F=E.formatRangeToParts(K,j);let U=-1;for(let P=0;P<F.length;P++){const W=F[P];if(W.source==="shared"&&W.type==="literal")U=P;else if(W.source==="endRange")break}let G="",q="";for(let P=0;P<F.length;P++)P<U?G+=F[P].value:P>U&&(q+=F[P].value);return{start:G,end:q}}catch{}$=E}else{const F=Q(s,{granularity:Z,timeZone:I??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24});$=new _(t,F)}return{start:E.format(K),end:$.format(j)}}}}const xe=ee("div",{width:"fit-content","@max_768":{"& .date-range-fields":{flexDirection:"column",gap:"$6"},"&":{width:"100%"}}}),Te=ee("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),Le=N.forwardRef((e,l)=>{const{startDateLabel:d,endDateLabel:o,shouldCloseOnSelect:c=!1,css:u={},errorMessage:a,helperText:h,maxValue:O,hasShortcuts:m,ctaButtonRender:y,visibleMonths:f,onSearchButtonClick:i,customShortcuts:D,shouldOnChangeTriggerOnSameDate:r,...V}=e,S=Re({...V,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:c??!1}),g=Ve(l),{labelProps:v,groupProps:M,startFieldProps:R,endFieldProps:x,buttonProps:t,dialogProps:s,calendarProps:b}=Me({...V,isReadOnly:e.isReadOnly?!0:!!e.isMobile,"aria-label":"date range picker","aria-describedby":""},S,g),k={necessityIndicator:e.necessityIndicator,...R},I={necessityIndicator:e.necessityIndicator,...x},Z=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return b.isReadOnly=Z(),n(xe,{ref:g,css:u,className:"date-range-picker-wrapper",children:w(Ce,{children:[n(Ie,{state:S,label:e.label,labelProps:v,groupProps:M,startFieldProps:k,endFieldProps:I,buttonProps:t,startDateLabel:d,endDateLabel:o,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,errorMessage:a,helperText:h}),n(we,{maxValue:O,state:S,calendarRef:g,dialogProps:s,calendarProps:b,hasShortcuts:m,ctaButtonRender:y,shouldOnChangeTriggerOnSameDate:r,onSearchButtonClick:i,customShortcuts:D,css:e.calendarCSS,visibleMonths:f})]})})}),Ie=N.forwardRef((e,l)=>{const{label:d,labelProps:o,groupProps:c,startFieldProps:u,endFieldProps:a,buttonProps:h,startDateLabel:O,endDateLabel:m,isInvalid:y,isMobile:f,isReadOnly:i=!1,errorMessage:D,helperText:r}=e;return w(Te,{children:[n("span",{...o,className:"date-range-label",children:d}),n("div",{...c,ref:l,className:"date-range-inputs-body",children:w("div",{className:"date-range-fields",children:[n(z,{...u,label:O,buttonProps:h,isInvalid:y,isMobile:f,isReadOnly:i,errorMessage:D,helperText:r}),n(z,{...a,label:m,buttonProps:h,isInvalid:y,isMobile:f,isReadOnly:i})]})})]})}),we=e=>{const{state:l,calendarRef:d,dialogProps:o,calendarProps:c,css:u={},hasShortcuts:a=!1,maxValue:h=Se("2999-03-10"),ctaButtonRender:O,visibleMonths:m,shouldOnChangeTriggerOnSameDate:y,onSearchButtonClick:f,customShortcuts:i}=e,{value:D,onChange:r,...V}=c,S=Pe("(max-width: 768px)"),g=v=>{r&&r(v)};return n(le,{children:l.isOpen&&n(ue,{state:l,triggerRef:d,placement:"bottom start",offset:8,children:n(ce,{...o,"aria-describedby":o["aria-describedby"]??"","aria-label":o["aria-label"]??"","aria-labelledby":o["aria-labelledby"]??"",children:n(Oe,{css:u,state:l,hasFooter:!0,"aria-label":"","aria-labelledby":"",...D?{value:D}:{},onChange:g,...V,maxValue:h,hasShortcuts:a,ctaButtonRender:O,shouldOnChangeTriggerOnSameDate:!!y,onSearchButtonClick:f,customShortcuts:i,visibleMonths:m||(S?1:2)})})})})},C=Le,{I18nProvider:te,useDateFormatter:ke}=ae.I18N,{getLocalTimeZone:T,parseDate:p}=ae.InternationalizedDate,_e=()=>n(te,{locale:"en-SG",children:w(Fe,{children:[n("h3",{children:"Basic"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date"}),n("br",{}),n("h3",{children:"Disabled"}),n(C,{isDisabled:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Read only"}),n(C,{isReadOnly:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Invalid"}),n(C,{isInvalid:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Min & Max"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date",minValue:Y(T()).add({days:1}),maxValue:Y(T()).add({days:7})}),n("h3",{children:"Max range on first chosen date"}),n(Ze,{}),n("h3",{children:"Is Mobile"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date",isMobile:!0}),n("h3",{children:"Helper texts"}),n(C,{isInvalid:!0,isRequired:!0,helperText:"Weekend is excluded",errorMessage:"Must not include weekend",startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Shortcuts"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date",hasShortcuts:!0}),n("h3",{children:"Custom Shortcuts Range Calendar"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date",hasShortcuts:!0,customShortcuts:e=>{const l=[{label:"Custom Shortcut",getValue:()=>({start:null,end:null})}];return[...e,...l]},ctaButtonRender:n(ve,{onPress:()=>{alert("Custom callback")},children:"Custom Button"})})]})}),Ze=()=>{const[e,l]=L.useState(null),[d,o]=L.useState(null);return n(C,{value:e,onChange:u=>{l(u),u&&u.start&&!u.end&&o(u.start.subtract({days:-30}))},shouldCloseOnSelect:!0,shouldOnChangeTriggerOnSameDate:!0,maxValue:d,onOpenChange:u=>{e!=null&&e.start&&!e.end||u&&o(null)}})},Je=()=>{const[e,l]=N.useState({start:p("2020-02-03"),end:p("2020-02-08")}),d=ke({dateStyle:"long"});return w(te,{locale:"en-SG",children:[n("h3",{children:"Controlled"}),n("p",{children:e.start&&e.end?d.formatRange(e.start.toDate(T()),e.end.toDate(T())):`${e.start&&d.format(e.start.toDate(T()))} - ${e.end&&d.format(e.end.toDate(T()))}`}),n(C,{value:e,shouldCloseOnSelect:!0,startDateLabel:"Start Date",endDateLabel:"End Date",onChange:o=>l(o)})]})},Xe=()=>n(C,{});typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Je as Controlled,Xe as Default,_e as Variants};
