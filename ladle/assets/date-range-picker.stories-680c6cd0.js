import{$ as le,a as A,b as H,c as Q,d as re,e as _}from"./import-50baad70.js";import{r as $,s as ee,R as W,j as n,a as T,F as se}from"./index-bfb0a627.js";import"./index-d7d55ddf.js";import"./index-2109b5ea.js";import{u as ie,a as de,b as oe,c as ce,d as ue,D as q,P as be,e as he}from"./useOverlayTriggerState-4e82a949.js";import{u as fe,a as J,c as me,f as De,r as ye,b as ge,d as Se,i as X,g as E,e as Y,D as Pe}from"./useCalendarState-2c153f61.js";import{R as Ce}from"./range-calendar-ac8a2c3f.js";import{u as ve}from"./use-dom-ref-a6480a3f.js";import{C as te}from"./calendar-92e35940.js";import{C as Ve}from"./components-8d5ba8a7.js";import{B as Me}from"./button-61d1c732.js";import"./clsx.m-30223e4c.js";import"./useEvent-3fc5c807.js";import"./import-76f99fa1.js";import"./index-dfd70e94.js";function xe(e,l,o){var a,s;const{labelProps:u,fieldProps:d,descriptionProps:c,errorMessageProps:t}=ie({...e,labelElementType:"span"}),b=d["aria-labelledby"]||d.id,{locale:V}=le(),h=l.formatValue(V,{month:"long"}),y=h?`selectedRangeDescription ${h.start} ${h.end}`:"",m=fe(y),i={"aria-label":"startDate","aria-labelledby":b},D={"aria-label":"endDate","aria-labelledby":b},r=J(),C=J(),g=de(l,o),v=[m["aria-describedby"],d["aria-describedby"]].filter(Boolean).join(" ")||void 0,x=$.useMemo(()=>me(o,{accept:f=>f.id!==r}),[o,r]),F={[De]:x,[ye]:"presentation","aria-describedby":v,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:l.validationState},O=ge(e),{focusWithinProps:R}=oe({...e,isDisabled:l.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...O,...g,...d,...m,...R,role:"group","aria-disabled":e.isDisabled||null,"aria-describedby":v,onKeyDown(f){l.isOpen||e.onKeyDown&&e.onKeyDown(f)},onKeyUp(f){l.isOpen||e.onKeyUp&&e.onKeyUp(f)}},labelProps:{...u,onClick:()=>{x.focusFirst()}},buttonProps:{...m,id:r,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${b} ${r}`,"aria-describedby":v,"aria-expanded":l.isOpen||void 0,onPress:()=>l.setOpen(!0)},dialogProps:{id:C,"aria-labelledby":`${b} ${r}`},startFieldProps:{...i,...F,value:(a=l.value)==null?void 0:a.start,onChange:f=>l.setDateTime("start",f),autoFocus:e.autoFocus},endFieldProps:{...D,...F,value:(s=l.value)==null?void 0:s.end,onChange:f=>l.setDateTime("end",f)},descriptionProps:c,errorMessageProps:t,calendarProps:{autoFocus:!0,value:l.dateRange,onChange:l.setDateRange,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,allowsNonContiguousRanges:e.allowsNonContiguousRanges,defaultFocusedValue:l.dateRange?void 0:e.placeholderValue,validationState:l.validationState,errorMessage:e.errorMessage}}}function Fe(e){var O,R;const l=ce(e),[o,u]=Se(e.value,e.defaultValue||null,e.onChange);let[d,c]=$.useState(()=>o||{start:null,end:null});o==null&&d.start&&d.end&&(d={start:null,end:null},c(d));const t=o||d,b=a=>{c(a),a.start||a.end?u(a):u(null)},V=t.start||t.end||e.placeholderValue,[h]=ue(V,e.granularity),y=h==="hour"||h==="minute"||h==="second",m=e.shouldCloseOnSelect??!0;let[i,D]=$.useState(null),[r,C]=$.useState(null);t&&t.start&&t.end&&(i=t,"hour"in t.start&&(r=t));const g=(a,s)=>{a.end&&a.start&&s.end&&s.start&&(b({start:"timeZone"in s.start?s.start.set(H(a.start)):Q(a.start,s.start),end:"timeZone"in s.end?s.end.set(H(a.end)):Q(a.end,s.end)}),D(null),C(null))},v=a=>{let s=typeof m=="function"?m():m;y?s||a.start&&a.end&&(r!=null&&r.start)&&r.end?g(a,{start:(r==null?void 0:r.start)||E(e.placeholderValue),end:(r==null?void 0:r.end)||E(e.placeholderValue)}):D(a):a.start||a.end?b(a):!a.start||!a.end?(u({start:null,end:null}),D(null)):D(a),s&&a.start&&a.end&&l.setOpen(!1)},x=a=>{i!=null&&i.start&&i.end&&a.start&&a.end?g(i,a):C(a)},F=e.validationState||(t!=null&&(X(t.start,e.minValue,e.maxValue)||X(t.end,e.minValue,e.maxValue)||t.end!=null&&t.start!=null&&t.end.compare(t.start)<0||t.start&&((O=e.isDateUnavailable)!=null&&O.call(e,t.start))||t.end&&((R=e.isDateUnavailable)!=null&&R.call(e,t.end)))?"invalid":null);return{value:t,setValue:b,dateRange:i,timeRange:r,granularity:h,hasTime:y,setDate(a,s){v({...i,[a]:s})},setTime(a,s){x({...r,[a]:s})},setDateTime(a,s){b({...t,[a]:s})},setDateRange:v,setTimeRange:x,...l,setOpen(a){!a&&!(t.start&&t.end)&&(i!=null&&i.start)&&i.end&&y&&g(i,{start:(r==null?void 0:r.start)||E(e.placeholderValue),end:(r==null?void 0:r.end)||E(e.placeholderValue)}),l.setOpen(a)},validationState:F,formatValue(a,s){if(!t||!t.start||!t.end)return null;const f="timeZone"in t.start?t.start.timeZone:void 0,I=e.granularity||(t.start&&"minute"in t.start?"minute":"day"),w="timeZone"in t.end?t.end.timeZone:void 0,N=e.granularity||(t.end&&"minute"in t.end?"minute":"day"),ne=Y(s,{granularity:I,timeZone:f??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:t.start.calendar.identifier==="gregory"&&t.start.era==="BC"||t.end.calendar.identifier==="gregory"&&t.end.era==="BC"}),K=t.start.toDate(f||"UTC"),G=t.end.toDate(w||"UTC"),k=new A(a,ne);let Z;if(f===w&&I===N&&t.start.compare(t.end)!==0){try{const M=k.formatRangeToParts(K,G);let B=-1;for(let S=0;S<M.length;S++){const U=M[S];if(U.source==="shared"&&U.type==="literal")B=S;else if(U.source==="endRange")break}let j="",z="";for(let S=0;S<M.length;S++)S<B?j+=M[S].value:S>B&&(z+=M[S].value);return{start:j,end:z}}catch{}Z=k}else{const M=Y(s,{granularity:N,timeZone:w??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24});Z=new A(a,M)}return{start:k.format(K),end:Z.format(G)}}}}function Oe(e){const l=c=>typeof window<"u"?window.matchMedia(c).matches:!1,[o,u]=$.useState(l(e));function d(){u(l(e))}return $.useEffect(()=>{const c=window.matchMedia(e);return d(),c.addListener?c.addListener(d):c.addEventListener("change",d),()=>{c.removeListener?c.removeListener(d):c.removeEventListener("change",d)}},[e]),o}const Re=ee("div",{width:"fit-content","@max_768":{"& .date-range-fields":{flexDirection:"column",gap:"$6"},"&":{width:"100%"}}}),Le=ee("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),$e=W.forwardRef((e,l)=>{const{startDateLabel:o,endDateLabel:u,shouldCloseOnSelect:d=!1,css:c={},errorMessage:t,helperText:b,maxValue:V,hasShortcuts:h,ctaButtonRender:y,visibleMonths:m,onSearchButtonClick:i,customShortcuts:D,...r}=e,C=Fe({...r,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:d??!1}),g=ve(l),{labelProps:v,groupProps:x,startFieldProps:F,endFieldProps:O,buttonProps:R,dialogProps:a,calendarProps:s}=xe({...r,isReadOnly:e.isReadOnly?!0:!!e.isMobile,"aria-label":"date range picker","aria-describedby":""},C,g),f={necessityIndicator:e.necessityIndicator,...F},I={necessityIndicator:e.necessityIndicator,...O},w=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return s.isReadOnly=w(),n(Re,{ref:g,css:c,className:"date-range-picker-wrapper",children:T(Pe,{children:[n(we,{state:C,label:e.label,labelProps:v,groupProps:x,startFieldProps:f,endFieldProps:I,buttonProps:R,startDateLabel:o,endDateLabel:u,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,errorMessage:t,helperText:b}),n(Te,{maxValue:V,state:C,calendarRef:g,dialogProps:a,calendarProps:s,hasShortcuts:h,ctaButtonRender:y,onSearchButtonClick:i,customShortcuts:D,css:e.calendarCSS,visibleMonths:m})]})})}),we=W.forwardRef((e,l)=>{const{label:o,labelProps:u,groupProps:d,startFieldProps:c,endFieldProps:t,buttonProps:b,startDateLabel:V,endDateLabel:h,isInvalid:y,isMobile:m,isReadOnly:i=!1,errorMessage:D,helperText:r}=e;return T(Le,{children:[n("span",{...u,className:"date-range-label",children:o}),n("div",{...d,ref:l,className:"date-range-inputs-body",children:T("div",{className:"date-range-fields",children:[n(q,{...c,label:V,buttonProps:b,isInvalid:y,isMobile:m,isReadOnly:i,errorMessage:D,helperText:r}),n(q,{...t,label:h,buttonProps:b,isInvalid:y,isMobile:m,isReadOnly:i})]})})]})}),Te=e=>{const{state:l,calendarRef:o,dialogProps:u,calendarProps:d,css:c={},hasShortcuts:t=!1,maxValue:b=re("2999-03-10"),ctaButtonRender:V,visibleMonths:h,onSearchButtonClick:y,customShortcuts:m}=e,{value:i,onChange:D,...r}=d,C=Oe("(max-width: 768px)"),g=v=>{D&&D(v)};return n(se,{children:l.isOpen&&n(be,{state:l,triggerRef:o,placement:"bottom start",offset:8,children:n(he,{...u,"aria-describedby":u["aria-describedby"]??"","aria-label":u["aria-label"]??"","aria-labelledby":u["aria-labelledby"]??"",children:n(Ce,{css:c,state:l,hasFooter:!0,"aria-label":"","aria-labelledby":"",...i?{value:i}:{},onChange:g,...r,maxValue:b,hasShortcuts:t,ctaButtonRender:V,onSearchButtonClick:y,customShortcuts:m,visibleMonths:h||(C?1:2)})})})})},P=$e,{I18nProvider:ae,useDateFormatter:Ie}=te.I18N,{getLocalTimeZone:L,parseDate:p}=te.InternationalizedDate,qe=()=>n(ae,{locale:"en-SG",children:T(Ve,{children:[n("h3",{children:"Basic"}),n(P,{startDateLabel:"Start date",endDateLabel:"End date"}),n("br",{}),n("h3",{children:"Disabled"}),n(P,{isDisabled:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Read only"}),n(P,{isReadOnly:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Invalid"}),n(P,{isInvalid:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Min & Max"}),n(P,{startDateLabel:"Start date",endDateLabel:"End date",minValue:_(L()),maxValue:_(L()).add({days:7})}),n("h3",{children:"Is Mobile"}),n(P,{startDateLabel:"Start date",endDateLabel:"End date",isMobile:!0}),n("h3",{children:"Helper texts"}),n(P,{isInvalid:!0,isRequired:!0,helperText:"Weekend is excluded",errorMessage:"Must not include weekend",startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Shortcuts"}),n(P,{startDateLabel:"Start date",endDateLabel:"End date",hasShortcuts:!0}),n("h3",{children:"Custom Shortcuts Range Calendar"}),n(P,{startDateLabel:"Start date",endDateLabel:"End date",hasShortcuts:!0,customShortcuts:e=>{const l=[{label:"Custom Shortcut",getValue:()=>({start:null,end:null})}];return[...e,...l]},ctaButtonRender:n(Me,{onPress:()=>{alert("Custom callback")},children:"Custom Button"})})]})}),Je=()=>{const[e,l]=W.useState({start:p("2020-02-03"),end:p("2020-02-08")}),o=Ie({dateStyle:"long"});return T(ae,{locale:"en-SG",children:[n("h3",{children:"Controlled"}),n("p",{children:e.start&&e.end?o.formatRange(e.start.toDate(L()),e.end.toDate(L())):`${e.start&&o.format(e.start.toDate(L()))} - ${e.end&&o.format(e.end.toDate(L()))}`}),n(P,{value:e,shouldCloseOnSelect:!0,startDateLabel:"Start Date",endDateLabel:"End Date",onChange:u=>l(u)})]})},Xe=()=>n(P,{});typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Je as Controlled,Xe as Default,qe as Variants};
