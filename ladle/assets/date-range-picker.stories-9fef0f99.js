import{r as I,s as p,R as E,a as R,j as s,F as ne}from"./index-e285302b.js";import{C as ee}from"./index-56f0f8ff.js";import{$ as le,a as A,b as _,c as q,d as re}from"./import-0e52c6a7.js";import{u as ie,a as se,b as oe,c as de,d as ce,D as z,P as ue,e as be}from"./useOverlayTriggerState-c47fddad.js";import{u as fe,a as H,c as me,f as ye,r as he,b as De,d as ge,i as J,g as $,e as Q}from"./useCalendarState-72159f9a.js";import{R as Pe}from"./range-calendar-020747ba.js";import{u as Ce}from"./use-dom-ref-58648911.js";import{C as Se}from"./components-6c35209b.js";import"./index-76d34920.js";import"./button-1deb7e4d.js";import"./clsx.m-30223e4c.js";import"./utils-62b75d72.js";import"./isTypedArray-de9f3539.js";import"./isArray-671b897a.js";import"./useEvent-9e5a4e9a.js";import"./import-d980f3a5.js";import"./import-78d70eaf.js";import"./index-c774b727.js";import"./index-e91c34d0.js";import"./index.es-1379fa95.js";function Fe(e,l,d){var t,i;const{labelProps:c,fieldProps:u,descriptionProps:g,errorMessageProps:a}=ie({...e,labelElementType:"span"}),o=u["aria-labelledby"]||u.id,{locale:P}=le(),b=l.formatValue(P,{month:"long"}),m=b?`selectedRangeDescription ${b.start} ${b.end}`:"",f=fe(m),r={"aria-label":"startDate","aria-labelledby":o},y={"aria-label":"endDate","aria-labelledby":o},n=H(),T=H(),F=se(l,d),C=[f["aria-describedby"],u["aria-describedby"]].filter(Boolean).join(" ")||void 0,V=I.useMemo(()=>me(d,{accept:h=>h.id!==n}),[d,n]),v={[ye]:V,[he]:"presentation","aria-describedby":C,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:l.validationState},O=De(e),{focusWithinProps:x}=oe({...e,isDisabled:l.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...O,...F,...u,...f,...x,role:"group","aria-disabled":e.isDisabled||null,"aria-describedby":C,onKeyDown(h){l.isOpen||e.onKeyDown&&e.onKeyDown(h)},onKeyUp(h){l.isOpen||e.onKeyUp&&e.onKeyUp(h)}},labelProps:{...c,onClick:()=>{V.focusFirst()}},buttonProps:{...f,id:n,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${o} ${n}`,"aria-describedby":C,"aria-expanded":l.isOpen||void 0,onPress:()=>l.setOpen(!0)},dialogProps:{id:T,"aria-labelledby":`${o} ${n}`},startFieldProps:{...r,...v,value:(t=l.value)==null?void 0:t.start,onChange:h=>l.setDateTime("start",h),autoFocus:e.autoFocus},endFieldProps:{...y,...v,value:(i=l.value)==null?void 0:i.end,onChange:h=>l.setDateTime("end",h)},descriptionProps:g,errorMessageProps:a,calendarProps:{autoFocus:!0,value:l.dateRange,onChange:l.setDateRange,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,allowsNonContiguousRanges:e.allowsNonContiguousRanges,defaultFocusedValue:l.dateRange?void 0:e.placeholderValue,validationState:l.validationState,errorMessage:e.errorMessage}}}function Ve(e){var O,x;const l=de(e),[d,c]=ge(e.value,e.defaultValue||null,e.onChange);let[u,g]=I.useState(()=>d||{start:null,end:null});d==null&&u.start&&u.end&&(u={start:null,end:null},g(u));const a=d||u,o=t=>{g(t),t!=null&&t.start&&t.end?c(t):c(null)},P=(a==null?void 0:a.start)||(a==null?void 0:a.end)||e.placeholderValue,[b]=ce(P,e.granularity),m=b==="hour"||b==="minute"||b==="second",f=e.shouldCloseOnSelect??!0;let[r,y]=I.useState(null),[n,T]=I.useState(null);a&&a.start&&a.end&&(r=a,"hour"in a.start&&(n=a));const F=(t,i)=>{o({start:"timeZone"in i.start?i.start.set(_(t.start)):q(t.start,i.start),end:"timeZone"in i.end?i.end.set(_(t.end)):q(t.end,i.end)}),y(null),T(null)},C=t=>{let i=typeof f=="function"?f():f;m?i||t.start&&t.end&&(n!=null&&n.start)&&(n!=null&&n.end)?F(t,{start:(n==null?void 0:n.start)||$(e.placeholderValue),end:(n==null?void 0:n.end)||$(e.placeholderValue)}):y(t):t.start&&t.end?o(t):y(t),i&&l.setOpen(!1)},V=t=>{r!=null&&r.start&&(r!=null&&r.end)&&t.start&&t.end?F(r,t):T(t)},v=e.validationState||(a!=null&&(J(a.start,e.minValue,e.maxValue)||J(a.end,e.minValue,e.maxValue)||a.end!=null&&a.start!=null&&a.end.compare(a.start)<0||a!=null&&a.start&&((O=e.isDateUnavailable)!=null&&O.call(e,a.start))||a!=null&&a.end&&((x=e.isDateUnavailable)!=null&&x.call(e,a.end)))?"invalid":null);return{value:a,setValue:o,dateRange:r,timeRange:n,granularity:b,hasTime:m,setDate(t,i){C({...r,[t]:i})},setTime(t,i){V({...n,[t]:i})},setDateTime(t,i){o({...a,[t]:i})},setDateRange:C,setTimeRange:V,...l,setOpen(t){!t&&!(a!=null&&a.start&&(a!=null&&a.end))&&(r!=null&&r.start)&&(r!=null&&r.end)&&m&&F(r,{start:(n==null?void 0:n.start)||$(e.placeholderValue),end:(n==null?void 0:n.end)||$(e.placeholderValue)}),l.setOpen(t)},validationState:v,formatValue(t,i){if(!a||!a.start||!a.end)return null;const h="timeZone"in a.start?a.start.timeZone:void 0,B=e.granularity||(a.start&&"minute"in a.start?"minute":"day"),w="timeZone"in a.end?a.end.timeZone:void 0,W=e.granularity||(a.end&&"minute"in a.end?"minute":"day"),te=Q(i,{granularity:B,timeZone:h??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:a.start.calendar.identifier==="gregory"&&a.start.era==="BC"||a.end.calendar.identifier==="gregory"&&a.end.era==="BC"}),K=a.start.toDate(h||"UTC"),N=a.end.toDate(w||"UTC"),Z=new A(t,te);let k;if(h===w&&B===W&&a.start.compare(a.end)!==0){try{const S=Z.formatRangeToParts(K,N);let L=-1;for(let D=0;D<S.length;D++){const U=S[D];if(U.source==="shared"&&U.type==="literal")L=D;else if(U.source==="endRange")break}let G="",j="";for(let D=0;D<S.length;D++)D<L?G+=S[D].value:D>L&&(j+=S[D].value);return{start:G,end:j}}catch{}k=Z}else{const S=Q(i,{granularity:W,timeZone:w??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24});k=new A(t,S)}return{start:Z.format(K),end:k.format(N)}}}}const Oe=p("div",{width:"fit-content"}),Te=p("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),ve=E.forwardRef((e,l)=>{const{startDateLabel:d,endDateLabel:c,shouldCloseOnSelect:u=!1,css:g={},onApply:a,onCancel:o,errorMessage:P,helperText:b,maxValue:m,...f}=e,r=Ve({...f,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:e.shouldCloseOnSelect??!1}),y=Ce(l),{labelProps:n,groupProps:T,startFieldProps:F,endFieldProps:C,buttonProps:V,dialogProps:v,calendarProps:O}=Fe({...f,isReadOnly:e.isReadOnly?!0:!!e.isMobile,"aria-label":"date range picker","aria-describedby":""},r,y),x={necessityIndicator:e.necessityIndicator,...F},t={necessityIndicator:e.necessityIndicator,...C},i=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return O.isReadOnly=i(),R(Oe,{ref:y,css:g,children:[s(xe,{state:r,label:e.label,labelProps:n,groupProps:T,startFieldProps:x,endFieldProps:t,buttonProps:V,startDateLabel:d,endDateLabel:c,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,errorMessage:P,helperText:b}),s(Re,{maxValue:m,state:r,onApply:a,onCancel:o,calendarRef:y,dialogProps:v,calendarProps:O,css:e.calendarCSS})]})}),xe=E.forwardRef((e,l)=>{const{label:d,labelProps:c,groupProps:u,startFieldProps:g,endFieldProps:a,buttonProps:o,startDateLabel:P,endDateLabel:b,isInvalid:m,isMobile:f,isReadOnly:r=!1,errorMessage:y,helperText:n}=e;return R(Te,{children:[s("span",{...c,className:"date-range-label",children:d}),s("div",{...u,ref:l,className:"date-range-inputs-body",children:R("div",{className:"date-range-fields",children:[s(z,{...g,label:P,buttonProps:o,isInvalid:m,isMobile:f,isReadOnly:r,errorMessage:y,helperText:n}),s(z,{...a,label:b,buttonProps:o,isInvalid:m,isMobile:f,isReadOnly:r})]})})]})}),Re=e=>{const{state:l,calendarRef:d,dialogProps:c,calendarProps:u,css:g={},maxValue:a=re("2999-03-10"),onApply:o,onCancel:P}=e,{value:b,onChange:m,...f}=u,r=y=>{m&&m(y)};return s(ne,{children:l.isOpen&&s(ue,{state:l,triggerRef:d,placement:"bottom start",offset:8,children:s(be,{...c,"aria-describedby":c["aria-describedby"]??"","aria-label":c["aria-label"]??"","aria-labelledby":c["aria-labelledby"]??"",children:s(Pe,{css:g,state:l,hasFooter:!0,onApplyCallback:o,onCancelCallback:P,"aria-label":"","aria-labelledby":"",...b?{value:b}:{},onChange:r,...f,maxValue:a})})})})},M=ve,{I18nProvider:ae,useDateFormatter:$e}=ee.I18N,{getLocalTimeZone:X,parseDate:Y}=ee.InternationalizedDate,Qe=()=>s(ae,{locale:"en-SG",children:R(Se,{children:[s("h3",{children:"Basic"}),s(M,{startDateLabel:"Start date",endDateLabel:"End date"}),s("br",{}),s("h3",{children:"Disabled"}),s(M,{isDisabled:!0,startDateLabel:"Start date",endDateLabel:"End date"}),s("h3",{children:"Invalid"}),s(M,{isInvalid:!0,startDateLabel:"Start date",endDateLabel:"End date"})]})}),Xe=()=>{const[e,l]=E.useState({start:Y("2020-02-03"),end:Y("2020-02-08")}),d=$e({dateStyle:"long"});return R(ae,{locale:"en-SG",children:[s("h3",{children:"Controlled"}),e&&d.formatRange(e.start.toDate(X()),e.end.toDate(X())),s(M,{value:e,onChange:c=>l(c)})]})},Ye={decorators:[e=>R("div",{children:[s("style",{dangerouslySetInnerHTML:{__html:".ladle-main { background: #eee; }"}}),s(e,{})]})]};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{Xe as Controlled,Qe as Variants,Ye as default};
