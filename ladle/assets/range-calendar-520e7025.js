import{s as z,r as m,j as R,R as le,a as N,F as J}from"./index-e5a3d34a.js";import{B as oe}from"./index-9f0832a5.js";import"./index-921da44a.js";import{u as ie,l as U,_ as Q,z as X,Y as q,y as ee,$ as ue,A as ce,i as h,d as de,aF as ae,ab as fe,ak as me,e as be,aK as ge,t as _,V as he,W as ve,aG as De,O as ne,aL as te,aM as xe,aN as pe,a0 as Re,G as ye,p as Ve,x as Ce,a6 as Se,ae as $e,K as F,aI as we,aJ as re}from"./useCalendarState-23ae2d5d.js";import{u as Me,a as Z}from"./useEvent-b9c1f6ae.js";import{u as Fe}from"./use-dom-ref-ab092602.js";import{B as G}from"./button-d41eed6b.js";const Te=z("div",{padding:"$3 $4 $3 $4",display:"flex",flexDirection:"column",gap:"$1",maxWidth:"193px",width:"100%",borderRight:"1px solid #F5F5F5"}),ke=z("button",{margin:0,padding:"$3 $4",width:"100%",maxWidth:"160px",fontSize:"$label1",textAlign:"left",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"$button",color:"$primaryText","&:hover":{borderRadius:"6px",backgroundColor:"$gray20",fontWeight:"bold"},"&:focus-visible":{outline:"none",borderRadius:"6px",boxShadow:"0px 0px 0px 4px #F2F4F7"},"&:disabled":{backgroundColor:"transparent",fontWeight:"$normal",cursor:"not-allowed"},variants:{variants:{active:{backgroundColor:"$cdgBlue10",borderRadius:"6px","&:focus-visible":{backgroundColor:"$cdgBlue10",boxShadow:"0px 0px 0px 4px #F2F4F7"}},inactive:{}}},defaultVariants:{variants:"inactive"}}),Ie=n=>{const[e,d]=m.useState(null),[c,f]=m.useState(null),{state:a,customShortcuts:b=x=>x}=n,{locale:s}=ie();m.useEffect(()=>{var x,L;!(c!=null&&c.start)||!c.end||e&&((x=a.value.end)==null?void 0:x.compare(c.end))!==0&&((L=a.value.start)==null?void 0:L.compare(c.start))!==0&&d(null)},[a.value]);const i=new Intl.DateTimeFormat(s).resolvedOptions().timeZone,l=U(i),t=l.subtract({days:1}),D=l.subtract({weeks:1}),g=l.subtract({months:1}),y=Q(l,s),V=X(l,s),r=Q(D,s),v=X(D,s),T=q(l),k=ee(l),I=q(g),u=ee(g),C=ue(l),$=ce(l),w=[{label:"Today",isDisable:(()=>h(l,a.minValue,a.maxValue))(),getValue:()=>({end:l,start:l})},{label:"Yesterday",isDisable:(()=>h(t,a.minValue,a.maxValue))(),getValue:()=>({end:t,start:t})},{label:"This Week",isDisable:(()=>h(y,a.minValue,a.maxValue)||h(V,a.minValue,a.maxValue))(),getValue:()=>({start:y,end:V})},{label:"Last Week",isDisable:(()=>h(r,a.minValue,a.maxValue)||h(v,a.minValue,a.maxValue))(),getValue:()=>({start:r,end:v})},{label:"This Month",isDisable:(()=>h(T,a.minValue,a.maxValue)||h(k,a.minValue,a.maxValue))(),getValue:()=>({start:T,end:k})},{label:"Last Month",isDisable:(()=>h(I,a.minValue,a.maxValue)||h(u,a.minValue,a.maxValue))(),getValue:()=>({start:I,end:u})},{label:"This Year",isDisable:(()=>h(C,a.minValue,a.maxValue)||h($,a.minValue,a.maxValue))(),getValue:()=>({start:C,end:$})}];return{shorcuts:b(w,x=>h(x,a.minValue,a.maxValue)),selectedItem:e,setSelectedItem:d,setCurrentRangeDate:f}},Pe=n=>{const{state:e,pickerState:d}=n,{shorcuts:c,selectedItem:f,setSelectedItem:a,setCurrentRangeDate:b}=Ie(n),s=i=>{var t;const l=i.getValue();d?d.setDateRange(l):e.setValue(l),l.end&&((t=e.setFocusedDate)==null||t.call(e,l.end)),a(i.label),b(l),e.setAnchorDate(null)};return R(Te,{children:c&&c.map(i=>R(ke,{"aria-disabled":i.isDisable,type:"button",variants:f===i.label?"active":"inactive",disabled:i.isDisable,onClick:()=>s(i),children:i.label},i.label))})},Be=Pe;function Oe(n,e){var D,g,y,V;const d=de(n);if(e.visibleRange==null)return{};const c=ae(e.visibleRange.start,e.timeZone??"UTC"),f=ae(e.visibleRange.start,e.timeZone??"UTC"),a=Me([!!n.errorMessage,n.validationState]);fe.set(e,{ariaLabel:n["aria-label"]??"",ariaLabelledBy:n["aria-labelledby"],errorMessageId:a});const b=m.useRef(!1),s=n.isDisabled||((D=e.isNextVisibleRangeInvalid)==null?void 0:D.call(e));s&&b.current&&(b.current=!1,(g=e.setFocused)==null||g.call(e,!0));const i=m.useRef(!1),l=n.isDisabled||((y=e.isPreviousVisibleRangeInvalid)==null?void 0:y.call(e));l&&i.current&&(i.current=!1,(V=e.setFocused)==null||V.call(e,!0));const t=me({id:n.id,"aria-label":[n["aria-label"],f].filter(Boolean).join(", "),"aria-labelledby":n["aria-labelledby"]});return{calendarProps:{...d,...t,role:"group","aria-describedby":n["aria-describedby"]||void 0},nextButtonProps:{onPress:()=>{var r;return(r=e.focusNextPage)==null?void 0:r.call(e)},"aria-label":"next",isDisabled:s,onFocus:()=>b.current=!0,onBlur:()=>b.current=!1},prevButtonProps:{onPress:()=>{var r;return(r=e.focusPreviousPage)==null?void 0:r.call(e)},"aria-label":"previous",isDisabled:l,onFocus:()=>i.current=!0,onBlur:()=>i.current=!1},title:c}}function Le(n,e,d){const c=Oe(n,e),f=m.useRef(!1),a=m.useRef(typeof window<"u"?window:null);Z(a,"pointerdown",s=>{f.current=s.width===0&&s.height===0});const b=s=>{var t;if(f.current){f.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;const i=s.target,l=document.getElementById(c.calendarProps.id);l&&l.contains(document.activeElement)&&(!l.contains(i)||!i.closest('button, [role="button"]'))&&((t=e.selectFocusedDate)==null||t.call(e))};return Z(a,"pointerup",b),Z(a,"pointercancel",b),c.calendarProps.onBlur=s=>{var i;(!s.relatedTarget||!d.current.contains(s.relatedTarget))&&e.anchorDate&&((i=e.selectFocusedDate)==null||i.call(e))},Z(d,"touchmove",s=>{e.isDragging&&s.preventDefault()},{passive:!1,capture:!0}),c}function We(n){var A,E,S,W;const{value:e,defaultValue:d,onChange:c,createCalendar:f,locale:a,visibleDuration:b={months:1},minValue:s,maxValue:i,...l}=n,[t,D]=be(e,d||null,c),[g,y]=m.useState(t!=null&&t.start&&!t.end?t==null?void 0:t.start:null);let V="center";if(t&&t.start&&t.end){const p=ge(_(t.start),b,a,s,i).add(b).subtract({days:1});t.end.compare(p)>0&&(V="start")}const r=m.useRef(null),[v,T]=m.useState(),k=m.useMemo(()=>he(s,v==null?void 0:v.start),[s,v]),I=m.useMemo(()=>ve(i,v==null?void 0:v.end),[i,v]),u=De({...l,value:t&&t.start,createCalendar:f,locale:a,visibleDuration:b,minValue:k,maxValue:I,selectionAlignment:V}),C=o=>{o&&n.isDateUnavailable&&!n.allowsNonContiguousRanges?(r.current={start:te(o,u,-1),end:te(o,u,1)},T(r.current)):(r.current=null,T(void 0))},$=m.useRef(u.visibleRange);(!ne((A=u.visibleRange)==null?void 0:A.start,(E=$.current)==null?void 0:E.start)||!ne((S=u.visibleRange)==null?void 0:S.end,(W=$.current)==null?void 0:W.end))&&(C(g),$.current=u.visibleRange);const w=o=>{o?(y(o),C(o)):(y(null),C(null))},P=g?K(g,u.focusedDate):t&&K(t.start,t.end),B=o=>{var p;if(!n.isReadOnly&&(o=xe(o,k,I),o=pe(o,(p=u.visibleRange)==null?void 0:p.start,n.isDateUnavailable),!!o))if(!g)w(o),c==null||c({start:o,end:null});else if(g.compare(o)>0)w(o),c==null||c({start:o,end:null});else{const M=K(g,o);D({start:se(M.start,t==null?void 0:t.start),end:se(M.end,t==null?void 0:t.end)}),w(null)}},[x,L]=m.useState(!1),{isDateUnavailable:O}=n,Y=m.useMemo(()=>!t||g?!1:O&&(O(t.start)||O(t.end))?!0:h(t.start,s,i)||h(t.end,s,i),[O,t,g,s,i]),j=n.validationState||(Y?"invalid":null);return{...u,value:t,setValue:D,anchorDate:g,setAnchorDate:w,highlightedRange:P,validationState:j,selectFocusedDate(){B(u.focusedDate)},selectDate:B,highlightDate(o){var p;g&&((p=u.setFocusedDate)==null||p.call(u,o))},isSelected(o){var p,M;return P&&o.compare(P.start)>=0&&o.compare(P.end)<=0&&!((p=u.isCellDisabled)!=null&&p.call(u,o))&&!((M=u.isCellUnavailable)!=null&&M.call(u,o))},isInvalid(o){var p,M,H;return((p=u.isInvalid)==null?void 0:p.call(u,o))||h(o,(M=r.current)==null?void 0:M.start,(H=r.current)==null?void 0:H.end)},isDragging:x,setDragging:L}}function K(n,e){return!n||!e?null:(e.compare(n)<0&&([n,e]=[e,n]),{start:_(n),end:_(e)})}function se(n,e){return n=Re(n,(e==null?void 0:e.calendar)||new ye),e&&"hour"in e?e.set(n):n}function Ae(n){const e=a=>typeof window<"u"?window.matchMedia(a).matches:!1,[d,c]=m.useState(e(n));function f(){c(e(n))}return m.useEffect(()=>{const a=window.matchMedia(n);return f(),a.addListener?a.addListener(f):a.addEventListener("change",f),()=>{a.removeListener?a.removeListener(f):a.removeEventListener("change",f)}},[n]),d}const Ee=z("div",{width:"fit-content",backgroundColor:"$background",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.08)",borderRadius:"$md",padding:"$4","& .calendar-body":{display:"flex",justifyContent:"space-between",gap:"$2"},"& .calendar-footer":{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"$6",paddingTop:"$6",borderTop:"1px solid $gray40",color:"$primaryText"},"& .calendar-footer .calendar-footer-right-side":{display:"flex",alignItems:"center",gap:"$4"},"& .calendar-footer .preview-date":{margin:0,fontSize:"$body3"},"& .calendar-footer button":{padding:"$1 $2_5",height:"$8",fontSize:"$label2"},variants:{variants:{extend:{display:"flex",flexDirection:"row",padding:0,"& > div:nth-child(2)":{padding:"$4"}},basic:{}}},defaultVariants:{variants:"basic"}});z("div",{display:"flex",flexDirection:"row"});const Ne=le.forwardRef((n,e)=>{var O,Y,j,A,E;const{state:d,hasFooter:c,css:f={},maxValue:a=Ve("2999-02-17"),hasShortcuts:b=!1,ctaButtonRender:s,visibleMonths:i=2,onSearchButtonClick:l,customShortcuts:t,...D}=n,y=Ae("(max-width: 768px)")?1:i,{locale:V}=ie(),r=We({...D,value:n.state?(O=n.state)==null?void 0:O.value:n.value,visibleDuration:{months:y},locale:V,createCalendar:Ce}),v=Fe(e),{calendarProps:T,prevButtonProps:k,nextButtonProps:I}=Le(D,r,v),u=Se({}),{setIsReset:C}=$e(),$=()=>{r.setValue({start:null,end:null}),r.setAnchorDate(null),C==null||C(!0)},w=()=>{var W;const S={start:U(F()),end:U(F())};d?d==null||d.setDateRange(S):r.setValue(S),r.setAnchorDate(null),(W=r.setFocusedDate)==null||W.call(r,U(F()))},P=m.useMemo(()=>{const S=U(F());return h(S,D.minValue,a)},[D.minValue,a]),B=y!==1,x=!!(B&&b),L=m.useCallback(()=>s||(x?R(G,{variant:"primary",onPress:S=>l==null?void 0:l(S),children:"Search"}):R(G,{variant:"primary",onPress:w,isDisabled:P,children:"Today"})),[s,x]);return N(Ee,{ref:v,css:f,variants:x?"extend":"basic",children:[x?R(Be,{state:r,pickerState:d,customShortcuts:t}):R(J,{}),N(oe,{children:[R(we,{state:r,variant:B?"range":"default",calendarProps:T,prevButtonProps:k,nextButtonProps:I}),N("div",{className:"calendar-body",children:[R(re,{state:r,maxValue:a}),B?R(re,{state:r,offset:{months:1},maxValue:a}):R(J,{})]}),c&&N("div",{className:"calendar-footer",children:[R(G,{variant:"ghost",onPress:$,children:"Clear"}),N("div",{className:"calendar-footer-right-side",children:[R("p",{className:"preview-date",children:(Y=r==null?void 0:r.value)!=null&&Y.start&&((j=r==null?void 0:r.value)!=null&&j.end)?u.formatRange(r.value.start.toDate(F()),r.value.end.toDate(F())):`${(A=r==null?void 0:r.value)!=null&&A.start?u.format(r.value.start.toDate(F())):""} - ${(E=r==null?void 0:r.value)!=null&&E.end?u.format(r.value.end.toDate(F())):""}`}),L()]})]})]})]})}),_e=Ne;export{_e as R,Ae as u};
