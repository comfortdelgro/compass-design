import{$ as ne,I as L,N as J,_,M as X,X as q,L as le,a0 as ie,b as E,O as oe,P as ce,T as K,e as ue,i as de,d as fe,m as be,k as ge,J as M}from"./import-6617c2cc.js";import{s as N,r as m,j as D,R as me,a as A,F as ve}from"./index-831beb71.js";import{B as $e}from"./index-ca27cb1d.js";import"./index-2d95e1ba.js";import{i as g,b as xe,A as Q,l as he,v as pe,d as De,G as Re,B as Ve,H as ee,I as ye,J as Ce,o as Se,E as Fe,F as ae}from"./useCalendarState-aaf0c14a.js";import{u as ke,a as W}from"./useEvent-ce672b31.js";import{u as Pe}from"./use-dom-ref-3eb3c003.js";import{B as U}from"./button-aafe28bd.js";const we=N("div",{padding:"$3 $4 $3 $4",display:"flex",flexDirection:"column",maxWidth:"193px",width:"100%",borderRight:"1px solid #F5F5F5"}),Be=N("button",{margin:0,padding:"$3 $4",width:"100%",maxWidth:"160px",fontSize:"$label1",textAlign:"left",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"$button","&:hover":{borderRadius:"6px",backgroundColor:"$gray20",fontWeight:"bold"},"&:focus-visible":{outline:"none",borderRadius:"6px",boxShadow:"0px 0px 0px 4px #F2F4F7"},"&:disabled":{backgroundColor:"transparent",fontWeight:"$normal",cursor:"not-allowed"},variants:{variants:{active:{backgroundColor:"$cdgBlue10",borderRadius:"6px","&:focus-visible":{backgroundColor:"$cdgBlue10",boxShadow:"0px 0px 0px 4px #F2F4F7"}},inactive:{}}},defaultVariants:{variants:"inactive"}}),Ie=r=>{const[e,f]=m.useState(null),[u,v]=m.useState(null),{state:n,customShortcuts:d=p=>p}=r,{locale:l}=ne();m.useEffect(()=>{var p,k;!(u!=null&&u.start)||!u.end||e&&((p=n.value.end)==null?void 0:p.compare(u.end))!==0&&((k=n.value.start)==null?void 0:k.compare(u.start))!==0&&f(null)},[n.value]);const s=new Intl.DateTimeFormat(l).resolvedOptions().timeZone,o=L(s),a=o.subtract({days:1}),R=o.subtract({weeks:1}),t=o.subtract({months:1}),h=J(o,l),V=_(o,l),b=J(R,l),$=_(R,l),y=X(o),C=q(o),I=X(t),c=q(t),P=le(o),S=ie(o),F=[{label:"Today",isDisable:(()=>g(o,n.minValue,n.maxValue))(),getValue:()=>({end:o,start:o})},{label:"Yesterday",isDisable:(()=>g(a,n.minValue,n.maxValue))(),getValue:()=>({end:a,start:a})},{label:"This Week",isDisable:(()=>g(h,n.minValue,n.maxValue)||g(V,n.minValue,n.maxValue))(),getValue:()=>({start:h,end:V})},{label:"Last Week",isDisable:(()=>g(b,n.minValue,n.maxValue)||g($,n.minValue,n.maxValue))(),getValue:()=>({start:b,end:$})},{label:"This Month",isDisable:(()=>g(y,n.minValue,n.maxValue)||g(C,n.minValue,n.maxValue))(),getValue:()=>({start:y,end:C})},{label:"Last Month",isDisable:(()=>g(I,n.minValue,n.maxValue)||g(c,n.minValue,n.maxValue))(),getValue:()=>({start:I,end:c})},{label:"This Year",isDisable:(()=>g(P,n.minValue,n.maxValue)||g(S,n.minValue,n.maxValue))(),getValue:()=>({start:P,end:S})}];return{shorcuts:d(F,p=>g(p,n.minValue,n.maxValue)),selectedItem:e,setSelectedItem:f,setCurrentRangeDate:v}},Te=r=>{const{state:e,pickerState:f}=r,{shorcuts:u,selectedItem:v,setSelectedItem:n,setCurrentRangeDate:d}=Ie(r),l=s=>{var a;const o=s.getValue();f?f.setDateRange(o):e.setValue(o),o.end&&((a=e.setFocusedDate)==null||a.call(e,o.end)),n(s.label),d(o),e.setAnchorDate(null)};return D(we,{children:u&&u.map(s=>D(Be,{"aria-disabled":s.isDisable,type:"button",variants:v===s.label?"active":"inactive",disabled:s.isDisable,onClick:()=>l(s),children:s.label},s.label))})},Me=Te;function Oe(r,e){var R,t,h,V;const f=xe(r);if(e.visibleRange==null)return{};const u=Q(e.visibleRange.start,e.timeZone??"UTC"),v=Q(e.visibleRange.start,e.timeZone??"UTC"),n=ke([!!r.errorMessage,r.validationState]);he.set(e,{ariaLabel:r["aria-label"]??"",ariaLabelledBy:r["aria-labelledby"],errorMessageId:n});const d=m.useRef(!1),l=r.isDisabled||((R=e.isNextVisibleRangeInvalid)==null?void 0:R.call(e));l&&d.current&&(d.current=!1,(t=e.setFocused)==null||t.call(e,!0));const s=m.useRef(!1),o=r.isDisabled||((h=e.isPreviousVisibleRangeInvalid)==null?void 0:h.call(e));o&&s.current&&(s.current=!1,(V=e.setFocused)==null||V.call(e,!0));const a=pe({id:r.id,"aria-label":[r["aria-label"],v].filter(Boolean).join(", "),"aria-labelledby":r["aria-labelledby"]});return{calendarProps:{...f,...a,role:"group","aria-describedby":r["aria-describedby"]||void 0},nextButtonProps:{onPress:()=>{var b;return(b=e.focusNextPage)==null?void 0:b.call(e)},"aria-label":"next",isDisabled:l,onFocus:()=>d.current=!0,onBlur:()=>d.current=!1},prevButtonProps:{onPress:()=>{var b;return(b=e.focusPreviousPage)==null?void 0:b.call(e)},"aria-label":"previous",isDisabled:o,onFocus:()=>s.current=!0,onBlur:()=>s.current=!1},title:u}}function Ae(r,e,f){const u=Oe(r,e),v=m.useRef(!1),n=m.useRef(typeof window<"u"?window:null);W(n,"pointerdown",l=>{v.current=l.width===0&&l.height===0});const d=l=>{var a;if(v.current){v.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;const s=l.target,o=document.getElementById(u.calendarProps.id);o&&o.contains(document.activeElement)&&(!o.contains(s)||!s.closest('button, [role="button"]'))&&((a=e.selectFocusedDate)==null||a.call(e))};return W(n,"pointerup",d),W(n,"pointercancel",d),u.calendarProps.onBlur=l=>{var s;(!l.relatedTarget||!f.current.contains(l.relatedTarget))&&e.anchorDate&&((s=e.selectFocusedDate)==null||s.call(e))},W(f,"touchmove",l=>{e.isDragging&&l.preventDefault()},{passive:!1,capture:!0}),u}function We(r){var Y,Z,z,G;const{value:e,defaultValue:f,onChange:u,createCalendar:v,locale:n,visibleDuration:d={months:1},minValue:l,maxValue:s,...o}=r,[a,R]=De(e,f||null,u),[t,h]=m.useState(a!=null&&a.start&&!a.end?a==null?void 0:a.start:null);let V="center";if(a&&a.start&&a.end){const x=Re(E(a.start),d,n,l,s).add(d).subtract({days:1});a.end.compare(x)>0&&(V="start")}const b=m.useRef(null),[$,y]=m.useState(),C=m.useMemo(()=>oe(l,$==null?void 0:$.start),[l,$]),I=m.useMemo(()=>ce(s,$==null?void 0:$.end),[s,$]),c=Ve({...o,value:a&&a.start,createCalendar:v,locale:n,visibleDuration:d,minValue:C,maxValue:I,selectionAlignment:V}),P=i=>{i&&r.isDateUnavailable&&!r.allowsNonContiguousRanges?(b.current={start:ee(i,c,-1),end:ee(i,c,1)},y(b.current)):(b.current=null,y(void 0))},S=m.useRef(c.visibleRange);(!K((Y=c.visibleRange)==null?void 0:Y.start,(Z=S.current)==null?void 0:Z.start)||!K((z=c.visibleRange)==null?void 0:z.end,(G=S.current)==null?void 0:G.end))&&(P(t),S.current=c.visibleRange);const F=i=>{i?(h(i),P(i)):(h(null),P(null))},w=t?j(t,c.focusedDate):a&&j(a.start,a.end),O=i=>{var x;if(!r.isReadOnly&&(i=ye(i,C,I),i=Ce(i,(x=c.visibleRange)==null?void 0:x.start,r.isDateUnavailable),!!i))if(!t)F(i),u==null||u({start:i,end:null});else if(t.compare(i)>0)F(i),u==null||u({start:i,end:null});else{const B=j(t,i);R({start:te(B.start,a==null?void 0:a.start),end:te(B.end,a==null?void 0:a.end)}),F(null)}},[p,k]=m.useState(!1),{isDateUnavailable:T}=r,re=m.useMemo(()=>!a||t?!1:T&&(T(a.start)||T(a.end))?!0:g(a.start,l,s)||g(a.end,l,s),[T,a,t,l,s]),se=r.validationState||(re?"invalid":null);return{...c,value:a,setValue:R,anchorDate:t,setAnchorDate:F,highlightedRange:w,validationState:se,selectFocusedDate(){O(c.focusedDate)},selectDate:O,highlightDate(i){var x;t&&((x=c.setFocusedDate)==null||x.call(c,i))},isSelected(i){var x,B;return w&&i.compare(w.start)>=0&&i.compare(w.end)<=0&&!((x=c.isCellDisabled)!=null&&x.call(c,i))&&!((B=c.isCellUnavailable)!=null&&B.call(c,i))},isInvalid(i){var x,B,H;return((x=c.isInvalid)==null?void 0:x.call(c,i))||g(i,(B=b.current)==null?void 0:B.start,(H=b.current)==null?void 0:H.end)},isDragging:p,setDragging:k}}function j(r,e){return!r||!e?null:(e.compare(r)<0&&([r,e]=[e,r]),{start:E(r),end:E(e)})}function te(r,e){return r=ue(r,(e==null?void 0:e.calendar)||new de),e&&"hour"in e?e.set(r):r}const Le=N("div",{width:"fit-content",backgroundColor:"$background",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.08)",borderRadius:"$md",padding:"$4","& .calendar-body":{display:"flex",justifyContent:"space-between",gap:"$2"},"& .calendar-footer":{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"$6",paddingTop:"$6",borderTop:"1px solid $gray40"},"& .calendar-footer .calendar-footer-right-side":{display:"flex",alignItems:"center",gap:"$4"},"& .calendar-footer .preview-date":{margin:0,fontSize:"$body3"},"& .calendar-footer button":{padding:"$1 $2_5",height:"$8",fontSize:"$label2"},variants:{variants:{extend:{display:"flex",flexDirection:"row",padding:0,"& > div:nth-child(2)":{padding:"$4"}},basic:{}}},defaultVariants:{variants:"basic"}});N("div",{display:"flex",flexDirection:"row"});const Ne=me.forwardRef((r,e)=>{var S,F,w,O,p;const{state:f,hasFooter:u,css:v={},maxValue:n=fe("2999-02-17"),hasShortcuts:d=!1,ctaButtonRender:l,onSearchButtonClick:s,customShortcuts:o,...a}=r,{locale:R}=ne(),t=We({...a,value:r.state?(S=r.state)==null?void 0:S.value:r.value,visibleDuration:{months:2},locale:R,createCalendar:be}),h=Pe(e),{calendarProps:V,prevButtonProps:b,nextButtonProps:$}=Ae(a,t,h),y=ge({}),{setIsReset:C}=Se(),I=()=>{t.setValue({start:null,end:null}),t.setAnchorDate(null),C==null||C(!0)},c=()=>{var T;const k={start:L(M()),end:L(M())};f?f==null||f.setDateRange(k):t.setValue(k),t.setAnchorDate(null),(T=t.setFocusedDate)==null||T.call(t,L(M()))},P=m.useCallback(()=>l||(d?D(U,{variant:"primary",onPress:k=>s==null?void 0:s(k),children:"Search"}):D(U,{variant:"primary",onPress:c,children:"Today"})),[l,d]);return A(Le,{ref:h,css:v,variants:d?"extend":"basic",children:[d?D(Me,{state:t,pickerState:f,customShortcuts:o}):D(ve,{}),A($e,{children:[D(Fe,{state:t,variant:"range",calendarProps:V,prevButtonProps:b,nextButtonProps:$}),A("div",{className:"calendar-body",children:[D(ae,{state:t,maxValue:n}),D(ae,{state:t,offset:{months:1},maxValue:n})]}),u&&A("div",{className:"calendar-footer",children:[D(U,{variant:"ghost",onPress:I,children:"Clear"}),A("div",{className:"calendar-footer-right-side",children:[D("p",{className:"preview-date",children:(F=t==null?void 0:t.value)!=null&&F.start&&((w=t==null?void 0:t.value)!=null&&w.end)?y.formatRange(t.value.start.toDate(M()),t.value.end.toDate(M())):`${(O=t==null?void 0:t.value)!=null&&O.start?y.format(t.value.start.toDate(M())):""} - ${(p=t==null?void 0:t.value)!=null&&p.end?y.format(t.value.end.toDate(M())):""}`}),P()]})]})]})]})}),Je=Ne;export{Je as R};
