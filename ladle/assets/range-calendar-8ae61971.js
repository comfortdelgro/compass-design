import{$ as ne,e as L,N as _,_ as q,M as J,X as K,L as le,a0 as ie,b as E,O as oe,P as ce,T as X,m as ue,q as de,d as fe,s as be,h as me,K as M}from"./import-9affe3df.js";import{s as N,r as g,j as D,R as ge,a as A,F as ve}from"./index-1532effa.js";import{B as $e}from"./index-3234fe75.js";import"./index-99529096.js";import{i as m,b as xe,A as Q,l as he,v as pe,d as De,G as Re,B as Ve,H as ee,I as ye,J as Ce,o as Se,E as Fe,F as ae}from"./useCalendarState-d4eff692.js";import{u as Pe,a as W}from"./useEvent-64a9e5c4.js";import{u as ke}from"./use-dom-ref-0f6e2129.js";import{B as U}from"./button-3d16829e.js";const we=N("div",{padding:"$3 $4 $3 $4",display:"flex",flexDirection:"column",maxWidth:"193px",width:"100%",borderRight:"1px solid #F5F5F5"}),Te=N("button",{margin:0,padding:"$3 $4",width:"100%",maxWidth:"160px",fontSize:"$label1",textAlign:"left",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"$button","&:hover":{borderRadius:"6px",backgroundColor:"$gray20",fontWeight:"bold"},"&:focus-visible":{outline:"none",borderRadius:"6px",boxShadow:"0px 0px 0px 4px #F2F4F7"},"&:disabled":{backgroundColor:"transparent",fontWeight:"$normal",cursor:"not-allowed"},variants:{variants:{active:{backgroundColor:"$cdgBlue10",borderRadius:"6px","&:focus-visible":{backgroundColor:"$cdgBlue10",boxShadow:"0px 0px 0px 4px #F2F4F7"}},inactive:{}}},defaultVariants:{variants:"inactive"}}),Be=r=>{const[e,f]=g.useState(null),[u,v]=g.useState(null),{state:n,customShortcuts:d=p=>p}=r,{locale:l}=ne();g.useEffect(()=>{var p,P;!(u!=null&&u.start)||!u.end||e&&((p=n.value.end)==null?void 0:p.compare(u.end))!==0&&((P=n.value.start)==null?void 0:P.compare(u.start))!==0&&f(null)},[n.value]);const s=new Intl.DateTimeFormat(l).resolvedOptions().timeZone,o=L(s),a=o.subtract({days:1}),R=o.subtract({weeks:1}),t=o.subtract({months:1}),h=_(o,l),V=q(o,l),b=_(R,l),$=q(R,l),y=J(o),C=K(o),B=J(t),c=K(t),k=le(o),S=ie(o),F=[{label:"Today",isDisable:(()=>m(o,n.minValue,n.maxValue))(),getValue:()=>({end:o,start:o})},{label:"Yesterday",isDisable:(()=>m(a,n.minValue,n.maxValue))(),getValue:()=>({end:a,start:a})},{label:"This Week",isDisable:(()=>m(h,n.minValue,n.maxValue)||m(V,n.minValue,n.maxValue))(),getValue:()=>({start:h,end:V})},{label:"Last Week",isDisable:(()=>m(b,n.minValue,n.maxValue)||m($,n.minValue,n.maxValue))(),getValue:()=>({start:b,end:$})},{label:"This Month",isDisable:(()=>m(y,n.minValue,n.maxValue)||m(C,n.minValue,n.maxValue))(),getValue:()=>({start:y,end:C})},{label:"Last Month",isDisable:(()=>m(B,n.minValue,n.maxValue)||m(c,n.minValue,n.maxValue))(),getValue:()=>({start:B,end:c})},{label:"This Year",isDisable:(()=>m(k,n.minValue,n.maxValue)||m(S,n.minValue,n.maxValue))(),getValue:()=>({start:k,end:S})}];return{shorcuts:d(F,p=>m(p,n.minValue,n.maxValue)),selectedItem:e,setSelectedItem:f,setCurrentRangeDate:v}},Ie=r=>{const{state:e,pickerState:f}=r,{shorcuts:u,selectedItem:v,setSelectedItem:n,setCurrentRangeDate:d}=Be(r),l=s=>{var a;const o=s.getValue();f?f.setDateRange(o):e.setValue(o),o.end&&((a=e.setFocusedDate)==null||a.call(e,o.end)),n(s.label),d(o),e.setAnchorDate(null)};return D(we,{children:u&&u.map(s=>D(Te,{"aria-disabled":s.isDisable,type:"button",variants:v===s.label?"active":"inactive",disabled:s.isDisable,onClick:()=>l(s),children:s.label},s.label))})},Me=Ie;function Oe(r,e){var R,t,h,V;const f=xe(r);if(e.visibleRange==null)return{};const u=Q(e.visibleRange.start,e.timeZone??"UTC"),v=Q(e.visibleRange.start,e.timeZone??"UTC"),n=Pe([!!r.errorMessage,r.validationState]);he.set(e,{ariaLabel:r["aria-label"]??"",ariaLabelledBy:r["aria-labelledby"],errorMessageId:n});const d=g.useRef(!1),l=r.isDisabled||((R=e.isNextVisibleRangeInvalid)==null?void 0:R.call(e));l&&d.current&&(d.current=!1,(t=e.setFocused)==null||t.call(e,!0));const s=g.useRef(!1),o=r.isDisabled||((h=e.isPreviousVisibleRangeInvalid)==null?void 0:h.call(e));o&&s.current&&(s.current=!1,(V=e.setFocused)==null||V.call(e,!0));const a=pe({id:r.id,"aria-label":[r["aria-label"],v].filter(Boolean).join(", "),"aria-labelledby":r["aria-labelledby"]});return{calendarProps:{...f,...a,role:"group","aria-describedby":r["aria-describedby"]||void 0},nextButtonProps:{onPress:()=>{var b;return(b=e.focusNextPage)==null?void 0:b.call(e)},"aria-label":"next",isDisabled:l,onFocus:()=>d.current=!0,onBlur:()=>d.current=!1},prevButtonProps:{onPress:()=>{var b;return(b=e.focusPreviousPage)==null?void 0:b.call(e)},"aria-label":"previous",isDisabled:o,onFocus:()=>s.current=!0,onBlur:()=>s.current=!1},title:u}}function Ae(r,e,f){const u=Oe(r,e),v=g.useRef(!1),n=g.useRef(typeof window<"u"?window:null);W(n,"pointerdown",l=>{v.current=l.width===0&&l.height===0});const d=l=>{var a;if(v.current){v.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;const s=l.target,o=document.getElementById(u.calendarProps.id);o&&o.contains(document.activeElement)&&(!o.contains(s)||!s.closest('button, [role="button"]'))&&((a=e.selectFocusedDate)==null||a.call(e))};return W(n,"pointerup",d),W(n,"pointercancel",d),u.calendarProps.onBlur=l=>{var s;(!l.relatedTarget||!f.current.contains(l.relatedTarget))&&e.anchorDate&&((s=e.selectFocusedDate)==null||s.call(e))},W(f,"touchmove",l=>{e.isDragging&&l.preventDefault()},{passive:!1,capture:!0}),u}function We(r){var Y,Z,z,G;const{value:e,defaultValue:f,onChange:u,createCalendar:v,locale:n,visibleDuration:d={months:1},minValue:l,maxValue:s,...o}=r,[a,R]=De(e,f||null,u),[t,h]=g.useState(a!=null&&a.start&&!a.end?a==null?void 0:a.start:null);let V="center";if(a&&a.start&&a.end){const x=Re(E(a.start),d,n,l,s).add(d).subtract({days:1});a.end.compare(x)>0&&(V="start")}const b=g.useRef(null),[$,y]=g.useState(),C=g.useMemo(()=>oe(l,$==null?void 0:$.start),[l,$]),B=g.useMemo(()=>ce(s,$==null?void 0:$.end),[s,$]),c=Ve({...o,value:a&&a.start,createCalendar:v,locale:n,visibleDuration:d,minValue:C,maxValue:B,selectionAlignment:V}),k=i=>{i&&r.isDateUnavailable&&!r.allowsNonContiguousRanges?(b.current={start:ee(i,c,-1),end:ee(i,c,1)},y(b.current)):(b.current=null,y(void 0))},S=g.useRef(c.visibleRange);(!X((Y=c.visibleRange)==null?void 0:Y.start,(Z=S.current)==null?void 0:Z.start)||!X((z=c.visibleRange)==null?void 0:z.end,(G=S.current)==null?void 0:G.end))&&(k(t),S.current=c.visibleRange);const F=i=>{i?(h(i),k(i)):(h(null),k(null))},w=t?j(t,c.focusedDate):a&&j(a.start,a.end),O=i=>{var x;if(!r.isReadOnly&&(i=ye(i,C,B),i=Ce(i,(x=c.visibleRange)==null?void 0:x.start,r.isDateUnavailable),!!i))if(!t)F(i),u==null||u({start:i,end:null});else if(t.compare(i)>0)F(i),u==null||u({start:i,end:null});else{const T=j(t,i);R({start:te(T.start,a==null?void 0:a.start),end:te(T.end,a==null?void 0:a.end)}),F(null)}},[p,P]=g.useState(!1),{isDateUnavailable:I}=r,re=g.useMemo(()=>!a||t?!1:I&&(I(a.start)||I(a.end))?!0:m(a.start,l,s)||m(a.end,l,s),[I,a,t,l,s]),se=r.validationState||(re?"invalid":null);return{...c,value:a,setValue:R,anchorDate:t,setAnchorDate:F,highlightedRange:w,validationState:se,selectFocusedDate(){O(c.focusedDate)},selectDate:O,highlightDate(i){var x;t&&((x=c.setFocusedDate)==null||x.call(c,i))},isSelected(i){var x,T;return w&&i.compare(w.start)>=0&&i.compare(w.end)<=0&&!((x=c.isCellDisabled)!=null&&x.call(c,i))&&!((T=c.isCellUnavailable)!=null&&T.call(c,i))},isInvalid(i){var x,T,H;return((x=c.isInvalid)==null?void 0:x.call(c,i))||m(i,(T=b.current)==null?void 0:T.start,(H=b.current)==null?void 0:H.end)},isDragging:p,setDragging:P}}function j(r,e){return!r||!e?null:(e.compare(r)<0&&([r,e]=[e,r]),{start:E(r),end:E(e)})}function te(r,e){return r=ue(r,(e==null?void 0:e.calendar)||new de),e&&"hour"in e?e.set(r):r}const Le=N("div",{width:"fit-content",backgroundColor:"$background",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.08)",borderRadius:"$md",padding:"$4","& .calendar-body":{display:"flex",justifyContent:"space-between",gap:"$2"},"& .calendar-footer":{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"$6",paddingTop:"$6",borderTop:"1px solid $gray40",color:"$primaryText"},"& .calendar-footer .calendar-footer-right-side":{display:"flex",alignItems:"center",gap:"$4"},"& .calendar-footer .preview-date":{margin:0,fontSize:"$body3"},"& .calendar-footer button":{padding:"$1 $2_5",height:"$8",fontSize:"$label2"},variants:{variants:{extend:{display:"flex",flexDirection:"row",padding:0,"& > div:nth-child(2)":{padding:"$4"}},basic:{}}},defaultVariants:{variants:"basic"}});N("div",{display:"flex",flexDirection:"row"});const Ne=ge.forwardRef((r,e)=>{var S,F,w,O,p;const{state:f,hasFooter:u,css:v={},maxValue:n=fe("2999-02-17"),hasShortcuts:d=!1,ctaButtonRender:l,onSearchButtonClick:s,customShortcuts:o,...a}=r,{locale:R}=ne(),t=We({...a,value:r.state?(S=r.state)==null?void 0:S.value:r.value,visibleDuration:{months:2},locale:R,createCalendar:be}),h=ke(e),{calendarProps:V,prevButtonProps:b,nextButtonProps:$}=Ae(a,t,h),y=me({}),{setIsReset:C}=Se(),B=()=>{t.setValue({start:null,end:null}),t.setAnchorDate(null),C==null||C(!0)},c=()=>{var I;const P={start:L(M()),end:L(M())};f?f==null||f.setDateRange(P):t.setValue(P),t.setAnchorDate(null),(I=t.setFocusedDate)==null||I.call(t,L(M()))},k=g.useCallback(()=>l||(d?D(U,{variant:"primary",onPress:P=>s==null?void 0:s(P),children:"Search"}):D(U,{variant:"primary",onPress:c,children:"Today"})),[l,d]);return A(Le,{ref:h,css:v,variants:d?"extend":"basic",children:[d?D(Me,{state:t,pickerState:f,customShortcuts:o}):D(ve,{}),A($e,{children:[D(Fe,{state:t,variant:"range",calendarProps:V,prevButtonProps:b,nextButtonProps:$}),A("div",{className:"calendar-body",children:[D(ae,{state:t,maxValue:n}),D(ae,{state:t,offset:{months:1},maxValue:n})]}),u&&A("div",{className:"calendar-footer",children:[D(U,{variant:"ghost",onPress:B,children:"Clear"}),A("div",{className:"calendar-footer-right-side",children:[D("p",{className:"preview-date",children:(F=t==null?void 0:t.value)!=null&&F.start&&((w=t==null?void 0:t.value)!=null&&w.end)?y.formatRange(t.value.start.toDate(M()),t.value.end.toDate(M())):`${(O=t==null?void 0:t.value)!=null&&O.start?y.format(t.value.start.toDate(M())):""} - ${(p=t==null?void 0:t.value)!=null&&p.end?y.format(t.value.end.toDate(M())):""}`}),k()]})]})]})]})}),_e=Ne;export{_e as R};
