import{j as a}from"./jsx-runtime-ea7736fc.js";import{R as s,r as Q}from"./index-6c164b11.js";import{P as X}from"./index-f318de67.js";import{C as Y}from"./objectToCSS-aff350d4.js";import{u as Z}from"./use-dom-ref-7c72e1a5.js";const ee="_popover_qa1ah_7",te="_emptyMessage_qa1ah_24",oe="_option_qa1ah_44",se="_hover_qa1ah_64",ne="_autoComplete_qa1ah_73",o={popover:ee,emptyMessage:te,option:oe,hover:se,autoComplete:ne},q=s.forwardRef((A,D)=>{var j;const{children:N,options:l,onSearch:m,onSelect:O,searchedValue:r,debounce:k,notFoundContent:M="No Results Found",css:P={},onLoadMore:h,isLoadingMore:I,className:$,...F}=A,[v,u]=s.useState(!1),[g,H]=s.useState(null),[W,V]=s.useState(null),[R,B]=s.useState(null),c=Z(D),T=s.useRef(null),x=s.useRef(null),K=((j=x.current)==null?void 0:j.querySelector("input"))??x.current,U=()=>{!r||!m||m(r)},z=s.Children.map(N,e=>s.cloneElement(e,{ref:x,onFocus:()=>U(),onKeyDown:t=>{J(t)}})),w=e=>{V(e),O&&O(e),u(!1)},y=Q.useRef(null),G=()=>{const e=y.current;e&&e.scrollTop===e.scrollHeight&&h&&!I&&h()},L=(e,t)=>{const p=t.offsetTop,d=p+t.clientHeight,f=e.scrollTop,_=f+e.clientHeight;p<f?e.scrollTop=p:d>_&&(e.scrollTop=d-e.clientHeight+t.clientHeight)},J=e=>{var p,d,f,_;const t=y.current;if(t&&K){const n=Array.from((document==null?void 0:document.querySelectorAll('[role="option"]'))??[]),E=n[0],S=n[n.length-1],b=t.querySelector(`.${o.hover}`);switch(e.key){case"ArrowUp":if(e.preventDefault(),E.classList.contains(o.hover))E.classList.remove(o.hover),S.classList.add(o.hover),L(t,S);else{const i=n.findIndex(C=>C.classList.contains(o.hover));(p=n[i])==null||p.classList.remove(o.hover),(d=n[i-1])==null||d.classList.add(o.hover),L(t,n[i-1])}break;case"ArrowDown":if(e.preventDefault(),S.classList.contains(o.hover))h&&!I?h():(S.classList.remove(o.hover),E.classList.add(o.hover),L(t,E));else{const i=n.findIndex(C=>C.classList.contains(o.hover));(f=n[i])==null||f.classList.remove(o.hover),(_=n[i+1])==null||_.classList.add(o.hover),L(t,n[i+1])}break;case"Enter":e.preventDefault(),b&&w(b.dataset.value??"");break;case"Escape":e.preventDefault(),u(!1);break}}};return s.useEffect(()=>{if(T.current=r,r&&r!==W){g&&clearTimeout(g);const e=setTimeout(()=>{T.current===r&&m&&m(r)},k);H(e)}else u(!1);return()=>{g&&clearTimeout(g)}},[r]),s.useEffect(()=>{r&&u(!0)},[l]),s.useEffect(()=>{const e=y.current;if(v&&e){const t=e.querySelector('[role="option"]');t?t.classList.add(o.hover):e.classList.add(o.hover)}},[v,x]),s.useEffect(()=>{const e=t=>{c.current&&!c.current.contains(t.target)&&u(!1)};return document.addEventListener("pointerdown",e),()=>{document.removeEventListener("pointerdown",e)}},[c]),s.useEffect(()=>{const e=c.current;if(e){const t=e.clientWidth;B(t)}},[c]),a.jsx(a.Fragment,{children:a.jsx(Y,{css:P,children:a.jsx("div",{className:`${o.autoComplete} ${$} cdg-auto-complete`,ref:c,...F,"aria-haspopup":"true","aria-expanded":v?"true":"false","aria-controls":"autocomplete-popover",tabIndex:-1,children:a.jsx(X,{isOpen:v,anchor:z,direction:"bottom-center",isFloatingPortal:!1,attachToElement:c.current&&c.current.parentElement,children:a.jsx("div",{className:`${o.popover} cdg-auto-complete-popover`,ref:y,style:{width:R?`${R}px`:"auto"},onScroll:G,tabIndex:-1,children:(l==null?void 0:l.length)===0?a.jsx("div",{className:`${o.emptyMessage} cdg-auto-complete-empty-message`,children:M}):l==null?void 0:l.map(e=>a.jsx("div",{className:`${o.option} cdg-auto-complete-option`,"data-value":e,onClick:()=>w(e),tabIndex:0,role:"option",children:e},e))})})})})})});q.__docgenInfo={description:"",methods:[],displayName:"AutoComplete"};q.displayName="AutoComplete";export{q as A};
