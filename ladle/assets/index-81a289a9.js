import{S as Re,a as De,B as te,b as ne,c as Fe,P as Be,D as Me}from"./index.styles-9da73027.js";import{I as Ie,p as Ee,a as Oe,t as We,L as Ke,D as oe,b as Ne}from"./utils-181510c1.js";import{u as je,a as ze,b as Ae,D as He,c as Te,z as Pe}from"./floating-ui.react.esm-f386e9e8.js";import{s as E,R as r,a as m,j as e,F as Q}from"./index-c4b12c2d.js";import{S as Y}from"./dropdown.styles-981000ec.js";import{u as j}from"./use-dom-ref-63e485bc.js";const _e=E("div",{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:"$6",height:"$6",variants:{isSelected:{true:{div:{border:0,background:"$cdgBlue100",svg:{display:"block"}}},false:{svg:{display:"none"}}},checkmark:{checkbox:{div:{border:"1px solid #323130",borderRadius:"3px",width:"$4",height:"$4",display:"flex",alignItems:"center",justifyContent:"center",background:"#FFFFFF"}},none:{},tick:{}}}});function ie({item:n,currentKeys:a,focusKey:h,disabledKeys:s,onSelect:c}){const u=r.useRef(null),{checkmark:f="checkbox"}=n.props,l=r.useMemo(()=>n.key?a.some(d=>d==n.key):!1,[a]),g=r.useMemo(()=>h==n.key,[h]),w=r.useMemo(()=>n.key?s.includes(n.key):!1,[s]),b=()=>{n.key&&!w&&c(n.key)};return r.useEffect(()=>{var d;g&&((d=u.current)==null||d.scrollIntoView({block:"nearest"}))},[g]),m(Re,{ref:u,isFocused:g,isSelected:l,onClick:b,isDisabled:w,children:[e(De,{children:n.props.children}),e(_e,{isSelected:l,checkmark:f,children:f==="checkbox"?e("div",{children:e(Ze,{})}):f==="tick"?e(Ue,{}):null})]})}const Ze=()=>e("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:e("path",{d:"M9.39158 1.86239C9.64736 2.12284 9.64736 2.54372 9.39158 2.80416L4.15319 8.13808C3.89741 8.39853 3.48407 8.39853 3.22829 8.13808L0.608522 5.47112C0.352823 5.21068 0.352823 4.7898 0.608522 4.52935C0.864262 4.26891 1.27883 4.26891 1.53461 4.52935L3.67232 6.72334L8.46668 1.86239C8.72246 1.60153 9.1358 1.60153 9.39158 1.86239Z",fill:"white"})}),Ue=()=>e("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M15.0265 3.47966C15.4357 3.89637 15.4357 4.56978 15.0265 4.98649L6.64506 13.5208C6.23581 13.9375 5.57446 13.9375 5.16521 13.5208L0.973587 9.25363C0.564469 8.83691 0.564469 8.16351 0.973587 7.74679C1.38277 7.33008 2.04608 7.33008 2.45533 7.74679L5.87567 11.2572L13.5466 3.47966C13.9559 3.06228 14.6172 3.06228 15.0265 3.47966Z",fill:"#0142AF"})});function Ve(n){const a=r.useRef(null),{focusKey:h,isLoading:s,collection:c,currentKeys:u,disabledKeys:f,rootChildren:l,listBoxRef:g=a,sectionCollection:w,onSelect:b,onLoadMore:d}=n;return e(te,{isLoading:s,listBoxRef:g,collection:c,sectionCollection:w,rootChildren:l,onLoadMore:d,renderOptions:v=>v.map(C=>m("div",{children:[C.title&&e(ne,{children:C.title}),C.children.map(L=>L?e(ie,{item:L,focusKey:h,currentKeys:u,disabledKeys:f,onSelect:b},L.key):null)]},C.id))})}const re=E("div",{maxWidth:"100%",minHeight:"$11",borderRadius:"$md",cursor:"text",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"$1_5 $4",gap:"$1",backgroundColor:"#FFFFFF",transition:"$default",borderWidth:"1px",borderStyle:"solid",borderColor:"#E6E6E6",".dropdown-icon":{cursor:"pointer",flexShrink:0,display:"flex",justifyContent:"center",alignItems:"center",padding:0,border:"none",background:"transparent",svg:{width:"$4",height:"$4"}},"&:focus-within":{borderColor:"$cdgBlue"},input:{height:"$6_5",width:4,padding:0,margin:0,border:"none","&:focus":{outline:"none"},"&:focus-visible":{outline:"none"}},variants:{isEmpty:{true:{button:{p:{color:"#B4B4B4"}}}},isDisabled:{true:{backgroundColor:"$gray20","*":{color:"$disabledText",cursor:"not-allowed !important"}}},isErrored:{true:{borderColor:"$danger","&:focus-within":{borderColor:"$danger"}}}}}),le=E("div",{flexGrow:1,alignItems:"center",minHeight:"$7",display:"flex",gap:"$2_5",flexWrap:"wrap",".placeholder":{color:"#B4B4B4",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:"$label1",fontWeight:"$semibold",maxWidth:"100%",height:"fit-content",lineHeight:"1em",border:"none",textAlign:"left",padding:0,margin:0}}),Xe=E("div",{border:"1px solid #E6E6E6",borderRadius:"$full",padding:"$1 $3",fontSize:"$label1",cursor:"default",fontWeight:"$semibold",display:"flex",justifyContent:"center",alignItems:"center",gap:"$2",div:{width:"fit-content",height:"fit-content"}}),qe=E("div",{width:"100%",label:{fontSize:"$label1",fontWeight:"$semibold",marginBottom:"$2",display:"inline-block",width:"100%",span:{marginLeft:"$1",color:"$danger"}},variants:{displayedValue:{chip:{},string:{[`${le}`]:{flexWrap:"nowrap",justifyContent:"flex-start",maxWidth:"calc(100% - 1rem - 1rem)",".itemListString":{maxWidth:"100%",height:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}}},variant:{combobox:{},select:{[`${re}`]:{cursor:"pointer"}}}}}),Ge=r.forwardRef((n,a)=>{const{collection:h,rootChildren:s,sectionCollection:c,listBoxRef:u,isLoading:f,numberOfRows:l,onLoadMore:g}=n,w=j(a);return l&&l>=0?e(Fe,{ref:w,children:e(te,{isLoading:f,collection:h,listBoxRef:u,rootChildren:s,sectionCollection:c,renderOptions:b=>b.slice(0,Math.min(l,h.length)).map(d=>m("div",{children:[d.title&&e(ne,{children:d.title}),d.children.map(v=>v?e(ie,{item:v,focusKey:void 0,currentKeys:[],disabledKeys:[],onSelect:()=>{}},v.key):null)]},d.id)),onLoadMore:g})}):null}),Je=Ge,Qe=()=>m("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:[e("g",{clipPath:"url(#clip0_5299_13653)",children:e("path",{d:"M9.11731 7.88215C9.45908 8.22392 9.45908 8.77759 9.11731 9.11936C8.94779 9.29024 8.72359 9.375 8.49938 9.375C8.27518 9.375 8.05153 9.28956 7.88092 9.11867L4.99966 6.23892L2.11867 9.11799C1.94779 9.29024 1.72386 9.375 1.49993 9.375C1.276 9.375 1.05235 9.29024 0.881328 9.11799C0.539557 8.77622 0.539557 8.22255 0.881328 7.88078L3.76313 4.99897L0.881328 2.11854C0.539557 1.77677 0.539557 1.2231 0.881328 0.881328C1.2231 0.539557 1.77677 0.539557 2.11854 0.881328L4.99966 3.7645L7.88146 0.882695C8.22323 0.540925 8.7769 0.540925 9.11867 0.882695C9.46044 1.22446 9.46044 1.77813 9.11867 2.1199L6.23687 5.00171L9.11731 7.88215Z",fill:"#3B3A39"})}),e("defs",{children:e("clipPath",{id:"clip0_5299_13653",children:e("rect",{width:"10",height:"10",fill:"white"})})})]});function ee(n,a,h){if(a!=null&&a.length>=0){const s=[];for(const c of a)s.push(c);return s}else if(n!=null&&n.length>0&&h){const s=[];for(const c of n)s.push(c);return s}return[]}const Ye=r.forwardRef((n,a)=>{const{id:h=`cdg-element-${Math.random().toString(36).substring(2)}`,css:s={},isOpen:c,children:u,isErrored:f,isDisabled:l,isRequired:g,isReadOnly:w,helperText:b,defaultOpen:d,errorMessage:v,selectedKeys:C,numberOfRows:L,displayedValue:O="chip",icon:se=e(Ie,{}),disabledKeys:R=[],isLoading:A=!1,variant:_="combobox",customDisplayValue:H,defaultSelectedKeys:Z=[],onLoadMore:ce=()=>{},onBlur:de=()=>{},onFocus:ae=()=>{},...ue}=n,[S,k]=r.useState(!1),[he,U]=r.useState(!1),[D,fe]=r.useState(""),[y,V]=r.useState(ee(Z,C)),[p,F]=r.useState(),pe=j(a),W=j(null),B=j(null),ge=r.useRef(null),ye=r.useRef(null),X=r.useRef(null),{refs:q,floatingStyles:me,context:we}=je({open:S,onOpenChange:k,middleware:[He(8),Te()],whileElementsMounted:Pe}),be=ze(we),{getReferenceProps:ve,getFloatingProps:Ce}=Ae([be]),x=r.useMemo(()=>Ee(u,oe),[u]),G=r.useMemo(()=>Oe(u),[u]),M=r.useMemo(()=>D===""?x:x.filter(t=>{const o=We(t);return o==null?void 0:o.toLowerCase().includes(D.toLowerCase())}),[x,D]),K=r.useMemo(()=>new Ke(M,R),[M,R]),$=r.useMemo(()=>{const t=[];return x.length>0&&y&&y.length>0&&y.forEach(o=>{const i=x.find(N=>N.key==o);i&&t.push({key:o,rendered:i==null?void 0:i.props.children})}),t},[y,x,y.length]);r.useEffect(()=>{V(ee(Z,C,!0))},[JSON.stringify(C),x]),r.useEffect(()=>{!c&&d&&k(d),c&&k(c)},[c]),r.useEffect(()=>{var t,o,i;F([...y].pop()),(t=n.onOpenChange)==null||t.call(n,S),S?(o=B.current)==null||o.focus():(i=B.current)==null||i.blur()},[S]);const xe=t=>{if(W.current){const o=t.target.value;if(fe(o),k(!0),o!==""){const i=document.createElement("div");i.style.position="absolute",i.style.top="0",i.style.left="-9999px",i.style.overflow="hidden",i.style.visibility="hidden",i.style.whiteSpace="nowrap",i.style.height="0",i.style.width="fit-content",i.style.maxWidth=`${W.current.clientWidth-62}px`,i.innerHTML=o.replace(/\s/g,"&nbsp;"),document.body.appendChild(i),t.target.focus(),t.target.style.width=`${i.clientWidth+4}px`,i.remove()}else t.target.style.width="4px"}},ke=t=>{switch(t.key){case"ArrowUp":case"ArrowLeft":{t.preventDefault();const o=p!=null&&p!=-1?K.getKeyAbove(p):K.getFirstKey();o&&F(o);break}case"ArrowDown":case"ArrowRight":{t.preventDefault();const o=p!=null&&p!=-1?K.getKeyBelow(p):K.getFirstKey();o&&F(o);break}case"Enter":{t.preventDefault(),p&&T(p);break}case"Escape":{t.preventDefault(),k(!1);break}case"Tab":{k(!1);break}}},T=(t,o=!1)=>{var i,N;if(!w){const I=new Set(y),P=y.find(Le=>Le==t);P?(I.delete(P),P==p&&F(Array.from(I).pop()??void 0)):o||(I.add(t),F(t)),V([...I]),(i=n.onSelectionChange)==null||i.call(n,[...I]),(N=B.current)==null||N.focus()}},Se=t=>{T(t,!0)},J=()=>{var t;l||(k(!0),(t=B.current)==null||t.focus())},$e=()=>{const t=$.map(o=>o.rendered);return t.length>0?e(Q,{children:t.join(", ")}):""};return m(qe,{css:s,ref:pe,...ue,displayedValue:O,variant:_,children:[n.label&&m("label",{onClick:J,htmlFor:h,children:[n.label,g&&e("span",{children:"*"})]}),e("div",{ref:q.setReference,...ve,children:m(re,{className:"dropdownContainer",ref:W,isErrored:!!f,isDisabled:!!l,onClick:J,children:[m(le,{className:"selectedItemWrapper",children:[$.length===0&&D===""&&!S&&!he&&e("p",{className:"placeholder",children:n.placeholder}),O=="chip"&&$.length>0&&$.map(t=>{const o=l||R.includes(t.key);return m(Xe,{style:{cursor:l?"not-allowed":"pointer"},className:"multiple-dropdown-chip",children:[e("div",{children:t.rendered}),o?e(Q,{}):e("div",{className:"multiple-dropdown-chip-icon",onClick:()=>{!l&&![...R].includes(t.key)&&Se(t.key)},children:e(Qe,{})})]},t.key)}),O=="string"&&H&&$.length>0?e("div",{className:"itemListString",children:H}):O=="string"&&!H&&$.length>0?e("div",{className:"itemListString",children:$e()}):null,!l&&_=="combobox"&&e("input",{id:h,type:"text",ref:B,value:D,onChange:xe,onBlur:()=>U(!1),onFocus:()=>U(!0)})]}),e("div",{className:"dropdown-icon",children:se})]})}),M&&S&&e("div",{className:"Popover",ref:q.setFloating,style:{...me,zIndex:60},...Ce,children:e(Be,{isEmpty:A?!1:M.length===0,visualizeRef:X,triggerRef:W,onBlur:de,onFocus:ae,handleKeyDown:ke,children:e(Ve,{focusKey:p,isLoading:A,collection:M,rootChildren:u,listBoxRef:ge,currentKeys:y,disabledKeys:R,sectionCollection:G,onSelect:T,onLoadMore:ce})})}),e(Je,{ref:ye,isLoading:A,collection:x,listBoxRef:X,rootChildren:u,numberOfRows:L,sectionCollection:G,onLoadMore:()=>{}}),f&&v&&e(Y,{error:!!f,children:v}),b&&e(Y,{children:b})]})}),z=Ye;z.Item=oe;z.Header=Me;z.Section=Ne;z.displayName="MultipleDropdown";export{z as M};
