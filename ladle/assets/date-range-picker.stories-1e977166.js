import{r as Z,s as ee,R as W,j as n,a as I,F as le}from"./index-ea08e0bd.js";import"./index-b9bff82c.js";import"./index-7017da3c.js";import{u as re,a as se,b as ie,c as de,d as oe,D as z,P as ue,e as ce}from"./useOverlayTriggerState-ddab6b6a.js";import{u as be,a as he,b as A,c as me,f as fe,r as De,d as ye,e as ge,i as H,g as k,h as Q,D as _,t as J,j as X,k as Ce,p as Pe,l as Y}from"./useCalendarState-658559c1.js";import{u as Se,R as ve}from"./range-calendar-e94eaa54.js";import{u as Ve}from"./use-dom-ref-1c255a25.js";import{C as ae}from"./calendar-1c4cb121.js";import{B as Fe}from"./button-58030a58.js";import{C as Oe}from"./components-d18c5221.js";import"./useEvent-55a6ca15.js";import"./import-103c32e0.js";import"./arrow-right-fade11cb.js";import"./index-4fd0b8c6.js";function Re(e,l,d){var t,s;const{labelProps:o,fieldProps:u,descriptionProps:P,errorMessageProps:a}=re({...e,labelElementType:"span"}),c=u["aria-labelledby"]||u.id,{locale:V}=be(),b=l.formatValue(V,{month:"long"}),D=b?`selectedRangeDescription ${b.start} ${b.end}`:"",m=he(D),i={"aria-label":"startDate","aria-labelledby":c},f={"aria-label":"endDate","aria-labelledby":c},r=A(),S=A(),y=se(l,d),v=[m["aria-describedby"],u["aria-describedby"]].filter(Boolean).join(" ")||void 0,O=Z.useMemo(()=>me(d,{accept:h=>h.id!==r}),[d,r]),R={[fe]:O,[De]:"presentation","aria-describedby":v,minValue:e.minValue,maxValue:e.maxValue,placeholderValue:e.placeholderValue,hideTimeZone:e.hideTimeZone,hourCycle:e.hourCycle,granularity:e.granularity,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isRequired:e.isRequired,validationState:l.validationState},M=ye(e),{focusWithinProps:x}=ie({...e,isDisabled:l.isOpen,onBlurWithin:e.onBlur,onFocusWithin:e.onFocus,onFocusWithinChange:e.onFocusChange});return{groupProps:{...M,...y,...u,...m,...x,role:"group","aria-disabled":e.isDisabled||null,"aria-describedby":v,onKeyDown(h){l.isOpen||e.onKeyDown&&e.onKeyDown(h)},onKeyUp(h){l.isOpen||e.onKeyUp&&e.onKeyUp(h)}},labelProps:{...o,onClick:()=>{O.focusFirst()}},buttonProps:{...m,id:r,"aria-haspopup":"dialog","aria-label":"calendar","aria-labelledby":`${c} ${r}`,"aria-describedby":v,"aria-expanded":l.isOpen||void 0,onPress:()=>l.setOpen(!0)},dialogProps:{id:S,"aria-labelledby":`${c} ${r}`},startFieldProps:{...i,...R,value:(t=l.value)==null?void 0:t.start,onChange:h=>l.setDateTime("start",h),autoFocus:e.autoFocus},endFieldProps:{...f,...R,value:(s=l.value)==null?void 0:s.end,onChange:h=>l.setDateTime("end",h)},descriptionProps:P,errorMessageProps:a,calendarProps:{autoFocus:!0,value:l.dateRange,onChange:l.setDateRange,minValue:e.minValue,maxValue:e.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly,isDateUnavailable:e.isDateUnavailable,allowsNonContiguousRanges:e.allowsNonContiguousRanges,defaultFocusedValue:l.dateRange?void 0:e.placeholderValue,validationState:l.validationState,errorMessage:e.errorMessage}}}function Me(e){var M,x;const l=de(e),[d,o]=ge(e.value,e.defaultValue||null,e.onChange);let[u,P]=Z.useState(()=>d||{start:null,end:null});d==null&&u.start&&u.end&&(u={start:null,end:null},P(u));const a=d||u,c=t=>{P(t),t.start||t.end?o(t):o(null)},V=a.start||a.end||e.placeholderValue,[b]=oe(V,e.granularity),D=b==="hour"||b==="minute"||b==="second",m=e.shouldCloseOnSelect??!0;let[i,f]=Z.useState(null),[r,S]=Z.useState(null);a&&a.start&&a.end&&(i=a,"hour"in a.start&&(r=a));const y=(t,s)=>{t.end&&t.start&&s.end&&s.start&&(c({start:"timeZone"in s.start?s.start.set(J(t.start)):X(t.start,s.start),end:"timeZone"in s.end?s.end.set(J(t.end)):X(t.end,s.end)}),f(null),S(null))},v=t=>{let s=typeof m=="function"?m():m;D?s||t.start&&t.end&&(r!=null&&r.start)&&r.end?y(t,{start:(r==null?void 0:r.start)||k(e.placeholderValue),end:(r==null?void 0:r.end)||k(e.placeholderValue)}):f(t):t.start||t.end?c(t):!t.start||!t.end?(o({start:null,end:null}),f(null)):f(t),s&&t.start&&t.end&&l.setOpen(!1)},O=t=>{i!=null&&i.start&&i.end&&t.start&&t.end?y(i,t):S(t)},R=e.validationState||(a!=null&&(H(a.start,e.minValue,e.maxValue)||H(a.end,e.minValue,e.maxValue)||a.end!=null&&a.start!=null&&a.end.compare(a.start)<0||a.start&&((M=e.isDateUnavailable)!=null&&M.call(e,a.start))||a.end&&((x=e.isDateUnavailable)!=null&&x.call(e,a.end)))?"invalid":null);return{value:a,setValue:c,dateRange:i,timeRange:r,granularity:b,hasTime:D,setDate(t,s){v({...i,[t]:s})},setTime(t,s){O({...r,[t]:s})},setDateTime(t,s){c({...a,[t]:s})},setDateRange:v,setTimeRange:O,...l,setOpen(t){!t&&!(a.start&&a.end)&&(i!=null&&i.start)&&i.end&&D&&y(i,{start:(r==null?void 0:r.start)||k(e.placeholderValue),end:(r==null?void 0:r.end)||k(e.placeholderValue)}),l.setOpen(t)},validationState:R,formatValue(t,s){if(!a||!a.start||!a.end)return null;const h="timeZone"in a.start?a.start.timeZone:void 0,w=e.granularity||(a.start&&"minute"in a.start?"minute":"day"),L="timeZone"in a.end?a.end.timeZone:void 0,N=e.granularity||(a.end&&"minute"in a.end?"minute":"day"),ne=Q(s,{granularity:w,timeZone:h??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24,showEra:a.start.calendar.identifier==="gregory"&&a.start.era==="BC"||a.end.calendar.identifier==="gregory"&&a.end.era==="BC"}),K=a.start.toDate(h||"UTC"),j=a.end.toDate(L||"UTC"),B=new _(t,ne);let E;if(h===L&&w===N&&a.start.compare(a.end)!==0){try{const F=B.formatRangeToParts(K,j);let $=-1;for(let g=0;g<F.length;g++){const U=F[g];if(U.source==="shared"&&U.type==="literal")$=g;else if(U.source==="endRange")break}let G="",q="";for(let g=0;g<F.length;g++)g<$?G+=F[g].value:g>$&&(q+=F[g].value);return{start:G,end:q}}catch{}E=B}else{const F=Q(s,{granularity:N,timeZone:L??"UTC",hideTimeZone:!!e.hideTimeZone,hourCycle:e.hourCycle??24});E=new _(t,F)}return{start:B.format(K),end:E.format(j)}}}}const xe=ee("div",{width:"fit-content","@max_768":{"& .date-range-fields":{flexDirection:"column",gap:"$6"},"&":{width:"100%"}}}),Te=ee("div",{"& .date-range-fields":{display:"flex",gap:"$6"}}),Le=W.forwardRef((e,l)=>{const{startDateLabel:d,endDateLabel:o,shouldCloseOnSelect:u=!1,css:P={},errorMessage:a,helperText:c,maxValue:V,hasShortcuts:b,ctaButtonRender:D,visibleMonths:m,onSearchButtonClick:i,customShortcuts:f,...r}=e,S=Me({...r,isReadOnly:e.isReadOnly?!0:!!e.isMobile,shouldCloseOnSelect:e.granularity?!0:u??!1}),y=Ve(l),{labelProps:v,groupProps:O,startFieldProps:R,endFieldProps:M,buttonProps:x,dialogProps:t,calendarProps:s}=Re({...r,isReadOnly:e.isReadOnly?!0:!!e.isMobile,"aria-label":"date range picker","aria-describedby":""},S,y),h={necessityIndicator:e.necessityIndicator,...R},w={necessityIndicator:e.necessityIndicator,...M},L=()=>e.isReadOnly?!0:!(!e.isReadOnly&&!e.isMobile||e.isMobile);return s.isReadOnly=L(),n(xe,{ref:y,css:P,className:"date-range-picker-wrapper",children:I(Ce,{children:[n(Ie,{state:S,label:e.label,labelProps:v,groupProps:O,startFieldProps:h,endFieldProps:w,buttonProps:x,startDateLabel:d,endDateLabel:o,isInvalid:e.isInvalid,isReadOnly:e.isReadOnly,isMobile:e.isMobile,errorMessage:a,helperText:c}),n(we,{maxValue:V,state:S,calendarRef:y,dialogProps:t,calendarProps:s,hasShortcuts:b,ctaButtonRender:D,onSearchButtonClick:i,customShortcuts:f,css:e.calendarCSS,visibleMonths:m})]})})}),Ie=W.forwardRef((e,l)=>{const{label:d,labelProps:o,groupProps:u,startFieldProps:P,endFieldProps:a,buttonProps:c,startDateLabel:V,endDateLabel:b,isInvalid:D,isMobile:m,isReadOnly:i=!1,errorMessage:f,helperText:r}=e;return I(Te,{children:[n("span",{...o,className:"date-range-label",children:d}),n("div",{...u,ref:l,className:"date-range-inputs-body",children:I("div",{className:"date-range-fields",children:[n(z,{...P,label:V,buttonProps:c,isInvalid:D,isMobile:m,isReadOnly:i,errorMessage:f,helperText:r}),n(z,{...a,label:b,buttonProps:c,isInvalid:D,isMobile:m,isReadOnly:i})]})})]})}),we=e=>{const{state:l,calendarRef:d,dialogProps:o,calendarProps:u,css:P={},hasShortcuts:a=!1,maxValue:c=Pe("2999-03-10"),ctaButtonRender:V,visibleMonths:b,onSearchButtonClick:D,customShortcuts:m}=e,{value:i,onChange:f,...r}=u,S=Se("(max-width: 768px)"),y=v=>{f&&f(v)};return n(le,{children:l.isOpen&&n(ue,{state:l,triggerRef:d,placement:"bottom start",offset:8,children:n(ce,{...o,"aria-describedby":o["aria-describedby"]??"","aria-label":o["aria-label"]??"","aria-labelledby":o["aria-labelledby"]??"",children:n(ve,{css:P,state:l,hasFooter:!0,"aria-label":"","aria-labelledby":"",...i?{value:i}:{},onChange:y,...r,maxValue:c,hasShortcuts:a,ctaButtonRender:V,onSearchButtonClick:D,customShortcuts:m,visibleMonths:b||(S?1:2)})})})})},C=Le,{I18nProvider:te,useDateFormatter:ke}=ae.I18N,{getLocalTimeZone:T,parseDate:p}=ae.InternationalizedDate,Qe=()=>n(te,{locale:"en-SG",children:I(Oe,{children:[n("h3",{children:"Basic"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date"}),n("br",{}),n("h3",{children:"Disabled"}),n(C,{isDisabled:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Read only"}),n(C,{isReadOnly:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Invalid"}),n(C,{isInvalid:!0,startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Min & Max"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date",minValue:Y(T()).add({days:1}),maxValue:Y(T()).add({days:7})}),n("h3",{children:"Is Mobile"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date",isMobile:!0}),n("h3",{children:"Helper texts"}),n(C,{isInvalid:!0,isRequired:!0,helperText:"Weekend is excluded",errorMessage:"Must not include weekend",startDateLabel:"Start date",endDateLabel:"End date"}),n("h3",{children:"Shortcuts"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date",hasShortcuts:!0}),n("h3",{children:"Custom Shortcuts Range Calendar"}),n(C,{startDateLabel:"Start date",endDateLabel:"End date",hasShortcuts:!0,customShortcuts:e=>{const l=[{label:"Custom Shortcut",getValue:()=>({start:null,end:null})}];return[...e,...l]},ctaButtonRender:n(Fe,{onPress:()=>{alert("Custom callback")},children:"Custom Button"})})]})}),_e=()=>{const[e,l]=W.useState({start:p("2020-02-03"),end:p("2020-02-08")}),d=ke({dateStyle:"long"});return I(te,{locale:"en-SG",children:[n("h3",{children:"Controlled"}),n("p",{children:e.start&&e.end?d.formatRange(e.start.toDate(T()),e.end.toDate(T())):`${e.start&&d.format(e.start.toDate(T()))} - ${e.end&&d.format(e.end.toDate(T()))}`}),n(C,{value:e,shouldCloseOnSelect:!0,startDateLabel:"Start Date",endDateLabel:"End Date",onChange:o=>l(o)})]})},Je=()=>n(C,{});typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{_e as Controlled,Je as Default,Qe as Variants};
