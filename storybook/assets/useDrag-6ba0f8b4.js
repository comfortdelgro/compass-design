import{r as i}from"./index-6c164b11.js";import{u as j}from"./useKeyboardNavigation-7c849a98.js";function B(n,e,a={updateFirstChange:!1}){const[r,p]=i.useState(n),l=i.useRef(),f=i.useRef(!0),u=()=>window.clearTimeout(l.current);i.useEffect(()=>u,[]);const m=i.useCallback(x=>{u(),f.current&&a.updateFirstChange?p(x):l.current=window.setTimeout(()=>{f.current=!0,p(x)},e),f.current=!1},[a.updateFirstChange,e]);return[r,m]}const _=(n,[e,a])=>Math.min(Math.max(n,e),a),G=n=>8*(Math.log(Math.abs(n)+1)-2),P=(n,e)=>{const a=G(n-e);return e>0?Math.min(e+Math.max(a,0),n):Math.max(e+Math.min(a*-1,0),n)},T=(n,e)=>{if(e===0||e===1)return n;const a=Math.floor(n/e)*e,r=Math.ceil(n/e)*e;return n-a>r-n?r:a},$=({x:n,y:e},a="both",r)=>{var l,f,u,m;const p={x:a==="vertical"?0:_(n,[((l=r==null?void 0:r.x)==null?void 0:l.min)??Number.NEGATIVE_INFINITY,((f=r==null?void 0:r.x)==null?void 0:f.max)??Number.POSITIVE_INFINITY]),y:a==="horizontal"?0:_(e,[((u=r==null?void 0:r.y)==null?void 0:u.min)??Number.NEGATIVE_INFINITY,((m=r==null?void 0:r.y)==null?void 0:m.max)??Number.POSITIVE_INFINITY])};return{limittedPosition:p,isLimitExceeded:p.x!==n||p.y!==e}};let A=null;const H=500,U="cubic-bezier(0.32, 0.72, 0, 1)",K=n=>{const e=i.useMemo(()=>{const t={touch:!0,mouse:!0,direction:"both",stepSize:0,decelerationEffect:!1,manualStylingOnMove:!1,returnedPositionDebounceTime:0,addBrowserHintStyles:!0,ignorePointerCancel:!1,disabled:!1,...n};return t.disabled&&(t.mouse=!1,t.touch=!1),t},[n]),a=i.useRef(null),r=e.targetRef||a,p=i.useRef({x:0,y:0}),l=i.useRef({x:0,y:0}),f=i.useRef(!1),[u,m]=B({x:0,y:0},e.returnedPositionDebounceTime??0),x=typeof window<"u"?CSS.supports("translate","0"):!1,z=`${x?"translate":"transform"} ${H}ms ${U}`,y=i.useCallback((t,s)=>{if(!r.current)return;if(!(s!=null&&s.skipCalulateStep)&&e.stepSize&&(t={x:T(u.x,typeof e.stepSize=="object"?e.stepSize.x:e.stepSize),y:T(u.y,typeof e.stepSize=="object"?e.stepSize.y:e.stepSize)}),l.current=t,s!=null&&s.shouldUpdatePositionState){(u.x!==t.x||u.y!==t.y)&&m(t);return}const d=r.current.style;s!=null&&s.transition?d.setProperty("transition",s.transition===!0?z:s.transition):d.removeProperty("transition"),x?d.setProperty("translate",`${t.x}px ${t.y}px`):d.setProperty("transform",`translate3d(${t.x}px, ${t.y}px, 0)`)},[z,x,e.stepSize,u.x,u.y,m,r]),S=i.useCallback(t=>{if(e.disabled)return!0;switch(t.pointerType){case"mouse":return e.mouse?t.type==="pointermove"?t.button!==-1:t.button!==0:!0;case"touch":case"pen":return!e.touch;default:return!0}},[e.disabled,e.mouse,e.touch]),I=i.useCallback(t=>{var o,c,E;if(S(t))return;const s=t.currentTarget;s&&s.setPointerCapture(t.pointerId),(c=(o=r.current)==null?void 0:o.style)==null||c.removeProperty("transition");const{x:d,y:h}=l.current;f.current=!0;const b={x:t.clientX-d,y:t.clientY-h};p.current=b,(E=e.onStart)==null||E.call(e,r,b,y)},[e,y,S,r]),M=i.useCallback(t=>{var F,L,Y,k,w,O,X,D,V;if(!f.current||S(t))return;const{x:s,y:d}=p.current,{x:h,y:b}=l.current;let o=e.direction==="vertical"?0:t.clientX-s,c=e.direction==="horizontal"?0:t.clientY-d;if(o===h&&c===b)return;if(e.decelerationEffect){const v=(L=(F=e.limit)==null?void 0:F.x)==null?void 0:L.min,N=(k=(Y=e.limit)==null?void 0:Y.x)==null?void 0:k.max,C=(O=(w=e.limit)==null?void 0:w.y)==null?void 0:O.min,R=(D=(X=e.limit)==null?void 0:X.y)==null?void 0:D.max;C!==void 0&&c<C&&(c=P(c,C)),R!==void 0&&c>R&&(c=P(c,R)),v!==void 0&&o<v&&(o=P(o,v)),N!==void 0&&o>N&&(o=P(o,N))}else{const{limittedPosition:v}=$({x:o,y:c},e.direction,e.limit);o=v.x,c=v.y}e.stepSize&&(o=T(o,typeof e.stepSize=="object"?e.stepSize.x:e.stepSize),c=T(c,typeof e.stepSize=="object"?e.stepSize.y:e.stepSize));const E={x:o,y:c};(V=e.onMove)==null||V.call(e,r,E),y(E,{skipCalulateStep:!0,shouldUpdatePositionState:e.manualStylingOnMove})},[e,y,S,r]),g=i.useCallback(t=>{var s,d,h;if(f.current&&!S(t)){if(e.decelerationEffect&&e.limit){const{limittedPosition:b,isLimitExceeded:o}=$(l.current,e.direction,e.limit);o&&y(b,{skipCalulateStep:!0,transition:!0})}else(d=(s=r.current)==null?void 0:s.style)==null||d.setProperty("transition",A);f.current=!1,(h=e.onEnd)==null||h.call(e,r,l.current,y)}},[e,y,S,r]);return i.useEffect(()=>{if(typeof window>"u")return;const t=r.current;if(t)return t.addEventListener("pointerdown",I),t.addEventListener("pointermove",M),t.addEventListener("pointerup",g),e.ignorePointerCancel||t.addEventListener("pointercancel",g),()=>{t.removeEventListener("pointerdown",I),t.removeEventListener("pointermove",M),t.removeEventListener("pointerup",g),e.ignorePointerCancel||t.removeEventListener("pointercancel",g)}},[g,M,I,e.ignorePointerCancel,r]),j(()=>{typeof window>"u"||!r.current||(A=r.current.style.getPropertyValue("transition")||null,e.addBrowserHintStyles&&(r.current.style.setProperty("will-change","transform"),r.current.style.setProperty("touch-action","none")))},[r,e.addBrowserHintStyles]),{target:r,position:u,setPosition:y}};export{K as u};
