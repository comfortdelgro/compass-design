import{j as a}from"./jsx-runtime-9ef10904.js";import{R as s,r as X}from"./index-6c164b11.js";import{P as Y}from"./index-d88a2748.js";import{C as Z,c as C}from"./objectToCSS-e90bd687.js";import{u as ee}from"./use-dom-ref-7c72e1a5.js";const te="_popover_qa1ah_7",oe="_emptyMessage_qa1ah_24",se="_option_qa1ah_44",ne="_hover_qa1ah_64",re="_autoComplete_qa1ah_73",o={popover:te,emptyMessage:oe,option:se,hover:ne,autoComplete:re},D=s.forwardRef((k,M)=>{var A;const{children:P,options:l,onSearch:u,onSelect:I,searchedValue:r,debounce:R,notFoundContent:F="No Results Found",css:H={},onLoadMore:v,isLoadingMore:T,className:W,...V}=k,[g,d]=s.useState(!1),[f,B]=s.useState(null),[w,K]=s.useState(null),[j,$]=s.useState(null),c=ee(M),b=s.useRef(null),x=s.useRef(null),U=((A=x.current)==null?void 0:A.querySelector("input"))??x.current,z=()=>{!r||!u||u(r)},G=s.Children.map(P,e=>s.cloneElement(e,{ref:x,onFocus:()=>z(),onKeyDown:t=>{Q(t)}})),q=e=>{K(e),I&&I(e),d(!1)},y=X.useRef(null),J=()=>{const e=y.current;e&&e.scrollTop===e.scrollHeight&&v&&!T&&v()},L=(e,t)=>{const p=t.offsetTop,m=p+t.clientHeight,h=e.scrollTop,_=h+e.clientHeight;p<h?e.scrollTop=p:m>_&&(e.scrollTop=m-e.clientHeight+t.clientHeight)},Q=e=>{var p,m,h,_;const t=y.current;if(t&&U){const n=Array.from((document==null?void 0:document.querySelectorAll('[role="option"]'))??[]),E=n[0],S=n[n.length-1],N=t.querySelector(`.${o.hover}`);switch(e.key){case"ArrowUp":if(e.preventDefault(),E.classList.contains(o.hover))E.classList.remove(o.hover),S.classList.add(o.hover),L(t,S);else{const i=n.findIndex(O=>O.classList.contains(o.hover));(p=n[i])==null||p.classList.remove(o.hover),(m=n[i-1])==null||m.classList.add(o.hover),L(t,n[i-1])}break;case"ArrowDown":if(e.preventDefault(),S.classList.contains(o.hover))v&&!T?v():(S.classList.remove(o.hover),E.classList.add(o.hover),L(t,E));else{const i=n.findIndex(O=>O.classList.contains(o.hover));(h=n[i])==null||h.classList.remove(o.hover),(_=n[i+1])==null||_.classList.add(o.hover),L(t,n[i+1])}break;case"Enter":e.preventDefault(),N&&q(N.dataset.value??"");break;case"Escape":e.preventDefault(),d(!1);break}}};return s.useEffect(()=>{if(b.current=r,r&&r!==w){f&&clearTimeout(f);const e=setTimeout(()=>{b.current===r&&u&&u(r)},R);B(e)}else d(!1);return()=>{f&&clearTimeout(f)}},[R,u,r,w,f]),s.useEffect(()=>{r&&d(!0)},[l,r]),s.useEffect(()=>{const e=y.current;if(g&&e){const t=e.querySelector('[role="option"]');t?t.classList.add(o.hover):e.classList.add(o.hover)}},[g,x]),s.useEffect(()=>{const e=t=>{c.current&&!c.current.contains(t.target)&&d(!1)};return document.addEventListener("pointerdown",e),()=>{document.removeEventListener("pointerdown",e)}},[c]),s.useEffect(()=>{const e=c.current;if(e){const t=e.clientWidth;$(t)}},[c]),a.jsx(a.Fragment,{children:a.jsx(Z,{css:H,children:a.jsx("div",{className:C(o.autoComplete,W,"cdg-auto-complete"),ref:c,...V,"aria-haspopup":"true","aria-expanded":g?"true":"false","aria-controls":"autocomplete-popover",tabIndex:-1,children:a.jsx(Y,{isOpen:g,anchor:G,direction:"bottom-center",isFloatingPortal:!1,attachToElement:c.current&&c.current.parentElement,children:a.jsx("div",{className:C(o.popover,"cdg-auto-complete-popover"),ref:y,style:{width:j?`${j}px`:"auto"},onScroll:J,tabIndex:-1,children:(l==null?void 0:l.length)===0?a.jsx("div",{className:C(o.emptyMessage,"cdg-auto-complete-empty-message"),children:F}):l==null?void 0:l.map(e=>a.jsx("div",{className:C(o.option,"cdg-auto-complete-option"),"data-value":e,onClick:()=>q(e),tabIndex:0,role:"option",children:e},e))})})})})})});D.__docgenInfo={description:"",methods:[],displayName:"AutoComplete"};D.displayName="AutoComplete";export{D as A};
