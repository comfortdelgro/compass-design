var P=Object.defineProperty;var _=(n,e,t)=>e in n?P(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var o=(n,e,t)=>(_(n,typeof e!="symbol"?e+"":e,t),t);import{j as I}from"./jsx-runtime-9ef10904.js";import{r as i,R as C}from"./index-6c164b11.js";function M(n,e){return`${n} returned \`undefined\`. Seems you forgot to wrap component within ${e}`}function w(n={}){const{name:e,strict:t=!0,hookName:s="useContext",providerName:r="Provider",errorMessage:a,defaultValue:c}=n,l=i.createContext(c);l.displayName=e;function f(){const m=i.useContext(l);if(!m&&t){const x=new Error(a??M(s,r));throw x.name="ContextError",Error.captureStackTrace(x,f),x}return m}return[l.Provider,f,l]}function E(n){return n.sort((e,t)=>{const s=e.compareDocumentPosition(t);if(s&Node.DOCUMENT_POSITION_FOLLOWING||s&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(s&Node.DOCUMENT_POSITION_PRECEDING||s&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(s&Node.DOCUMENT_POSITION_DISCONNECTED||s&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}const S=n=>typeof n=="object"&&"nodeType"in n&&n.nodeType===Node.ELEMENT_NODE;function v(n,e,t){let s=n+1;return t&&s>=e&&(s=0),s}function g(n,e,t){let s=n-1;return t&&s<0&&(s=e),s}const b=typeof window<"u"?i.useLayoutEffect:i.useEffect,h=n=>n;class R{constructor(){o(this,"descendants",new Map);o(this,"register",e=>{if(e!=null)return S(e)?this.registerNode(e):t=>{this.registerNode(t,e)}});o(this,"unregister",e=>{this.descendants.delete(e);const t=E(Array.from(this.descendants.keys()));this.assignIndex(t)});o(this,"destroy",()=>{this.descendants.clear()});o(this,"assignIndex",e=>{this.descendants.forEach(t=>{const s=e.indexOf(t.node);t.index=s,t.node.dataset.index=t.index.toString()})});o(this,"count",()=>this.descendants.size);o(this,"enabledCount",()=>this.enabledValues().length);o(this,"values",()=>Array.from(this.descendants.values()).sort((t,s)=>t.index-s.index));o(this,"enabledValues",()=>this.values().filter(e=>!e.disabled));o(this,"item",e=>{if(this.count()!==0)return this.values()[e]});o(this,"enabledItem",e=>{if(this.enabledCount()!==0)return this.enabledValues()[e]});o(this,"first",()=>this.item(0));o(this,"firstEnabled",()=>this.enabledItem(0));o(this,"last",()=>this.item(this.descendants.size-1));o(this,"lastEnabled",()=>{const e=this.enabledValues().length-1;return this.enabledItem(e)});o(this,"indexOf",e=>{var t;return e?((t=this.descendants.get(e))==null?void 0:t.index)??-1:-1});o(this,"enabledIndexOf",e=>e==null?-1:this.enabledValues().findIndex(t=>t.node.isSameNode(e)));o(this,"next",(e,t=!0)=>{const s=v(e,this.count(),t);return this.item(s)});o(this,"nextEnabled",(e,t=!0)=>{const s=this.item(e);if(!s)return;const r=this.enabledIndexOf(s.node),a=v(r,this.enabledCount(),t);return this.enabledItem(a)});o(this,"prev",(e,t=!0)=>{const s=g(e,this.count()-1,t);return this.item(s)});o(this,"prevEnabled",(e,t=!0)=>{const s=this.item(e);if(!s)return;const r=this.enabledIndexOf(s.node),a=g(r,this.enabledCount()-1,t);return this.enabledItem(a)});o(this,"registerNode",(e,t)=>{if(!e||this.descendants.has(e))return;const s=Array.from(this.descendants.keys()).concat(e),r=E(s);t!=null&&t.disabled&&(t.disabled=!!t.disabled);const a={node:e,index:-1,...t};this.descendants.set(e,a),this.assignIndex(r)})}}function L(n,e){if(n!=null){if(typeof n=="function"){n(e);return}try{n.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${n}'`)}}}function j(...n){return e=>{n.forEach(t=>{L(t,e)})}}function K(){const n=i.useRef(new R);return b(()=>()=>n.current.destroy()),n.current}const[k,D]=w({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function A(n){const e=D(),[t,s]=i.useState(-1),r=i.useRef(null);b(()=>()=>{r.current&&e.unregister(r.current)},[]),b(()=>{if(!r.current)return;const c=Number(r.current.dataset.index);t!=c&&!Number.isNaN(c)&&s(c)});const a=h(n?e.register(n):e.register);return{descendants:e,index:t,enabledIndex:e.enabledIndexOf(r.current),register:j(a,r)}}function F(){return[h(k),()=>h(D()),()=>K(),r=>A(r)]}const U=()=>{const[n,e]=C.useState(0),[t,s,r,a]=i.useMemo(()=>F(),[]);return{provider:{descendants:r(),selected:n,setSelected:e},selected:n,setSelected:e,DescendantsProvider:t,useDescendantsContext:s,useDescendants:r,useDescendant:a}},y=C.createContext({}),V=n=>{const{children:e,descendants:t,selected:s,setSelected:r}=n,{DescendantsProvider:a}=U(),c=()=>{const d=t.nextEnabled(s);d&&(d.node.focus(),r(d.index))},l=()=>{const d=t.prevEnabled(s);d&&(d.node.focus(),r(d.index))},f=d=>{var u;return(u=t.item(d))==null?void 0:u.node},m=()=>{r(0)},x=d=>u=>{const O=u.key;if(d){const N=d[O];N==null||N(u)}},p=d=>()=>{var u;r==null||r(d),(u=f(d))==null||u.focus()},T=d=>()=>{r==null||r(d)};return I.jsx(a,{value:t,children:I.jsx(y.Provider,{value:{selected:s,descendants:t,setSelected:r,nextFocus:c,prevFocus:l,getNode:f,resetFocus:m,onKeyDown:x,onMouseMove:p,onFocus:T},children:e})})},G=()=>i.useContext(y);V.__docgenInfo={description:"",methods:[],displayName:"KeyboardNavigationProvider",props:{selected:{required:!0,tsType:{name:"number"},description:""},setSelected:{required:!0,tsType:{name:"signature",type:"function",raw:"(selected: number) => void",signature:{arguments:[{type:{name:"number"},name:"selected"}],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},descendants:{required:!0,tsType:{name:"DescendantsManager",elements:[{name:"HTMLElement"},{name:"object"}],raw:"DescendantsManager<HTMLElement, object>"},description:""}}};export{V as K,U as a,G as b,b as u};
